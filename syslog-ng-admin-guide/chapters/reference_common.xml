<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter SYSTEM "../../xml-stylesheet/pdf/dtd/docbookx.dtd"
 [  
 <!ENTITY % entities SYSTEM "../syslog-ng-entities.ent">
 %entities;]> 
<chapter>
    <title/>

    <table id="table_source_tcp_options">
        <title>Options for tcp(), tcp6(), udp(), and udp6() sources</title>
        <tgroup cols="4">
            <thead>
                <row>
                    <entry>Name</entry>
                    <entry>Type</entry>
                    <entry>Default</entry>
                    <entry>Description</entry>
                </row>
            </thead>
            <tbody>
            	<row id="source_option_encoding">
                    <entry>encoding()</entry>
                    <entry>string</entry>
                    <entry></entry>
                    <entry>Specifies the characterset (encoding, e.g., <parameter>UTF-8</parameter>) of 
                    messages using the legacy BSD-syslog protocol. To list the available character sets on a host, 
                    execute the <command>iconv -l</command> command.</entry>
                </row>
                <row id="source_option_ip">
                    <entry>ip() or localip()</entry>
                    <entry>string</entry>
                    <entry>0.0.0.0</entry>
                    <entry>The IP address to bind to. Note that this is not the address where
                        messages are accepted from. </entry>
                </row>
                <row id="source_option_ip_tos">
                    <entry>ip_tos</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies the Type-of-Service value of outgoing packets. </entry>
                </row>
                <row id="source_option_ip_ttl">
                    <entry>ip_ttl</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies the Time-To-Live value of outgoing packets. </entry>
                </row>
                <row id="source_option_keep_alive">
                    <entry>keep-alive()</entry>
                    <entry>yes or no</entry>
                    <entry>yes</entry>
                    <entry>Specifies whether connections to sources should be closed upon the
                        receipt of a SIGHUP signal. Note that this applies to the server (source)
                        side of the syslog-ng connections, client-side (destination) connections are
                        always reopened after receiving a HUP signal unless the
                            <parameter>keep-alive</parameter> option is enabled for the
                    destination.</entry>
                </row>
                <row id="source_option_max_connections">
                    <entry>max-connections()</entry>
                    <entry>number</entry>
                    <entry>10</entry>
                    <entry>Specifies the maximum number of simultaneous connections.</entry>
                </row>
                <row id="source_option_port">
                    <entry>port() or localport()</entry>
                    <entry>number</entry>
                    <entry>514</entry>
                    <entry>The port number to bind to.</entry>
                </row>
                <row id="source_option_so_broadcast">
                    <entry>so_broadcast</entry>
                    <entry>yes or no</entry>
                    <entry>no</entry>
                    <entry>This option controls the <parameter>SO_BROADCAST</parameter> socket
                        option required to make syslog-ng send messages to a broadcast address. See
                        the <command>socket(7)</command> manual page for details. </entry>
                </row>
                <row id="source_option_so_rcvbuf">
                    <entry>so_rcvbuf</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies the size of the socket receive buffer in bytes. </entry>
                </row>
                <row id="source_option_so_sndbuf">
                    <entry>so_sndbuf</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies the size of the socket send buffer in bytes. </entry>
                </row>
                <row id="source_option_tcp_keepalive">
                    <entry>tcp-keep-alive()</entry>
                    <entry>yes or no</entry>
                    <entry>no</entry>
                    <entry>Available for <parameter>tcp</parameter> only; specifies whether TCP keep
                        alive messages using the SO_KEEPALIVE socket option should be enabled.
                    </entry>
                </row>
                <row id="source_option_tls">
                    <entry>tls</entry>
                    <entry>tls options</entry>
                    <entry>n/a</entry>
                    <entry>This option sets various TLS specific options like key/certificate files
                        and trusted CA locations and can only be used with the
                        <parameter>tcp</parameter> transport protocols. See <xref
                            linkend="tlsoptions"/> for more information.</entry>
                </row>
            </tbody>
        </tgroup>
    </table>

    <table id="table_destination_tcp_options">
        <title>Options for tcp(), tcp6(), udp(), and udp6() destinations</title>
        <tgroup cols="4">
            <thead>
                <row>
                    <entry>Name</entry>
                    <entry>Type</entry>
                    <entry>Default</entry>
                    <entry>Description</entry>
                </row>
            </thead>
            <tbody>
                <row id="destination_option_ip_tos">
                    <entry>ip_tos</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies the Type-of-Service value of outgoing packets. </entry>
                </row>
                <row id="destination_option_ip_ttl">
                    <entry>ip_ttl</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies the Time-To-Live value of outgoing packets. </entry>
                </row>
                <row id="destination_option_localip">
                    <entry>localip()</entry>
                    <entry>string</entry>
                    <entry>0.0.0.0</entry>
                    <entry>The IP address to bind to before connecting to target. </entry>
                </row>
                <row id="destination_option_localport">
                    <entry>localport()</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>The port number to bind to. Messages are sent from this port.</entry>
                </row>
                <row id="destination_option_port">
                    <entry>port() or destport()</entry>
                    <entry>number</entry>
                    <entry>514</entry>
                    <entry>The port number to connect to.</entry>
                </row>
                <row id="destination_option_spoof_source">
                    <entry>spoof_source</entry>
                    <entry>yes or no</entry>
                    <entry>no</entry>
                    <entry>Enables source address spoofing. This means that the host running
                        syslog-ng generates UDP packets with the source IP address matching the
                        original sender of the message. It is useful when you want to perform some
                        kind of preprocessing via syslog-ng then forward messages to your central
                        log management solution with the source address of the original sender. This
                        option only works for UDP destinations though the original message can be
                        received by TCP as well. This option is only available if syslog-ng was
                        compiled using the <parameter>--enable-spoof-source</parameter>
                        configuration option. </entry>
                </row>
                <row id="destination_option_so_broadcast">
                    <entry>so_broadcast</entry>
                    <entry>yes or no</entry>
                    <entry>no</entry>
                    <entry>This option controls the <parameter>SO_BROADCAST</parameter> socket
                        option required to make syslog-ng send messages to a broadcast address. See
                        the <command>socket(7)</command> manual page for details. </entry>
                </row>
                <row id="destination_option_so_rcvbuf">
                    <entry>so_rcvbuf</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies the size of the socket receive buffer in bytes. </entry>
                </row>
                <row id="destination_option_so_sndbuf">
                    <entry>so_sndbuf</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies the size of the socket send buffer in bytes. </entry>
                </row>
                <row id="destination_option_tls">
                    <entry>tls</entry>
                    <entry>tls options</entry>
                    <entry>n/a</entry>
                    <entry>This option sets various TLS specific options like key/certificate files
                        and trusted CA locations. TLS can be used only with the
                        <parameter>tcp</parameter> transport protocols. See <xref
                            linkend="tlsoptions"/> for more information.</entry>
                </row>
            </tbody>
        </tgroup>
    </table>
    <table id="table_disk_buffering">
        <title>Disk-buffering options</title>
        <tgroup cols="4">
            <tbody>
                <row id="diskbuffer_option_log_disk_fifo_size">
                    <indexterm>
                        <primary>disk buffer</primary>
                    </indexterm>
                    <indexterm>
                        <primary>disk-based buffering</primary>
                    </indexterm>
                    <indexterm>
                        <primary>parameters</primary>
                        <secondary>log_disk_fifo_size()</secondary>
                    </indexterm>
                    <entry>log_disk_fifo_size()</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Size of the hard disk space in bytes that is used as disk buffer.
                        Available only in syslog-ng Premium Edition when using the
                        <parameter>tcp</parameter> or <parameter>tls</parameter> transport method.
                        See <xref linkend="concepts_diskbuffer"/> for details on using the disk
                        buffer.</entry>
                </row>
            </tbody>
        </tgroup>
    </table>

    <table id="table_source_commonoptions">
        <?dbfo keep-together="auto" ?>
        <title>Common options for source drivers</title>
        <tgroup cols="4">
            <thead>
                <row>
                    <entry>Name</entry>
                    <entry>Type</entry>
                    <entry>Default</entry>
                    <entry>Description</entry>
                </row>
            </thead>
            <tbody>
                <row id="source_commonoption_flags">
                    <entry>flags()</entry>
                    <entry>no-parse, kernel, syslog-protocol, no_multi_line, validate-utf8</entry>
                    <entry>empty set</entry>
                    <entry>
                        <para>Specifies log parsing flags.</para>
                        <para>The <parameter>no-parse</parameter> flag completely disables syslog
                            message parsing and processes the complete line as the message part of a
                            syslog message. Other information (timestamp, host, etc.) is added
                            automatically. This flag is useful for parsing files not complying to
                            the syslog format. </para>
                        <para>The <parameter>kernel</parameter> flag makes the source default to the
                                <parameter>LOG_KERN | LOG_CRIT</parameter> priority if not specified
                            otherwise. </para>
                        <para>The <parameter>syslog-protocol</parameter> flag specifies that
                            incoming messages are expected to be formatted according to the new IETF
                            syslog protocol standard. Note that this flag is not needed for the
                                <parameter>syslog</parameter> driver.<!-- FIXME link--></para>
                        <para>The <parameter>no-multi-line</parameter> flag disables line-breaking
                            in the messages; the entire message is converted to a single line.</para>
                        <para>The <parameter>validate-utf8</parameter> flag enables
                            encoding-verification for messages formatted according to the new IETF
                            syslog standard.<!-- FIXME link--> If the BOM character is missing, but
                            the message is otherwise UTF-8 compliant, syslog-ng automatically adds
                            the BOM character to the message.</para>
                    </entry>
                </row>
                <row id="source_commonoption_follow_freq">
                    <entry>follow_freq()</entry>
                    <entry>number</entry>
                    <entry>1</entry>
                    <entry>Indicates that the source should be checked periodically instead of being
                        polled. This is useful for files which always indicate readability, even
                        though no new lines were appended. If this value is higher than zero,
                        syslog-ng will not attempt to use <parameter>poll()</parameter> on the file,
                        but checks whether the file changed every time the
                        <parameter>follow_freq()</parameter> interval (in seconds) has elapsed.
                    </entry>
                </row>
                <row id="source_commonoption_host_override">
                    <entry>host_override</entry>
                    <entry>string</entry>
                    <entry/>
                    <entry>Replaces the $HOST part of the message with the parameter string.
                    </entry>
                </row>
                <row id="source_commonoption_keep_hostname">
                    <entry>keep_hostname()</entry>
                    <entry>yes or no</entry>
                    <entry>no</entry>
                    <entry>Enable or disable hostname rewriting. Enable this option to use
                        hostname-related macros. This option can be specified globally, and
                        per-source as well. The local setting of the source overrides the global
                        option if available.</entry>
                </row>
                <row id="source_commonoption_keep_timestamp">
                    <entry>keep_timestamp()</entry>
                    <entry>yes or no</entry>
                    <entry>yes</entry>
                    <entry>Specifies whether syslog-ng should accept the timestamp received from the
                        sending application or client. If disabled, the time of reception will be
                        used instead. This option can be specified globally, and per-source as well.
                        The local setting of the source overrides the global option if
                    available.</entry>
                </row>
                <row id="source_commonoption_log_fetch_limit">
                    <entry>log_fetch_limit()</entry>
                    <entry>number</entry>
                    <entry>The value specified by the global <link linkend="reference_options">
                            <parameter>log_fetch_limit()</parameter>
                        </link> option, which defaults to <parameter>10</parameter>.</entry>
                    <entry>The maximum number of messages fetched from a source during a single poll
                        loop. The destination queues might fill up before flow-control could stop
                        reading if <parameter>log_fetch_limit()</parameter> is too high. </entry>
                </row>
                <row id="source_commonoption_log_iw_size">
                    <entry>log_iw_size()</entry>
                    <entry>number</entry>
                    <entry>100</entry>
                    <entry>The size of the initial window, this value is used during flow
                    control.</entry>
                </row>
                <row id="source_commonoption_log_msg_size">
                    <entry>log_msg_size()</entry>
                    <entry>number</entry>
                    <entry>Use the global <parameter>log_msg_size()</parameter> option, which
                        defaults to <parameter>8192</parameter>.</entry>
                    <entry>Specifies the maximum length of incoming log messages. Uses the value of
                        the <link linkend="reference_options">global option</link> if not specified.
                    </entry>
                </row>
                <row id="source_commonoption_log_prefix">
                    <entry>log_prefix() (DEPRECATED)</entry>
                    <entry>string</entry>
                    <entry/>
                    <entry>A string added to the beginning of every log message. It can be used to
                        add an arbitrary string to any log source, though it is most commonly used
                        for adding <parameter>kernel:</parameter> to the kernel messages on Linux.
                        NOTE: This option is deprecated. Use
                        <parameter>program_override()</parameter> instead. </entry>
                </row>
                <row id="source_commonoption_optional">
                    <entry>optional()</entry>
                    <entry>yes or no</entry>
                    <entry/>
                    <entry>Instruct syslog-ng to ignore the error if a specific source cannot be
                        initialized. No other attempts to initialize the source will be made until
                        the configuration is reloaded. This option currently applies to the
                            <parameter>pipe()</parameter>, <parameter>unix-dgram</parameter>, and
                            <parameter>unix-stream</parameter> drivers.</entry>
                </row>
                <row id="source_commonoption_pad_size">
                    <entry>pad_size()</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Specifies input padding. Some operating systems (such as HP-UX) pad all 0
                        messages to block boundary. This option can be used to specify the block
                        size. (HP-UX uses 2048 bytes). Syslog-ng will pad reads from the associated
                        device to the number of bytes set in <parameter>pad_size()</parameter>.
                        Mostly used on HP-UX where <filename>/dev/log</filename> is a named pipe and
                        every write is padded to 2048 bytes. </entry>
                </row>
                <row id="source_commonoption_program_override">
                    <entry>program_override</entry>
                    <entry>string</entry>
                    <entry/>
                    <entry>Replaces the $PROGRAM part of the message with the parameter string. For
                        example, to mark every message coming from the kernel, include the
                            <parameter>program_override("kernel")</parameter> option in the source
                        containing <parameter>/proc/kmsg</parameter>. NOTE: This option replaces the
                        deprecated <parameter>log_prefix()</parameter> option. </entry>
                </row>
                <row id="source_commonoption_time_zone">
                    <entry>time_zone()</entry>
                    <entry>timezone in the form +/-HH:MM</entry>
                    <entry/>
                    <entry>The default timezone for messages read from the source. Applies only if
                        no timezone is specified within the message itself. </entry>
                </row>
                <row id="source_commonoption_use_dns">
                    <entry>use_dns()</entry>
                    <entry>yes, no, persist_only</entry>
                    <entry>yes</entry>
                    <entry>Enable or disable DNS usage. The <para>persist_only</para> option
                        attempts to resolve hostnames locally from file (e.g., from
                            <filename>/etc/hosts</filename>). syslog-ng blocks on DNS queries, so
                        enabling DNS may lead to a Denial of Service attack. To prevent DoS, protect
                        your syslog-ng network endpoint with firewall rules, and make sure that all
                        hosts which may get to syslog-ng are resolvable. This option can be
                        specified globally, and per-source as well. The local setting of the source
                        overrides the global option if available.</entry>
                </row>
                <row id="source_commonoption_use_fqdn">
                    <entry>use_fqdn()</entry>
                    <entry>yes or no</entry>
                    <entry>no</entry>
                    <entry>Add Fully Qualified Domain Name instead of short hostname. This option
                        can be specified globally, and per-source as well. The local setting of the
                        source overrides the global option if available.</entry>
                </row>
            </tbody>
        </tgroup>
    </table>

    <table id="table_destination_commonoptions">
        <?dbfo keep-together="auto" ?>
        <title>Common options for destination drivers</title>
        <indexterm>
            <primary>destination drivers</primary>
            <secondary>common options</secondary>
        </indexterm>
        <tgroup cols="4">
            <thead>
                <row>
                    <entry>Name</entry>
                    <entry>Type</entry>
                    <entry>Default</entry>
                    <entry>Description</entry>
                </row>
            </thead>
            <tbody>
                <row id="destination_commonoption_flags">
                    <entry>flags()</entry>
                    <entry>syslog-protocol, no_multi_line</entry>
                    <entry>empty set</entry>
                    <entry>
                        <para>Flags influence the behavior of the driver. </para>
                        <para>The <parameter>syslog-protocol</parameter> flag instructs the driver
                            to format the messages according to the new IETF syslog protocol
                            standard. <!-- FIXME link--> If this flag is enabled, macros used for
                            the message have effect only for the text of the message, the message
                            header is formatted to the new standard. Note that this flag is not
                            needed for the <parameter>syslog</parameter> driver.</para>
                        <para>The <parameter>no-multi-line</parameter> flog_prefix()lag disables
                            line-breaking in the messages; the entire message is sent as a single
                            line.</para>
                    </entry>
                </row>
                <row id="destination_commonoption_flush_lines">
                    <entry>flush_lines()</entry>
                    <entry>number</entry>
                    <entry>Use global setting. </entry>
                    <entry>Specifies how many lines are flushed to a destination at a time.
                        Syslog-ng waits for this number of lines to accumulate and sends them off in
                        a single batch. Setting this number high increases throughput as fully
                        filled frames are sent to the network, but also increases message latency.
                        The latency can be limited by the use of the
                        <parameter>flush_timeout</parameter> option.</entry>
                </row>
                <row id="destination_commonoption_flush_timeout">
                    <entry>flush_timeout()</entry>
                    <entry>time in milliseconds</entry>
                    <entry>Use global setting. </entry>
                    <entry>Specifies the time syslog-ng waits for lines to accumulate in its output
                        buffer. See the <parameter>flush_lines</parameter> option for more
                        information.</entry>
                </row>
                <row id="destination_commonoption_frac_digits">
                    <entry>frac_digits()</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>The syslog-ng application can store fractions of a second in the
                        timestamps. The <parameter>frac_digits()</parameter> parameter specifies the
                        number of digits stored. The digits storing the fractions are padded by
                        zeros if the original timestamp of the message specifies only seconds.
                        Fractions can always be stored for the time the message was
                    received.</entry>
                </row>
                <row id="destination_commonoption_fsync">
                    <entry>fsync()</entry>
                    <entry>yes or no</entry>
                    <entry>no</entry>
                    <entry>Forces an <parameter>fsync()</parameter> call on the destination fd after
                        each write. Note: enabling this option may seriously degrade
                    performance.</entry>
                </row>
                <row id="destination_commonoption_log_fifo_size">
                    <entry>log_fifo_size()</entry>
                    <entry>number</entry>
                    <entry>Use global setting. </entry>
                    <entry>The number of entries in the output buffer (output fifo). </entry>
                </row>
                <row id="destination_commonoption_keep_alive">
                    <entry>keep-alive()</entry>
                    <entry>yes or no</entry>
                    <entry>yes</entry>
                    <entry>Specifies whether connections to destinations should be closed upon the
                        receipt of a SIGHUP signal. Note that this applies to the client
                        (destination) side of the syslog-ng connections, server-side (source)
                        connections are always reopened after receiving a HUP signal unless the
                            <parameter>keep-alive</parameter> option is enabled for the
                    source. When the <parameter>keep-alive</parameter> option is enabled, 
                    syslog-ng saves the contents of the output queue of the destination when 
                    receiving a HUP signal, reducing the risk of losing messages.</entry>
                </row>
                <row id="destination_commonoption_suppress">
                    <entry>suppress()</entry>
                    <entry>seconds</entry>
                    <entry>0 (disabled) </entry>
                    <entry>When enabled and syslog-ng would send several messages with identical
                        content to the destination, syslog-ng sends only a single message and a line
                            <parameter>Last message repeated n times.</parameter>. The parameter of
                        this option specifies the number of seconds syslog-ng waits for identical
                        messages. </entry>
                </row>
                <!--<row id="destination_commonoption_sync_freq">
                    <entry>sync_freq()</entry>
                    <entry>number</entry>
                    <entry>Use global setting. </entry>
                    <entry>This setting is an obsolete alias of the
                        <parameter>flush_lines()</parameter> option. </entry>
                </row>-->
                <row id="destination_commonoption_template">
                    <entry>template()</entry>
                    <entry>string</entry>
                    <entry>A format conforming to the default logfile format. </entry>
                    <entry>Specifies a template defining the logformat to be used in the
                        destination. Macros are described in <xref linkend="reference_macros"/>. Please note
                        that for network destinations it might not be appropriate to change the
                        template as it changes the on-wire format of the syslog protocol which might
                        not be tolerated by stock syslog receivers (like
                        <parameter>syslogd</parameter> or syslog-ng itself). For network
                        destinations make sure the receiver can cope with the custom format defined.
                    </entry>
                </row>
                <row id="destination_commonoption_template_escape">
                    <!-- FIXME ez kell meg? -->
                    <entry>template_escape()</entry>
                    <entry>yes or no</entry>
                    <entry>no</entry>
                    <entry>Turns on escaping <parameter>'</parameter> and <parameter>"</parameter>
                        in templated output files. This is useful for generating SQL statements and
                        quoting string contents so that parts of the log message are not interpreted
                        as commands to the SQL server.</entry>
                </row>
                <row id="destination_commonoption_throttle">
                    <entry>throttle()</entry>
                    <entry>number</entry>
                    <entry>0</entry>
                    <entry>Sets the maximum number of messages sent to the destination per second.
                        Use this output-rate-limiting functionality only when using disk-buffer as
                        well to avoid the risk of losing messages. Specifying
                        <parameter>0</parameter> or a lower value sets the output limit to
                        unlimited.</entry>
                </row>
                <row id="destination_commonoption_timezone">
                    <entry>timezone()</entry>
                    <entry>timezone offset in seconds</entry>
                    <entry>unspecified </entry>
                    <entry>Convert timestamps to the timezone specified by this option. If this
                        option is not set then the original timezone information in the message is
                        used. </entry>
                </row>
                <row id="destination_commonoption_ts_format">
                    <entry>ts_format()</entry>
                    <entry>rfc3164, bsd, rfc3339, iso</entry>
                    <entry>rfc3164</entry>
                    <entry>Override the global timestamp format (set in the global
                            <parameter>ts_format()</parameter> parameter) for the specific
                        destination. See also <xref linkend="example_timezones"/>.</entry>
                </row>
            </tbody>
        </tgroup>
    </table>
</chapter>
