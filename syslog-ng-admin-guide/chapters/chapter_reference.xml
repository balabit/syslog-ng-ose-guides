<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter SYSTEM "../../xml-stylesheet/pdf/dtd/docbookx.dtd"
 [  <!ENTITY % entities SYSTEM "../syslog-ng-entities.ent">
 %entities;]> 
<chapter id="chapter_reference">
    <title>Reference</title>
    <para>This chapter documents the drivers and options that can be used in the configuration file.
        For details on how to use syslog-ng, see <xref linkend="chapter_configuration"/>.</para>
    <section id="reference_sourcedrivers">
        <title>Source drivers</title>
        <indexterm>
            <primary>source drivers</primary>
            <secondary>reference</secondary>
        </indexterm>
        <section id="reference_source_internal">
            <title>internal()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>internal()</parameter> driver</secondary>
            </indexterm>
            <para>All messages generated internally by syslog-ng use this special source. To collect
                warnings, errors and notices from syslog-ng itself, include this source in one of
                your source statements. </para>
            <synopsis>internal()</synopsis>
            <para>This driver does not have any parameters.</para>
            <example id="example_source_internal">
                <title>Using the internal() driver</title>
                <synopsis>source s_local { internal(); };</synopsis>
            </example>
        </section>
        <section id="reference_source_file">
            <title>file()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>file()</parameter> driver</secondary>
            </indexterm>
            <para>Collects log messages from plain-text files. The file driver has a single required
                parameter specifying the file to open.</para>
            <synopsis>Declaration:
    file(filename);</synopsis>
            <indexterm>
                <primary>wildcards</primary>
                <secondary>in file sources</secondary>
            </indexterm>
            <para>The filename may include wildcard characters (e.g., <parameter>*</parameter>).
                Note that when using wildcards in filenames, always set how often syslog-ng should
                check the file for new messages using the <parameter>follow_freq()</parameter>
                parameter.</para>
            <para>The <parameter>file()</parameter> driver has the following options:</para>
            <table>
                <?dbfo keep-together="auto" ?>
                <title>Options of the file() sources</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>file</entry>
                            <entry>filename with path</entry>
                            <entry/>
                            <entry>The file to read messages from. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_encoding)"/>
                        <row>
                            <entry>facility</entry>
                            <entry>facility string</entry>
                            <entry>kern</entry>
                            <entry>This parameter assigns a facility value to the messages received
                                from the file source.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <row>
                            <entry>recursive</entry>
                            <entry>yes or no</entry>
                            <entry>no</entry>
                            <entry>When enabled, syslog-ng monitors every subdirectory of the
                                directory set in the path of the <parameter>file</parameter>
                                parameter, and reads log messages from files with the set filename.
                                The <parameter>recursive</parameter> option can be used together
                                with wildcards in the filename. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_file">
                <title>Using the file() driver</title>
                <synopsis>source s_file { file("/var/log/messages"};</synopsis>
            </example>
            <example>
                <title>Tailing files</title>
                <para>The following source checks the <filename>access.log</filename> file every
                    second for new messages.</para>
                <synopsis>source s_tail { file("/var/log/apache/access.log" 
                    follow_freq(1) flags(no-parse)); };</synopsis>
            </example>
            <example id="example_source_file_wildcard">
                <title>Using wildcards in the filename</title>
                <para>The following example monitors every file with the <filename>.log</filename>
                    extension in the <filename>/var/application</filename> directory for log
                    messages.</para>
                <synopsis>source s_file { file("/var/application/*.log" follow_freq(1)};</synopsis>
            </example>
            <example id="example_source_file_recursive">
                <title>Monitoring multiple directories</title>
                <para>The following example reads files having the <parameter>.log</parameter>
                    extension from the <parameter>/var/application/</parameter> directory and its
                    subdirectories.</para>
                <synopsis>source s_file_subdirectories { file("/var/application/*.log"
                    recursive(yes) 
                    follow_freq(1) 
                    log_fetch_limit(100)
                    );};</synopsis>
            </example>
        </section>


        <section id="reference_source_pipe">
            <title>pipe()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>pipe()</parameter> driver</secondary>
            </indexterm>
            <para>The pipe driver opens a named pipe with the specified name and listens for
                messages. It is used as the native message delivery protocol on HP-UX.</para>
            <para>The pipe driver has a single required parameter, specifying the filename of the
                pipe to open.</para>
            <synopsis>Declaration:
    pipe(filename);</synopsis>
            <note>
                <para>As of syslog-ng Open Source Edition 3.0.2, pipes are created automatically. In
                    earlier versions, you had to create the pipe using the
                    <command>mkfifo(1)</command> command. </para>
            </note>
            <para>The <parameter>pipe</parameter> driver has the following options:</para>
            <table>
                <?dbfo keep-together="auto" ?>
                <title>Options of the pipe() sources</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <row>
                            <entry>pipe</entry>
                            <entry>filename with path</entry>
                            <entry/>
                            <entry>The filename of the pipe to read messages from. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_pipe">
                <title>Using the pipe() driver</title>
                <synopsis>source s_pipe { pipe("/dev/log" pad_size(2048)); };</synopsis>
            </example>
        </section>
        <section id="reference_source_program">
            <title>program()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>program()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>reading messages form external applications</primary>
            </indexterm>
            <para>The program driver starts an external application and reads messages from the
                standard output (stdout) of the application. It is mainly useful to receive log
                messages from daemons that accept incoming messages and convert them to log
                messages.</para>
            <para>The program driver has a single required parameter, specifying the name of the
                application to start.</para>
            <synopsis>Declaration:
    program(filename);</synopsis>
            <note>
                <para>The program is restarted automatically if it exits.</para>
            </note>
            <para>The <parameter>program</parameter> driver has the following options:</para>
            <table>
                <?dbfo keep-together="auto" ?>
                <title>Options of the program() source</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <row>
                            <entry>program</entry>
                            <entry>filename with path</entry>
                            <entry/>
                            <entry>The name of the application to start and read messages from.
                            </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_program">
                <title>Using the program() driver</title>
                <synopsis>source s_program { program("/etc/init.d/mydaemon"); };</synopsis>
            </example>
        </section>
        <section id="reference_source_sunstreams">
            <title>sun-streams() driver</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>sun-streams()</parameter> driver</secondary>
            </indexterm>
            <para>Solaris uses its <parameter>STREAMS</parameter> framework to send messages to the
                    <parameter>syslogd</parameter> process.</para>
            <para>Newer versions of Solaris (2.5.1 and above), use a new IPC in addition to
                    <parameter>STREAMS</parameter>, called door to confirm the delivery of a
                message. The syslog-ng application supports this new IPC mechanism via the
                    <parameter>door()</parameter> option (see below).</para>
            <note>
                <para>The <parameter>sun-streams()</parameter> driver must be enabled when the
                    syslog-ng application is compiled (see <command>./configure
                --help</command>).</para>
            </note>
            <para>The <parameter>sun-streams()</parameter> driver has a single required argument
                specifying the <parameter>STREAMS</parameter> device to open, and the
                    <parameter>door()</parameter> option.</para>
            <synopsis>Declaration:
    sun-streams(name_of_the_streams_device door(filename_of_the_door));</synopsis>
            <!-- FIXME a required argumentnek van neve, hogy a tablazatba belerakhassuk? -->
            <table>
                <title>Options for sun-streams</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>door()</entry>
                            <entry>string</entry>
                            <entry>none</entry>
                            <entry>Specifies the filename of a door to open, needed on Solaris above
                                2.5.1. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_sunstreams">
                <title>Using the sun-streams() driver</title>
                <synopsis>source s_stream { sun-streams("/dev/log" door("/etc/.syslog_door")); };</synopsis>
            </example>
        </section>
        <section id="reference_source_syslog">
            <title>syslog()</title>
            <!-- FIXME update ha lesz syslog6 -->
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>syslog()</parameter> driver</secondary>
            </indexterm>
            <para>This driver enables to receive messages from the network using the new standard
                syslog protocol and message format (see <xref linkend="concepts_message_ietfsyslog"
                /> for details about the protocol). UDP, TCP, and TLS-encrypted TCP can all be used
                to transport the messages.</para>
            <indexterm>
                <primary>TLS</primary>
            </indexterm>
            <synopsis>Declaration:
    syslog(ip() port() transport() options());</synopsis>
            <table>
                <title>Options for syslog() sources</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_host_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip_tos)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip_ttl)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_hostname)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_max_connections)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_port)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_tcp_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                        <row>
                            <entry>transport</entry>
                            <entry>udp, tcp, or tls</entry>
                            <entry>tcp</entry>
                            <entry>Specifies the protocol used to receive messages from the source.
                            </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_tls)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_use_dns)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_use_fqdn)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_syslog">
                <title>Using the syslog() driver</title>
                <para>TCP source listening on the localhost on port 1999.</para>
                <synopsis>source s_syslog { syslog(ip(127.0.0.1) port(1999) transport("tcp")); };</synopsis>
                <para>UDP source with defaults.</para>
                <synopsis>source s_udp { syslog( transport("udp")); };</synopsis>
                <para>Encrypted source where the client is also authenticated. See <xref
                        linkend="tlsoptions"/> for details on the encryption settings.</para>
                <synopsis>source s_syslog_tls{ syslog(
                    ip(10.100.20.40)
                    transport("tls")
                    tls(
                    peer-verify(required-trusted)
                    ca_dir('/etc/syslog-ng/keys/ca.d/')
                    key_file('/etc/syslog-ng/keys/server_privatekey.pem')
                    cert_file('/etc/syslog-ng/keys/server_certificate.pem')
                    )
                    );};</synopsis>
            </example>
        </section>
        <section id="reference_source_tcpudp">
            <title>tcp(), tcp6(), udp() and udp6()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>tcp()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>tcp6()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>udp()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>udp6()</parameter> driver</secondary>
            </indexterm>
            <para>The <parameter>tcp()</parameter>, <parameter>tcp6()</parameter>,
                <parameter>udp()</parameter>, <parameter>udp6()</parameter> drivers can receive
                messages from the network using the TCP and UDP networking protocols. The
                    <parameter>tcp6()</parameter> and <parameter>udp6()</parameter> drivers use the
                IPv6 network protocol, while <parameter>tcp()</parameter> and
                <parameter>udp()</parameter> use IPv4.</para>
            <para>The <parameter>tcp()</parameter> and <parameter>udp()</parameter> drivers do not
                have any required parameters. By default they bind to
                <parameter>0.0.0.0:514</parameter>, which means that syslog-ng will listen on all
                available interfaces, port 514. To limit accepted connections to only one interface,
                use the <parameter>localip()</parameter> parameter as described below. </para>
            <note>
                <para>The tcp port 514 is reserved for use with <command>rshell</command>, so select
                    a different port if syslog-ng and <command>rshell</command> is used at the same
                    time. </para>
            </note>
            <para>If you specify a multicast bind address to <parameter>udp()</parameter> and
                    <parameter>udp6()</parameter>, syslog-ng will automatically join the necessary
                multicast group. TCP does not support multicasting. </para>
            <para>The syslog-ng Premium Edition application supports TLS (Transport Layer Security,
                also known as SSL) for the tcp() and tcp6() drivers. See the TLS-specific options
                below and <xref linkend="tls_serverauth"/> for details.</para>
            <indexterm>
                <primary>TLS</primary>
            </indexterm>
            <synopsis>Declaration:
  tcp([options]);
  udp([options]);</synopsis>
            <para>The following options are valid for <parameter>tcp()</parameter>,
                    <parameter>tcp6()</parameter>, <parameter>udp()</parameter>, and
                    <parameter>udp6()</parameter> drivers: </para>
            <table>
                <title>Options for tcp, tcp6, udp, and udp6 drivers</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_encoding)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_host_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip_tos)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip_ttl)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_hostname)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_max_connections)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_port)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_tcp_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_tls)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_use_dns)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_use_fqdn)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_tcpudp">
                <title>Using the udp() and tcp() drivers</title>
                <para>A simple udp() source with default settings.</para>
                <synopsis>source s_udp { udp(); };# TCP source with the maximum number of simultaneous connections limited.</synopsis>
                <para>A TCP source listening on the localhost interface, with a limited number of
                    connections allowed.</para>
                <synopsis>source s_tcp { tcp(ip(127.0.0.1) port(1999) max-connections(10)); };</synopsis>
                <para>A TCP source listening on a TLS-encrypted channel.</para>
                <synopsis>source s_tcp { tcp(ip(127.0.0.1) port(1999) 
                   tls(peer-verify('required-trusted') 
                       key_file('/etc/syslog-ng/syslog-ng.key') 
                   cert_file('/etc/syslog-ng/syslog-ng.crt'))); 
};</synopsis>
                <para>A TCP source listening for messages using the IETF-syslog message format:</para>
                <synopsis>source s_tcp_syslog { tcp(ip(127.0.0.1) port(1999) flags(syslog-protocol) };</synopsis>
            </example>
        </section>
        <section id="reference_source_unixstream">
            <title>unix-stream() and unix-dgram()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>unix-stream()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>unix-dgram()</parameter> driver</secondary>
            </indexterm>
            <para>These two drivers behave similarly: they open an <parameter>AF_UNIX</parameter>
                socket and start listening on it for messages.</para>
            <para>Both unix-stream and unix-dgram have a single required argument, specifying the
                filename of the socket to create. </para>
            <synopsis>Declaration: 
    unix-stream(filename [options]);
    unix-dgram(filename [options]);</synopsis>
            <para>The following options can be specified for these divers:</para>
            <table>
                <title>Options for unix-stream() and unix-dgram()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_encoding)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <row>
                            <entry>group()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the gid of the socket.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_host_override)"/>
                        <row>
                            <entry>keep-alive()</entry>
                            <entry>yes or no</entry>
                            <entry>yes</entry>
                            <entry>Selects whether to keep connections open when syslog-ng is
                                restarted; cannot be used with <parameter>unix-dgram()</parameter>.
                            </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <row>
                            <entry>max-connections()</entry>
                            <entry>number</entry>
                            <entry>256</entry>
                            <entry>Limits the number of simultaneously open connections. Cannot be
                                used with <parameter>unix-dgram()</parameter>.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <row>
                            <entry>owner()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the uid of the socket.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <row>
                            <entry>perm()</entry>
                            <entry>number</entry>
                            <entry>0666</entry>
                            <entry>Set the permission mask. For octal numbers prefix the number with
                                '0', e.g.: use 0755 for rwxr-xr-x.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_broadcast)"/>
                        <row>
                            <entry>so_keepalive</entry>
                            <entry>yes or no</entry>
                            <entry>0</entry>
                            <entry>Enables keep-alive messages, keeping the socket open.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_unixstream">
                <title>Using the unix-stream() and unix-dgram() drivers</title>
                <synopsis>source s_stream { unix-stream("/dev/log" max-connections(10)); };</synopsis>
                <synopsis>source s_dgram { unix-dgram("/var/run/log"); };</synopsis>
            </example>
        </section>
    </section>

    <section id="reference_destinationdrivers">
        <title>Destination drivers</title>
        <indexterm>
            <primary>destination drivers</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>Destination drivers output log messages to somewhere outside syslog-ng e.g., to a file
            or a network socket. </para>

        <section id="reference_destination_file">
            <title>file()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>file()</parameter> driver</secondary>
            </indexterm>
            <para>The file driver outputs messages to the specified text file, or to a set of files. </para>
            <para>The destination filename may include macros which get expanded when the message is
                written, thus a simple <parameter>file()</parameter> driver may create several
                files. For more information on available macros see <xref linkend="reference_macros"
                />. </para>
            <para>The <parameter>file()</parameter> destination has the following options:</para>
            <!-- FIXME required parameters?? -->
            <table>
                <title>Options for file()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>create_dirs()</entry>
                            <entry>yes or no</entry>
                            <entry> no </entry>
                            <entry>Enable creating non-existing directories. </entry>
                        </row>
                        <row>
                            <entry>dir_group()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>The group of directories created by syslog-ng. </entry>
                        </row>
                        <row>
                            <entry>dir_owner()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>The owner of directories created by syslog-ng. </entry>
                        </row>
                        <row>
                            <entry>dir_perm()</entry>
                            <entry>number</entry>
                            <entry> 0600 </entry>
                            <entry>The permission mask of directories created by syslog-ng. Log
                                directories are only created if a file after macro expansion refers
                                to a non-existing directory, and directory creation is enabled (see
                                the <parameter>create_dirs()</parameter> option below). For octal
                                numbers prefix the number with <parameter>0</parameter>, e.g., use
                                    <parameter>0755</parameter> for
                                <parameter>rwxr-xr-x</parameter>. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <row>
                            <entry>group()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the group of the created file to the one specified. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <row>
                            <entry>overwrite_if_older()</entry>
                            <entry>number</entry>
                            <entry>0</entry>
                            <entry>If set to a value higher than 0, before writing to a file,
                                syslog-ng checks whether this file is older than the specified
                                amount of time (specified in seconds). If so, it removes the
                                existing file and the line to be written is the first line of a new
                                file having the same name. In combination with e.g.: the
                                    <parameter>$WEEKDAY</parameter> macro, this can be used for
                                simple log rotation, in case not all history has to be kept.
                            </entry>
                        </row>
                        <row>
                            <entry>owner()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the owner of the created file to the one specified. </entry>
                        </row>
                        <row>
                            <entry>perm()</entry>
                            <entry>number</entry>
                            <entry> 0600 </entry>
                            <entry>The permission mask of the file if it is created by syslog-ng.
                                For octal numbers prefix the number with <parameter>0</parameter>,
                                e.g., use <parameter>0755</parameter> for
                                <parameter>rwxr-xr-x</parameter>. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                        <!--<row>
                            <entry>remove_if_older()</entry>
                            <entry>number</entry>
                            <entry>0</entry>
                            <entry>Obsolete alias of the <parameter>overwrite_if_older()</parameter>
                                option. </entry>
                        </row>-->
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_file">
                <title>Using the file() driver</title>
                <synopsis>destination d_file { file("/var/log/messages" ); };</synopsis>
            </example>
            <example id="example_destination_file_macro">
                <title>Using the file() driver with macros in the file name and a template for the
                    message</title>
                <synopsis>destination d_file {
        file("/var/log/$YEAR.$MONTH.$DAY/messages"
             template("$HOUR:$MIN:$SEC $TZ $HOST [$LEVEL] $MSG $MSG\n")
             template_escape(no));
};</synopsis>
            </example>
        </section>
        <section id="reference_destination_logstore">
            <title>logstore()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>logstore()</parameter> driver</secondary>
            </indexterm>
            <para>The logstore driver stores log messages in binary files that can be encrypted,
                compressed, checked for integrity, and timestamped by an external Timestamping
                Authority (TSA). Otherwise, it is very similar to the <parameter>
                    <link linkend="reference_destination_file">file()</link>
                </parameter> destination.</para>
            <para>To display the contents of a logstore file, use the <command>logcat</command>
                command supplied with syslog-ng, e.g., <command>logcat
                /var/log/messages.lgs</command>.</para>
            <para>The destination filename may include macros which get expanded when the message is
                written, thus a simple <parameter>logstore()</parameter> driver may create several
                files. For more information on available macros see <xref linkend="reference_macros"
                />. </para>
            <para>The <parameter>logstore()</parameter> has a single required parameter that
                specifies the filename that stores the log messages.</para>
            <synopsis>Declaration:
    logstore(filename options());</synopsis>
            <para>The <parameter>logstore()</parameter> destination has the following options:</para>
            <!-- FIXME logstore-ra se lesz teljesen igaz, lasd http://bugzilla.balabit/bugzilla-3.0/show_bug.cgi?id=13640  -->
            <table>
                <title>Options for logstore()</title>
                <!-- FIXME a file driverrel kozos opciokat xincludolni 
                    Global options for destinations files should be cleaned up
                -->
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>chunk_size()</entry>
                            <entry>number</entry>
                            <entry>128</entry>
                            <entry>Size of a logstore chunk in kilobytes. Note that this size refers
                                to the compressed size of the chunk. Also, the gzip library used for
                                compressing the messages has a 32k long buffer; messages may not
                                appear in the actual logfile until this buffer is not filled.
                                Logstore chunks are closed when they reach the specified size, or
                                when the time limit set in <parameter>chunk_time</parameter>
                                expires. </entry>
                        </row>
                        <row>
                            <entry>chunk_time()</entry>
                            <entry>number</entry>
                            <entry>5</entry>
                            <entry>Time limit in seconds: syslog-ng PE closes the chunk if no new
                                messages arrive until the time limit expires. Logstore chunks are
                                closed when the time limit expires, or when they reach the size
                                specified in the <parameter>chunk_size</parameter> parameter. If the
                                time limit set in the <parameter>time_reap</parameter> parameter
                                expires, the entire file is closed.</entry>
                        </row>
                        <row>
                            <entry>compress()</entry>
                            <entry>number between 0-9</entry>
                            <entry> 3 </entry>
                            <entry>Compression level. <parameter>0</parameter> means uncompressed
                                files, while 1-9 is the compression level used by gzip
                                (<parameter>9</parameter> means the highest but slowest compression,
                                    <parameter>3</parameter> is usually a good compromise). </entry>
                        </row>
                        <row>
                            <entry>create_dirs()</entry>
                            <entry>yes or no</entry>
                            <entry> no </entry>
                            <entry>Enable creating non-existing directories. </entry>
                        </row>
                        <row>
                            <entry>dir_group()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>The group of the directories created by syslog-ng. </entry>
                        </row>
                        <row>
                            <entry>dir_owner()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>The owner of directories created by syslog-ng. </entry>
                        </row>
                        <row>
                            <entry>dir_perm()</entry>
                            <entry>number</entry>
                            <entry> 0600 </entry>
                            <entry>The permission mask of directories created by syslog-ng. Log
                                directories are only created if a file after macro expansion refers
                                to a non-existing directory, and directory creation is enabled (see
                                the <parameter>create_dirs()</parameter> option below). For octal
                                numbers prefix the number with <parameter>0</parameter>, e.g., use
                                    <parameter>0755</parameter> for
                                <parameter>rwxr-xr-x</parameter>. </entry>
                        </row>
                        <row>
                            <entry>encrypt_certificate()</entry>
                            <entry>filename</entry>
                            <entry> none </entry>
                            <entry>Name of a file, that contains an X.509 certificate (and the
                                public key) in PEM format. The syslog-ng application uses this
                                certificate to encrypt the logstore files which can be decrypted
                                using the private key of the certificate. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <row>
                            <entry>group()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the group of the created file to the one specified. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <row>
                            <entry>owner()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the owner of the created file to the one specified. </entry>
                        </row>
                        <row>
                            <entry>perm()</entry>
                            <entry>number</entry>
                            <entry> 0600 </entry>
                            <entry>The permission mask of the file if it is created by syslog-ng.
                                For octal numbers prefix the number with <parameter>0</parameter>,
                                e.g., use <parameter>0755</parameter> for
                                <parameter>rwxr-xr-x</parameter>. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <row>
                            <entry>time_reap()</entry>
                            <entry>number</entry>
                            <entry>60</entry>
                            <entry>The time to wait in seconds before an idle destination file is
                                closed.</entry>
                        </row>
                        <row>
                            <entry>timestamp-freq()</entry>
                            <entry>number in seconds</entry>
                            <entry>Use global setting.</entry>
                            <entry>The minimum time that should expire between two timestamping
                                requests. When syslog-ng closes a chunk, it checks how much time has
                                expired since the last timestamping request: if it is higher than
                                the value set in the <parameter>timestamp-freq</parameter>
                                parameter, it requests a new timestamp from the authority set in the
                                    <parameter>timestamp-url</parameter> parameter. </entry>
                        </row>
                        <row>
                            <entry>timestamp-url()</entry>
                            <entry>string</entry>
                            <entry>Use global setting.</entry>
                            <entry>The URL of the Timestamping Authority used to request timestamps
                                to sign logstore chunks.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_logstore">
                <title>Using the logstore() driver</title>
                <para>A simple example saving and compressing log messages.</para>
                <synopsis>destination d_logstore { file("/var/log/messages.lgs" compress(5) ); };</synopsis>
                <para>A more detailed example that encrypts messages, modifies the parameters for
                    closing chunks, and sets file privileges.</para>
                <synopsis>destination d_logstore { logstore("/var/log/messages-logstore.lgs"
    encrypt_certificate("/etc/syslog-ng/keys/10-100-20-40/public-certificate-of-the-server.pem")			
    chunk_size(100) 
    chunk_time(5)
    owner("balabit")
    group("balabit")
    perm(0777)
); };</synopsis>
            </example>
        </section>
        <section id="reference_destination_pipe">
            <title>pipe()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>pipe()</parameter> driver</secondary>
            </indexterm>
            <para>This driver sends messages to a named pipe like
                <filename>/dev/xconsole</filename>. </para>
            <para>The pipe driver has a single required parameter, specifying the filename of the
                pipe to open. The filename can include macros.</para>
            <synopsis>Declaration:
    pipe(filename);</synopsis>
            <warning>
                <para>As of syslog-ng Open Source Edition 3.0.2, pipes are created automatically. In
                    earlier versions, you had to create the pipe using the
                    <command>mkfifo(1)</command> command. </para>
            </warning>
            <para>The <parameter>pipe()</parameter> destination has the following options:</para>
            <table>
                <title>Options for pipe()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <row>
                            <entry>group()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>Set the group of the pipe to the one specified. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <row>
                            <entry>owner()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>Set the owner of the pipe to the one specified. </entry>
                        </row>
                        <row>
                            <entry>perm()</entry>
                            <entry>number</entry>
                            <entry> 0600 </entry>
                            <entry>The permission mask of the pipe. For octal numbers prefix the
                                number with '0', e.g.: use 0755 for rwxr-xr-x. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_pipe">
                <title>Using the pipe() driver</title>
                <synopsis>destination d_pipe { pipe("/dev/xconsole"); };</synopsis>
            </example>
        </section>
        <section id="reference_destination_program">
            <title>program()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>program()</parameter> driver</secondary>
            </indexterm>
            <para>This driver starts an external application or script and sends the log messages to
                its standard input (<parameter>stdin</parameter>). </para>
            <para>The <parameter>program()</parameter> driver has a single required parameter,
                specifying a program name to start.</para>
            <synopsis>Declaration: 
    program(command_to_run);</synopsis>
            <para>The <parameter>program()</parameter> destination has the following options:</para>
            <table>
                <title>Options for program()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_program">
                <title>Using the program() destination driver</title>
                <synopsis>destination d_prog { program("/bin/script" template("&lt;$PRI&gt;$DATE $HOST $MSG\n"); };</synopsis>
            </example>
        </section>
        <section id="reference_destination_sql">
            <title>sql()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>sql()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary>database driver</secondary>
            </indexterm>
            <para>This driver sends messages into an SQL database. The <parameter>sql()</parameter>
                driver has the following required parameters: <parameter>type</parameter>,
                    <parameter>database</parameter>, <parameter>table</parameter>,
                    <parameter>columns</parameter>, <parameter>values</parameter>.</para>
            <!-- FIXME melyek a kotelezo parameterek? -->
            <synopsis>Declaration: 
    sql(database_type host_parameters database_parameters [options]);</synopsis>
            <para>The <parameter>sql()</parameter> destination has the following options:</para>
            <table>
                <title>Options for sql()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row id="sql_option_columns">
                            <entry>columns</entry>
                            <entry>string list</entry>
                            <entry>"date", "facility", "level", "host", "program", "pid", "message"</entry>
                            <entry>Name of the columns storing the data in <parameter>fieldname
                                    [dbtype]</parameter> format. The <parameter>[dbtype]</parameter>
                                parameter is optional, and specifies the type of the field.</entry>
                        </row>
                        <row id="sql_option_database">
                            <entry>database</entry>
                            <entry>string</entry>
                            <entry>n/a</entry>
                            <entry>Name of the database that stores the logs.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <row>
                            <entry>host</entry>
                            <entry>hostname or IP address</entry>
                            <entry>n/a</entry>
                            <entry>Hostname of the database server. Note that Oracle destinations do
                                not use this parameter, but retrieve the hostname from the
                                    <filename>/etc/tnsnames.ora</filename> file.</entry>
                        </row>
                        <row id="sql_option_indexes">
                            <entry>indexes</entry>
                            <entry>string list</entry>
                            <entry>"date", "facility", "host", "program"</entry>
                            <entry>The list of columns that are indexed by the database to speed up
                                searching.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(diskbuffer_option_log_disk_fifo_size)"/>
                        <row>
                            <entry>password</entry>
                            <entry>string</entry>
                            <entry>n/a</entry>
                            <entry>Password of the database user.</entry>
                        </row>
                        <row id="sql_option_table">
                            <entry>table</entry>
                            <entry>string</entry>
                            <entry>n/a</entry>
                            <entry>Name of the database table to use (can include macros). When
                                using macros, note that some databases limit the length of table
                                names.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <row id="sql_option_type">
                            <entry>type</entry>
                            <entry>mssql, mysql, oracle, pgsql, or sqlite3</entry>
                            <entry>n/a</entry>
                            <entry>Specifies the type of the database, i.e., the DBI database driver
                                to use. Use the <parameter>mssql</parameter> option to send logs to
                                an MSSQL database. See the examples of the databases on the
                                following sections for details.</entry>
                        </row>
                        <row>
                            <entry>username</entry>
                            <entry>string</entry>
                            <entry>n/a</entry>
                            <entry>Name of the database user.</entry>
                        </row>
                        <row id="sql_option_values">
                            <entry>values</entry>
                            <entry>string list</entry>
                            <entry>"${R_YEAR}-${R_MONTH}-${R_DAY} ${R_HOUR}:${R_MIN}:${R_SEC}",
                                "$FACILITY", "$LEVEL", "$HOST", "$PROGRAM", "$PID", "$MSGONLY"</entry>
                            <entry>The parts of the message to store in the fields specified in the
                                    <parameter>columns</parameter> parameter.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_sql">
                <title>Using the sql() driver</title>
                <indexterm>
                    <primary>destinations</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <indexterm>
                    <primary>PostgreSQL</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <para>The following example sends the log messages into a PostgreSQL database
                    running on the <parameter>logserver</parameter> host. The messages are inserted
                    into the <parameter>logs</parameter> database, the name of the table includes
                    the exact date and the name of the host sending the messages. The syslog-ng
                    application automatically creates the required tables and columns, if the user
                    account used to connect to the database has the required privileges.</para>
                <synopsis>destination d_sql { 
  sql(type(pgsql)
  host("logserver") username("syslog-ng") password("password")
  database("logs")
  table("messages_${HOST}_${R_YEAR}${R_MONTH}${R_DAY}")
  columns("datetime", "host", "program", "pid", "message")
  values("$R_DATE", "$HOST", "$PROGRAM", "$PID", "$MSGONLY")
  indexes("datetime", "host", "program", "pid", "message"));
  };</synopsis>
            </example>
            <example id="example_destination_sql_oracle">
                <title>Using the sql() driver with an Oracle database</title>
                <para>The following example sends the log messages into an Oracle database running
                    on the <parameter>logserver</parameter> host, which must be set in the
                        <filename>/etc/tnsnames.ora</filename> file. The messages are inserted into
                    the <parameter>LOGS</parameter> database, the name of the table includes the
                    exact date when the messages were sent. The syslog-ng application automatically
                    creates the required tables and columns, if the user account used to connect to
                    the database has the required privileges.</para>
                <synopsis>destination d_sql { 
  sql(type(oracle)
  username("syslog-ng") password("password")
  database("LOGS")
  table("msgs_${R_YEAR}${R_MONTH}${R_DAY}")
  columns("datetime varchar(16)", "host varchar(32)", "program varchar(32)", "pid varchar(8)", "message varchar2")                        
  values("$R_DATE", "$HOST", "$PROGRAM", "$PID", "$MSGONLY")
  indexes("datetime", "host", "program", "pid", "message"));
  };</synopsis>
                <para>The Oracle Instant Client retrieves the address of the database server from
                    the <filename>/etc/tnsnames.ora</filename> file. Edit or create this file as
                    needed for your configuration. A sample is provided below.</para>
                <synopsis>LOGS =
(DESCRIPTION =
(ADDRESS_LIST =
(ADDRESS = (PROTOCOL = TCP)
(HOST = logserver)
(PORT = 1521))
)
(CONNECT_DATA =
(SERVICE_NAME = EXAMPLE.SERVICE)
)
)</synopsis>
            </example>
            <example id="example_destination_sql_mssql">
                <title>Using the sql() driver with an MSSQL database</title>
                <para>The following example sends the log messages into an MSSQL database running on
                    the <parameter>logserver</parameter> host. The messages are inserted into the
                        <parameter>syslogng</parameter> database, the name of the table includes the
                    exact date when the messages were sent. The syslog-ng application automatically
                    creates the required tables and columns, if the user account used to connect to
                    the database has the required privileges.</para>
                <synopsis>destination d_mssql { 
sql(type(mssql) host("logserver") port("1433") 
  username("syslogng") password("syslogng") database("syslogng") 
  table("msgs_${R_YEAR}${R_MONTH}${R_DAY}")columns("datetime varchar(16)", "host varchar(32)",
  "program varchar(32)", "pid varchar(8)", "message varchar(4096)")
  values("$R_DATE", "$HOST", "$PROGRAM", "$PID", "$MSGONLY")
  indexes("datetime", "host", "program", "pid", "message"));
  };</synopsis>
                <para>The date format used by the MSSQL database must be explicitly set in the
                        <filename>/etc/locales.conf</filename> file of the syslog-ng server. Edit or
                    create this file as needed for your configuration. A sample is provided below.</para>
                <synopsis>[default]
date = "%Y-%m-%d %H:%M:%S"</synopsis>
            </example>
        </section>

        <section id="reference_destination_syslog">
            <title>syslog()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>syslog()</parameter> driver</secondary>
            </indexterm>
            <para>The <parameter>syslog()</parameter> driver sends messages to a remote host (e.g.,
                a syslog-ng server or relay) on the local intranet or internet using the new
                standard syslog protocol developed by IETF (see <xref
                    linkend="concepts_message_ietfsyslog"/> for details about the protocol). The
                protocol supports sending messages using the UDP, TCP, or the encrypted TLS
                networking protocols.</para>
            <para>The required arguments of the driver are the address of the destination host
                (where messages should be sent) and the transport method (networking protocol). </para>
            <para>The <parameter>udp</parameter> transport method
                <!-- FIXME ez erre a driverre is igaz? --> automatically sends multicast packets if
                a multicast destination address is specified. The <parameter>tcp</parameter> and
                    <parameter>tls</parameter> methods do not support multicasting.</para>
            <synopsis>Declaration:
    syslog(host transport [options]);</synopsis>
            <para>These destinations have the following options:</para>
            <table id="table_destination_syslog_options">
                <title>Options for syslog() destinations</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_ip_tos)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_ip_ttl)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_localip)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_localport)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(diskbuffer_option_log_disk_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_port)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_spoof_source)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_tls)"/>
                        <row>
                            <entry>transport</entry>
                            <entry>udp, tcp, or tls</entry>
                            <entry>tcp</entry>
                            <entry>Specifies the protocol used to receive messages from the source.
                            </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_syslog">
                <title>Using the syslog() driver</title>
                <synopsis>destination d_tcp { syslog(ip"10.1.2.3" transport("tcp") port(1999); localport(999)); };</synopsis>
                <para>If name resolution is configured, the hostname of the target server can be
                    used as well.</para>
                <synopsis>destination d_tcp { syslog(ip"target_host" transport("tcp") port(1999); localport(999)); };</synopsis>
                <para>Send the log messages using TLS encryption and use mutual authentication. See
                        <xref linkend="tlsoptions"/> for details on the encryption and
                    authentication options.</para>
                <synopsis>destination d_syslog_tls{ 
                syslog("10.100.20.40"
                transport("tls")
                port(3214)
                tls(peer-verify(required-trusted)
                ca_dir('/etc/syslog-ng/keys/ca.d/')
                key_file('/etc/syslog-ng/keys/client_key.pem')
                cert_file('/etc/syslog-ng/keys/client_certificate.pem'))
                );};</synopsis>
            </example>
        </section>

        <section id="reference_destination_tcpudp">
            <title>tcp(), tcp6(), udp(), and udp6(),</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>tcp()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>tcp6()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>udp()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>udp6()</parameter> driver</secondary>
            </indexterm>
            <para>This driver sends messages to another host on the local intranet or internet using
                the UDP or TCP protocol. The <parameter>tcp6()</parameter> and
                <parameter>udp6()</parameter> drivers use the IPv6 network protocol.</para>
            <para>Both drivers have a single required argument specifying the destination host
                address, where messages should be sent, and several optional parameters. Note that
                this differs from source drivers, where local bind address is implied, and none of
                the parameters are required. </para>
            <para>The <parameter>udp()</parameter> and <parameter>udp6()</parameter> drivers
                automatically send multicast packets if a multicast destination address is
                specified. The <parameter>tcp()</parameter> and <parameter>tcp6()</parameter>
                drivers do not support multicasting.</para>
            <synopsis>Declaration:
    tcp(host [options]);
    udp(host [options]);
    tcp6(host [options]);
    udp6(host [options]);</synopsis>
            <para>These destinations have the following options:</para>
            <table id="table_destination_tcp_options">
                <title>Options for tcp, tcp6, udp, and udp6 destinations</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_ip_tos)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_ip_ttl)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_localip)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_localport)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(diskbuffer_option_log_disk_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_port)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_spoof_source)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_tls)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_tcpudp">
                <title>Using the tcp() driver</title>
                <synopsis>destination d_tcp { tcp("10.1.2.3" port(1999); localport(999)); };</synopsis>
                <para>If name resolution is configured, the hostname of the target server can be
                    used as well.</para>
                <synopsis>destination d_tcp { tcp("target_host" port(1999); localport(999)); };</synopsis>
                <para>To send messages using the IETF-syslog message format, enable the
                        <parameter>syslog-protocol</parameter> flag:</para>
                <synopsis>destination d_tcp { tcp("10.1.2.3" port(1999); flags(syslog-protocol) };</synopsis>
            </example>
            <example id="example_diskbuffer">
                <title>Enabling disk-based buffering</title>
                <para>The following example turns on disk-based buffering for the destination. The
                    size of the disk buffer is 4 194 304 bytes (4 megabytes). In a worst-case
                    situation, using the default value of the <parameter>log_msg_size()</parameter>
                    parameter (8192 bytes), this disk buffer can store at least 512 messages.
                    Typical log messages are about 300-500 bytes long, so a disk buffer of 4
                    megabytes can store over 8000 messages. Set the size of the disk buffer based on
                    the average size and number of messages, and the longest estimated downtime of
                    the server. </para>
                <synopsis>destination d_tcp { 
                    tcp("10.1.2.3" port(1999) log_disk_fifo_size(4194304)); };</synopsis>
            </example>
        </section>

        <section id="reference_destination_unixstream">
            <title>unix-stream() &amp; unix-dgram()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>unix-stream()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>unix-dgram()</parameter> driver</secondary>
            </indexterm>
            <para>These drivers send messages to a unix socket in either
                <parameter>SOCK_STREAM</parameter> or <parameter>SOCK_DGRAM</parameter> mode. </para>
            <para>Both drivers have a single required argument specifying the name of the socket to
                connect to. </para>
            <synopsis>Declaration: 
    unix-stream(filename [options]);
    unix-dgram(filename [options]);</synopsis>
            <para>The <parameter>unix-stream()</parameter> and <parameter>unix-dgram()</parameter>
                destinations have the following options:</para>
            <table>
                <title>Options for unix-stream() and unix-dgram()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_unixstream">
                <title>Using the unix-stream() driver</title>
                <synopsis>destination d_unix_stream { unix-stream("/var/run/logs"); };</synopsis>
            </example>
        </section>

        <section id="reference_destination_usertty">
            <title>usertty()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>usertty()</parameter> driver</secondary>
            </indexterm>
            <para>This driver writes messages to the terminal of a logged-in user. </para>
            <para>The <parameter>usertty()</parameter> driver has a single required argument,
                specifying a username who should receive a copy of matching messages. </para>
            <synopsis>Declaration: 
    usertty(username);</synopsis>
            <para>The <parameter>usertty()</parameter> does not have any further options nor does it
                support templates.</para>
            <example>
                <title>Using the usertty() driver</title>
                <synopsis>destination d_usertty { usertty("root"); };</synopsis>
            </example>
        </section>

    </section>
    <section id="reference_logflags">
        <title>Log path flags</title>
        <para>Flags influence the behavior of syslog-ng, and the way it processes messages. The
            following flags may be used in the log paths, as described in <xref linkend="logpath"/>.</para>
        <table id="logflags">
            <title>Log statement flags</title>
            <indexterm>
                <primary>log paths</primary>
                <secondary>flags</secondary>
            </indexterm>
            <indexterm>
                <primary>flags</primary>
            </indexterm>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Flag</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>catchall</entry>
                        <entry>This flag means that the source of the message is ignored, only the
                            filters are taken into account when matching messages. A log statement
                            using the <parameter>catchall</parameter> flag processes every message
                            that arrives to any of the defined sources.</entry>
                    </row>
                    <row>
                        <entry>fallback</entry>
                        <entry>This flag makes a log statement 'fallback'. Fallback log statements
                            process messages that were not processed by other, 'non-fallback' log
                            statements. </entry>
                    </row>
                    <row>
                        <entry>final</entry>
                        <entry>This flag means that the processing of log statements ends here. Note
                            that this does not necessarily mean that matching messages will be
                            stored only once, as there can be matching log statements processed
                            prior the current one. </entry>
                    </row>
                    <row>
                        <entry>flow-control</entry>
                        <entry>Enables flow-control to the log path, meaning that syslog-ng will
                            stop reading messages from the sources of this log statement if the
                            destinations are not able to process the messages at the required speed.
                            If disabled, syslog-ng will drop messages if the destination queues are
                            full. If enabled, syslog-ng will only drop messages if the destination
                            queues/window sizes are improperly sized. </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <example id="example_logpath_flags">
            <title>Using log path flags</title>
            <para>The following log path processes every message received to the
                    <parameter>s_localhost</parameter> source that was not processed by earlier log
                paths. As syslog-ng processes log paths in the order they appear in the
                configuration file, place such log paths at the end of the file. A typical situation
                is to use filters to select the most important messages and send them to specific
                destinations, and process the remaining messages with a fallback log path.</para>
            <synopsis>.
.
.
log { source(s_localhost); destination(d_tcp); flags(fallback); };</synopsis>
        </example>
    </section>
    <section id="reference_filters">
        <title>Filter functions</title>
        <indexterm>
            <primary>filters</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>The following functions may be used in the filter statement, as described in <xref
                linkend="filters"/>.</para>
        <table id="filterfunc">
            <title>Filter functions in syslog-ng</title>
            <tgroup cols="3">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Synopsis</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>facility</entry>
                        <entry>facility(facility[,facility])</entry>
                        <entry>Match messages having one of the listed facility code. An alternate
                            syntax permits the use an arbitrary facility codes.</entry>
                    </row>
                    <row>
                        <entry>facility</entry>
                        <entry>facility(&lt;numeric facility code&gt;)</entry>
                        <entry>An alternate syntax for <parameter>facility</parameter> permitting
                            the use of an arbitrary facility code. Facility codes 0-23 are
                            predefined and can be referenced by their usual name. Facility codes
                            above 24 are not defined but can be used by this alternate syntax.
                        </entry>
                    </row>
                    <row>
                        <entry>filter()</entry>
                        <entry>filter(filtername)</entry>
                        <entry>Call another filter rule and evaluate its value.</entry>
                    </row>
                    <row>
                        <entry>host()</entry>
                        <entry>host(regexp)</entry>
                        <entry>Match messages by using a regular expression against the hostname
                            field of log messages. </entry>
                    </row>
                    <row>
                        <entry>level() or priority()</entry>
                        <entry>level(pri[,pri1..pri2[,pri3]])</entry>
                        <entry>Match messages based on priority.</entry>
                    </row>
                    <row>
                        <entry>match()</entry>
                        <entry>match(regexp)</entry>
                        <entry>Match a regular expression to the headers and the message itself
                            (i.e., the values returned by the <parameter>MSGHDR</parameter> and
                                <parameter>MSG</parameter> macros). Note that in syslog-ng version
                            2.1 and earlier, the <parameter>match()</parameter> filter was applied
                            only to the text of the message, excluding the headers. This
                            functionality has been moved to the <parameter>message()</parameter>
                            filter. To limit the scope of the match to a specific part of the
                            message (identified with a macro), use the <parameter>match(regexp
                                value("$MACRO"))</parameter> syntax.</entry>
                    </row>
                    <row>
                        <entry>message()</entry>
                        <entry>message(regexp)</entry>
                        <entry>Match a regular expression to the text of the log message, excluding
                            the headers (i.e., the value returned by the <parameter>MSG</parameter>
                            macros). Note that in syslog-ng version 2.1 and earlier, this
                            functionality was performed by the <parameter>match()</parameter>
                            filter.</entry>
                    </row>
                    <row>
                        <entry>netmask()</entry>
                        <entry>netmask(ip/mask)</entry>
                        <entry>Check the sender's IP address whether it is in the specified IP
                            subnet.</entry>
                    </row>
                    <row>
                        <entry>program()</entry>
                        <entry>program(regexp)</entry>
                        <entry>Match messages by using a regular expression against the program name
                            field of log messages.</entry>
                    </row>
                    <row>
                        <entry>source()</entry>
                        <entry>string</entry>
                        <entry>Select messages of a source statement. This filter can be used in
                            embedded log statements if the parent statement contains multiple source
                            groups &mdash; only messages originating from the selected source
                            group are sent to the destination of the embedded log statement.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <indexterm>
            <primary>regular expressions</primary>
            <secondary>posix</secondary>
        </indexterm>
        <para>The <parameter>host()</parameter>, <parameter>match()</parameter>, and
                <parameter>program()</parameter> filter functions accept regular expressions as
            parameters. See <xref linkend="reference_regular_expressions"/> for details. </para>
        <para>
            <indexterm>
                <primary>filters</primary>
                <secondary>priorities</secondary>
            </indexterm> The <parameter>level()</parameter> filter accepts the following levels:
                <parameter>emerg</parameter>, <parameter>alert</parameter>,
            <parameter>crit</parameter>, <parameter>err</parameter>, <parameter>warning</parameter>,
                <parameter>notice</parameter>, <parameter>info</parameter>,
            <parameter>debug</parameter>. </para>
        <para>
            <indexterm>
                <primary>filters</primary>
                <secondary>facilities, </secondary>
            </indexterm> The <parameter>facility()</parameter> filter accepts both the name and the
            numerical code of the facility or the importance level. The syslog-ng application
            recognizes the following facilities: (Note that some of these facilities are available
            only on specific platforms.)</para>
        <!-- FIXME authpriv -->
        <table>
            <title>syslog Message Facilities recognized by the facility() filter</title>
            <?dbfo keep-together="auto" ?>
            <indexterm>
                <primary>facilities</primary>
            </indexterm>
            <indexterm>
                <primary>message facilities</primary>
            </indexterm>
            <tgroup cols="3">
                <thead>
                    <row>
                        <entry>Numerical Code</entry>
                        <entry>Facility name</entry>
                        <entry>Facility</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>0</entry>
                        <entry>kern</entry>
                        <entry>kernel messages</entry>
                    </row>
                    <row>
                        <entry>1</entry>
                        <entry>user</entry>
                        <entry>user-level messages</entry>
                    </row>
                    <row>
                        <entry>2</entry>
                        <entry>mail</entry>
                        <entry>mail system</entry>
                    </row>
                    <row>
                        <entry>3</entry>
                        <entry>daemon</entry>
                        <entry>system daemons</entry>
                    </row>
                    <row>
                        <entry>4</entry>
                        <entry>auth</entry>
                        <entry>security/authorization messages</entry>
                    </row>
                    <row>
                        <entry>5</entry>
                        <entry>syslog</entry>
                        <entry>messages generated internally by syslogd</entry>
                    </row>
                    <row>
                        <entry>6</entry>
                        <entry>lpr</entry>
                        <entry>line printer subsystem</entry>
                    </row>
                    <row>
                        <entry>7</entry>
                        <entry>news</entry>
                        <entry>network news subsystem</entry>
                    </row>
                    <row>
                        <entry>8</entry>
                        <entry>uucp</entry>
                        <entry>UUCP subsystem</entry>
                    </row>
                    <row>
                        <entry>9</entry>
                        <entry>cron</entry>
                        <entry>clock daemon</entry>
                    </row>
                    <row>
                        <entry>10</entry>
                        <entry>auth</entry>
                        <entry>security/authorization messages</entry>
                    </row>
                    <row>
                        <entry>11</entry>
                        <entry>ftp</entry>
                        <entry>FTP daemon</entry>
                    </row>
                    <row>
                        <entry>12</entry>
                        <entry><!-- FIXME --></entry>
                        <entry>NTP subsystem</entry>
                    </row>
                    <row>
                        <entry>13</entry>
                        <entry><!-- FIXME --></entry>
                        <entry>log audit</entry>
                    </row>
                    <row>
                        <entry>14</entry>
                        <entry><!-- FIXME --></entry>
                        <entry>log alert</entry>
                    </row>
                    <row>
                        <entry>15</entry>
                        <entry>cron</entry>
                        <entry>clock daemon</entry>
                    </row>
                    <row>
                        <entry>16-23</entry>
                        <entry>local0..local7</entry>
                        <entry>locally used facilities (local0-local7)</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </section>
    <section id="reference_macros">
        <title>Macros</title>
        <indexterm>
            <primary>macros</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>Certain parts of syslog-ng (e.g., destination filenames and message content templates)
            can refer to one or more macros, which get expanded as a message is processed. The table
            below summarizes the macros available in syslog-ng.</para>
        <note>
            <para>See <xref linkend="windows_message_format"/> for the macros available in the
                syslog-ng Agent for Windows application.</para>
        </note>
        <para>Macros can be included by prefixing the macro name with a <parameter>$</parameter>
            sign, just like in Bourne compatible shells. Regarding braces around macro names, the
            following two formats are equivalent <parameter>"$MSG"</parameter> and
                <parameter>"${MSG}"</parameter>. </para>
        <para>Default values for macros can also be specified by appending the
            <parameter>:-</parameter> characters and the default value to the macro, e.g.,</para>
        <synopsis>${HOST:-default_hostname}</synopsis>
        <table>
            <title>Available macros</title>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>BSDTAG</entry>
                        <entry>Facility/priority information in the format used by the FreeBSD
                            syslogd: a priority number followed by a letter that indicates the
                            facility. The priority number can range from <parameter>0</parameter> to
                                <parameter>7</parameter>. The facility letter can range from
                                <parameter>A</parameter> to <parameter>Y</parameter>, where
                                <parameter>A</parameter> corresponds to facility number zero
                            (LOG_KERN), <parameter>B</parameter> corresponds to facility 1
                            (LOG_USER), etc.</entry>
                    </row>
                    <row id="macro_date">
                        <entry>DATE, R_DATE, S_DATE</entry>
                        <entry>Date of the message using the BSD-syslog style timestamp format
                            (month/day/hour/minute/second, each expressed in two digits). This is
                            the original syslog time stamp without year information, e.g.:
                                <parameter>Jun 13 15:58:00</parameter>. </entry>
                    </row>
                    <row id="macro_day">
                        <entry>DAY, R_DAY, S_DAY</entry>
                        <entry>The day the message was sent. </entry>
                    </row>
                    <row id="macro_facility">
                        <entry>FACILITY</entry>
                        <entry>The facility that sent the message.</entry>
                    </row>
                    <row id="macro_fulldate">
                        <entry>FULLDATE, R_FULLDATE, S_FULLDATE</entry>
                        <entry>A nonstandard format for the date of the message using the same
                            format as <parameter>DATE</parameter>, but including the year as well,
                            e.g.: <parameter>2006 Jun 13 15:58:00</parameter>.</entry>
                    </row>
                    <row>
                        <entry>FULLHOST</entry>
                        <entry>The full FQDN of the host name chain (without trimming chained
                            hosts), including the domain name. To use this macro, make sure that the
                                <link linkend="source_commonoption_keep_hostname">
                                <parameter>keep_hostname()</parameter>
                            </link> option is enabled.</entry>
                    </row>
                    <row>
                        <entry>FULLHOST_FROM</entry>
                        <entry>FQDN of the host that sent the message to syslog-ng as resolved by
                            syslog-ng using DNS. If the message traverses several hosts, this is the
                            last host in the chain. To use this macro, make sure that the <link
                                linkend="source_commonoption_keep_hostname">
                                <parameter>keep_hostname()</parameter>
                            </link> option is enabled.</entry>
                    </row>
                    <row id="macro_hour">
                        <entry>HOUR, R_HOUR, S_HOUR</entry>
                        <entry>The hour of day the message was sent. </entry>
                    </row>
                    <row id="macro_host">
                        <entry>HOST</entry>
                        <entry>The name of the source host where the message originates from. If the
                            message traverses several hosts and the <link
                                linkend="option_chain_hostnames">
                                <parameter>chain_hostnames()</parameter>
                            </link> option is on, the first host in the chain is used. To use this
                            macro, make sure that the <link
                                linkend="source_commonoption_keep_hostname">
                                <parameter>keep_hostname()</parameter>
                            </link> option is enabled.</entry>
                    </row>
                    <row>
                        <entry>HOST_FROM</entry>
                        <entry>Name of the host that sent the message to syslog-ng, as resolved by
                            syslog-ng using DNS. If the message traverses several hosts, this is the
                            last host in the chain. To use this macro, make sure that the <link
                                linkend="source_commonoption_keep_hostname">
                                <parameter>keep_hostname()</parameter>
                            </link> option is enabled.</entry>
                    </row>
                    <row id="macro_isodate">
                        <entry>ISODATE, R_ISODATE, S_ISODATE</entry>
                        <entry>Date of the message in the ISO 8601 compatible standard timestamp
                            format (yyyy-mm-ddThh:mm:ss+-ZONE), e.g.:
                                <parameter>2006-06-13T15:58:00.123+01:00</parameter>. If possible,
                            it is recommended to use <parameter>ISODATE</parameter> for
                            timestamping. Note that syslog-ng can produce fractions of a second
                            (e.g., milliseconds) in the timestamp by using the
                                <parameter>frac_digits()</parameter> global or per-destination
                            option.</entry>
                    </row>
                    <row id="macro_min">
                        <entry>MIN, R_MIN, S_MIN</entry>
                        <entry>The minute the message was sent. </entry>
                    </row>
                    <row id="macro_month">
                        <entry>MONTH, R_MONTH, S_MONTH</entry>
                        <entry>The month the message was sent as a decimal value, prefixed with a
                            zero if smaller than 10. </entry>
                    </row>
                    <row id="macro_month_abbrev">
                        <entry>MONTH_ABBREV, R_MONTH_ABBREV, S_MONTH_ABBREV</entry>
                        <entry>The English abbreviation of the month name (3 letters). </entry>
                    </row>
                    <row id="macro_month_name">
                        <entry>MONTH_NAME, R_MONTH_NAME, S_MONTH_NAME</entry>
                        <entry>The English name of the month name. </entry>
                    </row>
                    <row id="macro_month_week">
                        <entry>MONTH_WEEK, R_MONTH_WEEK, S_MONTH_WEEK</entry>
                        <entry>The number of the week in the given month (1-5). </entry>
                    </row>
                    <row id="macro_msg">
                        <entry>MSG or MESSAGE</entry>
                        <entry>Text contents of the log message without the program name and pid.
                            Note that this has changed in syslog-ng version 3.0; in earlier versions
                            this macro included the program name and the pid. In syslog-ng 3.0, the
                                <parameter>MSG</parameter> macro became equivalent with the
                                <parameter>MSGONLY</parameter> macro. The program name and the pid
                            together are available in the <parameter>MSGHDR</parameter>
                        macro.</entry>
                    </row>
                    <row>
                        <entry>MSGHDR</entry>
                        <entry>The name and the pid of the program that sent the log message in
                                <parameter>PROGRAM: PID </parameter> format. Includes a trailing
                            whitespace. Note that the macro returns an empty value if both the
                            program and pid fields of the message are empty.</entry>
                    </row>
                    <row>
                        <entry>MSGONLY</entry>
                        <entry>Message contents without the program name or pid. </entry>
                    </row>
                    <row>
                        <entry>PID</entry>
                        <entry>The PID of the program sending the message. </entry>
                    </row>
                    <row id="macro_pri">
                        <entry>PRI</entry>
                        <entry>The priority and facility encoded as a 2 or 3 digit decimal number as
                            it is present in syslog messages. </entry>
                    </row>
                    <row id="macro_priority">
                        <entry>PRIORITY or LEVEL</entry>
                        <entry>The priority of the message. </entry>
                    </row>
                    <row>
                        <entry>PROGRAM</entry>
                        <entry>The name of the program sending the message. Note that the content of
                            the $PROGRAM variable may not be completely trusted as it is provided by
                            the client program that constructed the message.</entry>
                    </row>
                    <row id="macro_sdata">
                        <entry>SDATA.SDID.SDNAME</entry>
                        <entry>The syslog-ng application automatically parses the STRUCTURED-DATA
                            part of IETF-syslog messages, which can be referenced in macros. For
                            example, if a log message contains the following structured data:
                                <parameter>[exampleSDID@0 iut="3" eventSource="Application"
                                eventID="1011"][examplePriority@0 class="high"]</parameter> you can
                            use macros like: <parameter>${SDATA.EXAMPLE.EVENTSOURCE}</parameter>.
                        </entry>
                    </row>
                    <row id="macro_sec">
                        <entry>SEC, R_SEC, S_SEC</entry>
                        <entry>The second the message was sent. </entry>
                    </row>
                    <row id="macro_seqnum">
                        <entry>SEQNUM</entry>
                        <entry>The sequence number of the message is a unique identifier of the
                            message between the end-points. The syslog-ng client calculates this
                            number when processing a new message from a local source; it is not
                            calculated for relayed messages. The sequence number increases for every
                            message, and is not lost even if syslog-ng is reloaded or restarted. The
                            sequence number is a part of every message that uses the new IETF-syslog
                            protocol (<parameter>.SDATA.meta.sequenceId</parameter>), and can be
                            added to BSD-syslog messages using this macro.</entry>
                        <!-- FIXME kellene rola leiras/concept esetleg -->
                    </row>
                    <row>
                        <entry>SOURCEIP</entry>
                        <entry>IP address of the host that sent the message to syslog-ng. (I.e. the
                            IP address of the host in the <parameter>FULLHOST_FROM</parameter>
                            macro.) Please note that when a message traverses several relays, this
                            macro contains the IP of the last relay. </entry>
                    </row>
                    <row id="macro_stamp">
                        <entry>STAMP, R_STAMP, S_STAMP</entry>
                        <entry>A timestamp formatted according to the <link
                                linkend="reference_options">
                                <parameter>ts_format()</parameter>
                            </link> global or per-destination option.</entry>
                    </row>
                    <row id="macro_tag">
                        <entry>TAG</entry>
                        <entry>The priority and facility encoded as a 2 digit hexadecimal number.
                        </entry>
                    </row>
                    <row id="macro_tz">
                        <entry>TZ, R_TZ, S_TZ</entry>
                        <entry>Equivalent to TZOFFSET, used to mean the time zone name abbreviation
                            in syslog-ng 1.6.x. </entry>
                    </row>
                    <row id="macro_tzoffset">
                        <entry>TZOFFSET, R_TZOFFSET, S_TZOFFSET</entry>
                        <entry>The time-zone as hour offset from GMT; e.g.:
                            <parameter>-07:00</parameter>. In syslog-ng 1.6.x this used to be
                                <parameter>-0700</parameter> but as <parameter>ISODATE</parameter>
                            requires the colon it was added to <parameter>TZOFFSET</parameter> as
                            well. </entry>
                    </row>
                    <row id="macro_unixtime">
                        <entry>UNIXTIME, R_UNIXTIME, S_UNIXTIME</entry>
                        <entry>Standard unix timestamp, represented as the number of seconds since
                                <parameter>1970-01-01T00:00:00</parameter>. </entry>
                    </row>
                    <row id="macro_year">
                        <entry>YEAR, R_YEAR, S_YEAR</entry>
                        <entry>The year the message was sent. </entry>
                    </row>
                    <row id="macro_week">
                        <entry>WEEK, R_WEEK, S_WEEK</entry>
                        <entry>The week number of the year, prefixed with a zero for the first nine
                            week of the year. (The first Monday in the year marks the first
                        week.)</entry>
                    </row>
                    <row id="macro_week_abbrev">
                        <entry>WEEK_ABBREV, R_WEEK_ABBREV, S_WEEK_ABBREV</entry>
                        <entry>The English abbreviation of the name of the day (3 letters).</entry>
                    </row>
                    <row id="macro_week_day">
                        <entry>WEEK_DAY, R_WEEK_DAY, S_WEEK_DAY</entry>
                        <entry>The day of the week as a numerical value (1-7).</entry>
                    </row>
                    <row id="macro_weekday">
                        <entry>WEEKDAY, R_WEEKDAY, S_WEEKDAY</entry>
                        <entry>The 3-letter name of the day of week the message was sent, e.g.
                                <parameter>Thu</parameter>. </entry>
                    </row>
                    <row id="macro_week_day_name">
                        <entry>WEEK_DAY_NAME, R_WEEK_DAY_NAME, S_WEEK_DAY_NAME</entry>
                        <entry>The English name of the day.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </section>
    <section id="reference_parsers">
        <title>Message parsers</title>
        <indexterm>
            <primary>parsers</primary>
            <secondary>reference</secondary>
        </indexterm>
        <indexterm>
            <primary>message parsing</primary>
        </indexterm>
        <indexterm>
            <primary>parsing messages</primary>
        </indexterm>
        <indexterm>
            <primary>segmenting messages</primary>
        </indexterm>
        <indexterm>
            <primary>splitting messages</primary>
        </indexterm>
        <para>The syslog-ng application can separate parts of log messages (i.e., the contents of
            the $MSG macro) to named fields (columns). These fields act as user-defined macros that
            can be referenced in message templates, file- and tablenames, etc. </para>
        <para>To create a parser, define the columns of the message, the delimiter or separator
            characters, and optionally the characters that are used to escape the delimiter
            characters (quote-pairs).</para>
        <synopsis>Declaration:
    parser parser_name {
        csv-parser(column1, column2, ...)
        delimiters()
        quote-pairs()
    };</synopsis>
        <para>Column names work like macros. Always use a prefix to identify the columns of the
            parsers, e.g., <parameter>MYPARSER1.COLUMN1, MYPARSER2.COLUMN2</parameter>, etc. Column
            names starting with a dot (e.g., <parameter>.HOST</parameter>) are reserved for use by
            syslog-ng. </para>
        <table id="parser_options">
            <title>Parser parameters</title>
            <tgroup cols="3">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Synopsis</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>csv-parser</entry>
                        <entry>csv-parser(columns("PARSER.COLUMN1", "PARSER.COLUMN2", ...))</entry>
                        <entry>Specifies the type of parser to use, and the name of the columns to
                            separate messages to. Currently only the
                            <parameter>csv-parser</parameter> is implemented, which can separate
                            columns based on delimiter characters and strings.</entry>
                    </row>
                    <row>
                        <entry>delimiters</entry>
                        <entry>delimiters("&lt;delimiter_characters&gt;")</entry>
                        <entry>The character that separates the columns in the message. </entry>
                    </row>
                    <row>
                        <entry>flags()</entry>
                        <entry>flags(escape-none,escape-backslash,escape-double-char,strip-whitespace
                            )</entry>
                        <entry>
                            <para>Escaping rules used by the parser. </para>
                            <para>The <parameter>strip-whitespace</parameter> flag removes trailing
                                whitespaces from the beginning and the end of the columns.</para>
                            <para>The <parameter>greedy</parameter> option assigns the remainder of
                                the message to the last column, regardless of the delimiter
                                characters set. You can use this option to process messages where
                                the number of columns varies.</para>
                        </entry>
                    </row>
                    <row>
                        <entry>quote-pairs()</entry>
                        <entry>quote-pairs('&lt;quote_pairs&gt;')</entry>
                        <entry>List quote-pairs between single quotes. Delimiter characters enclosed
                            between quote characters are ignored. Note that the beginning and ending
                            quote character does not have to be identical, e.g.,
                            <parameter>[}</parameter> can also be a quote-pair.</entry>
                    </row>
                    <row>
                        <entry>template()</entry>
                        <entry>template("${&lt;macroname&gt;}")</entry>
                        <entry>The macro that contains the part of the message that the parser will
                            process. It can also be a macro created by a previous parser of the log
                            path. By default, this is empty and the parser processes the entire
                            message.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>

        <example id="example_parser">
            <title>Segmenting hostnames separated with a dash</title>
            <para>The following example separates hostnames like <parameter>example-1</parameter>
                and <parameter>example-2</parameter> into two parts.</para>
            <synopsis>parser p_hostname_segmentation {
    csv-parser(columns("HOSTNAME.NAME", "HOSTNAME.ID")
    delimiters("-")
    flags(escape-none)
    template("${HOST}"));
};
destination d_file { file("/var/log/messages-${HOSTNAME.NAME:-examplehost}"); };
log { source(s_local); parser(p_hostname_segmentation); destination(d_file);};</synopsis>
        </example>
        <example id="example_parser_apache">
            <title>Parsing Apache log files</title>
            <para>The following parser processes the log of Apache web servers and separates them
                into different fields. Apache log messages can be formatted like:</para>
            <synopsis>"%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %T %v"</synopsis>.
                <para>Here is a sample message: </para>
            <synopsis>192.168.1.1 - - [31/Dec/2007:00:17:10 +0100] "GET /cgi-bin/example.cgi HTTP/1.1" 200 2708 "-" "curl/7.15.5 (i4 86-pc-linux-gnu) libcurl/7.15.5 OpenSSL/0.9.8c zlib/1.2.3 libidn/0.6.5" 2 example.balabit</synopsis>.
                <para>To parse such logs, the delimiter character is set to a single whitespace
                    (<parameter>delimiters(" ")</parameter>). Whitespaces between quotes and
                brackets are ignored (<parameter>quote-pairs('""[]')</parameter>).</para>
            <synopsis>parser p_apache {
    csv-parser(columns("APACHE.CLIENT_IP", "APACHE.IDENT_NAME", "APACHE.USER_NAME",
        "APACHE.TIMESTAMP", "APACHE.REQUEST_URL", "APACHE.REQUEST_STATUS",
        "APACHE.CONTENT_LENGTH", "APACHE.REFERER", "APACHE.USER_AGENT",
        "APACHE.PROCESS_TIME", "APACHE.SERVER_NAME")
         flags(escape-double-char,strip-whitespace)
         delimiters(" ")
         quote-pairs('""[]')
         );
};</synopsis>
            <para>The results can be used for example to separate log messages into different files
                based on the APACHE.USER_NAME field. If the field is empty, the
                <parameter>nouser</parameter> name is assigned.</para>
            <synopsis>log { source(s_local);
    parser(p_apache); destination(d_file);};
};
destination d_file { file("/var/log/messages-${APACHE.USER_NAME:-nouser}"); };</synopsis>
        </example>
        <example id="example_parser_multiple">
            <title>Segmenting a part of a message</title>
            <para>The following example splits the timestamp of a parsed Apache log message into
                separate fields.</para>
            <synopsis>parser p_apache_timestamp {
    csv-parser(columns("APACHE.TIMESTAMP.DAY", "APACHE.TIMESTAMP.MONTH", "APACHE.TIMESTAMP.YEAR", "APACHE.TIMESTAMP.HOUR", "APACHE.TIMESTAMP.MIN", "APACHE.TIMESTAMP.MIN", "APACHE.TIMESTAMP.ZONE")
    delimiters("/: ")
    flags(escape-none)
    template("${APACHE.TIMESTAMP}"));
    };
log { source(s_local);
    log { parser(p_apache); parser(p_apache_timestamp); destination(d_file);};
};
</synopsis>
        </example>
        <example id="example_parser_greedy">
            <title>Adding the end of the message to the last column</title>
            <para>If the <parameter>greedy</parameter> option is enabled, the syslog-ng application
                adds the not-yet-parsed part of the message to the last column, ignoring any
                delimiter characters that may appear in this part of the message.</para>
            <para>For example, you receive the following comma-separated message: <parameter>example
                    1, example2, example3</parameter>, and you segment it with the following parser:</para>
            <synopsis>csv_parser(columns("COLUMN1", "COLUMN2", "COLUMN3") delimiters(","));</synopsis>.
                <para>The <parameter>COLUMN1</parameter>, <parameter>COLUMN2</parameter>, and
                    <parameter>COLUMN3</parameter> variables will contain the strings
                    <parameter>example1</parameter>, <parameter>example2</parameter>, and
                    <parameter>example3</parameter>, respectively. If the message looks like
                    <parameter>example 1, example2, example3, some more information</parameter>,
                then any text appearing after the third comma (i.e., <parameter>some more
                    information</parameter>) is not parsed, and possibly lost if you use only the
                variables to reconstruct the message (for example, to send it to different columns
                of an SQL table). </para>
            <para>Using the <parameter>greedy</parameter> flag will assign the remainder of the
                message to the last column, so that the <parameter>COLUMN1</parameter>,
                    <parameter>COLUMN2</parameter>, and <parameter>COLUMN3</parameter> variables
                will contain the strings <parameter>example1</parameter>,
                <parameter>example2</parameter>, and <parameter>example3, some more
                information</parameter>.</para>
            <synopsis>csv_parser(columns("COLUMN1", "COLUMN2", "COLUMN3") delimiters(",") flags(greedy));</synopsis>
        </example>

    </section>
    <section id="reference_rewrite">
        <title>Rewriting messages</title>
        <indexterm>
            <primary>rewrite</primary>
            <secondary>reference</secondary>
        </indexterm>
        <indexterm>
            <primary>rewriting messages</primary>
        </indexterm>
        <indexterm>
            <primary>sedding messages</primary>
        </indexterm>
        <indexterm>
            <primary>replacing message text</primary>
        </indexterm>
        <para>The syslog-ng application can rewrite parts of log
            messages<!--( i.e., the contents of
        the $MSG macro)-->: it can search and
            replace text, and also set a specific field to a specified value. Rewriting messages is
            often used in conjunction with message parsing <xref linkend="reference_parsers"/>.</para>
        <para>To create replace a part of the log message, define the string or regular expression
            to replace, the string to replace the original text (macros can be used as well), and
            the field of the message that the rewrite rule should process. Substitution rules can
            operate on any value available via macros, e.g., HOST, MESSAGE, PROGRAM, or any
            user-defined macros created using parsers (see <xref linkend="reference_parsers"/> for
            details.). Substitution rules use the following syntax:</para>
        <synopsis>Declaration:
    rewrite &lt;name_of_the_rule&gt;
        {subst("&lt;string or regular expression to find&gt;", "&lt;replacement string&gt;", value(&lt;field name&gt;));};</synopsis>
        <example id="example_rewrite_subst">
            <title>Using substitution rules</title>
            <para>The following example replaces the first occurrence of the string
                <parameter>IP</parameter> in the text of the message with the string
                    <parameter>IP-Address</parameter>.</para>
            <synopsis>rewrite r_rewrite_subst{subst("IP", "IP-Address", value("MESSAGE"));};</synopsis>
            <para>To replace every occurrence, use:</para>
            <synopsis>rewrite r_rewrite_subst{subst("IP", "IP-Address", value("MESSAGE"), flags("global"));};</synopsis>
            <para>Multiple substitution rules are applied sequentially; the following rules replace
                the first occurrence of the string <parameter>IP</parameter> with the string
                    <parameter>IP-Addresses</parameter>. </para>
            <synopsis>rewrite r_rewrite_subst{subst("IP", "IP-Address", value("MESSAGE")); subst("Address", "Addresses", value("MESSAGE"));};</synopsis>
        </example>
        <indexterm>
            <primary>setting message fields</primary>
        </indexterm>
        <para>To set a field of the message to a specific value, define the string to include in the
            message, and the field where it should be included. Setting a field can operate on any
            value available via macros, e.g., HOST, MESSAGE, PROGRAM, or any user-defined macros
            created using parsers (see <xref linkend="reference_parsers"/> for details.). Note that
            this operation completely replaces any previous value of that field. Use the following
            syntax:</para>
        <synopsis>Declaration:
    rewrite &lt;name_of_the_rule&gt;
        {set("&lt;string to include&gt;", value(&lt;field name&gt;));};</synopsis>
        <example id="example_rewrite_set">
            <title>Setting message fields to a particular value</title>
            <para>The following example sets the HOST field of the message to
                <parameter>myhost</parameter>. </para>
            <synopsis>rewrite r_rewrite_set{set("myhost", value("HOST"));};</synopsis>
        </example>
    </section>
    <section id="reference_regular_expressions">
        <title>Regular expressions</title>
        <indexterm significance="preferred">
            <primary>regular expressions</primary>
        </indexterm>
        <para>Filters and substitution rewrite rules can use regular expressions. By default,
            syslog-ng uses POSIX-style regular expressions, but if compiled with the
                <parameter>--enable-pcre</parameter> option, Perl Compatible Regular Expressions can
            be used as well. The regular expressions can use up to 255 regexp matches
                (<parameter>${1} ... ${255}</parameter>), but only from the last filter. For
            case-insensitive searches, use the <parameter>flags("ignore-case")</parameter> option.</para>
        <indexterm>
            <primary>regular expressions</primary>
            <secondary>pcre</secondary>
        </indexterm>
        <para>To use Perl Compatible Regular Expressions (PCRE), add the
            <parameter>type("pcre")</parameter> option after the regular expression. Note that PCRE
            expressions can be used only if syslog-ng was compiled with the
            <parameter>--enable-pcre</parameter> option. Execute the <command>syslog-ng -V</command>
            command to list the options supported by your binary.</para>
        <para>Posix regular expressions have the following flag options:</para>
        <table>
            <title>Posix options</title>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>global</entry>
                        <entry>Usable only in rewrite rules; match for every occurrence of the
                            expression, not only the first one.</entry>
                    </row>
                    <row>
                        <entry>ignore-case</entry>
                        <entry>Disable case-sensitivity.</entry>
                    </row>
                    <row>
                        <entry>newline</entry>
                        <entry><!-- FIXME --></entry>
                    </row>
                    <row>
                        <entry>utf8</entry>
                        <entry><!-- FIXME --></entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <para>PCRE regular expressions have the following flag options:</para>
        <example id="example_regexp_posix">
            <title>Using Posix regular expressions</title>
            <synopsis>filter f_message { message("keyword" flags("utf8" "ignore-case") );</synopsis>
        </example>
        <table>
            <title>PCRE options</title>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>global</entry>
                        <entry>Usable only in rewrite rules; match for every occurrence of the
                            expression, not only the first one.</entry>
                    </row>
                    <row>
                        <entry>ignore-case</entry>
                        <entry>Disable case-sensitivity.</entry>
                    </row>
                    <row>
                        <entry>newline</entry>
                        <entry><!-- FIXME --></entry>
                    </row>
                    <row>
                        <entry>nobackref</entry>
                        <entry>Do not store back references for the matches &mdash; improves
                            performance.</entry>
                    </row>
                    <row>
                        <entry>unicode</entry>
                        <entry><!-- FIXME --></entry>
                    </row>
                    <row>
                        <entry>utf8</entry>
                        <entry><!-- FIXME --></entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <example id="example_regexp_pcre">
            <title>Using PCRE regular expressions</title>
            <synopsis>rewrite r_rewrite_subst 
        {subst("a*", "?", field("message") type("pcre") flags("utf8" "global"));  };</synopsis>
        </example>
    </section>


    <section id="reference_options">
        <title>Global options</title>
        <indexterm>
            <primary>options</primary>
            <secondary>reference</secondary>
        </indexterm>
        <indexterm>
            <primary>global options</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>The following options can be specified in the options statement, as described in <xref
                linkend="options"/>.</para>
        <table>
            <title>List of global options supported in syslog-ng</title>
            <tgroup cols="4">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Accepted values</entry>
                        <entry>Default</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>bad_hostname()</entry>
                        <entry>regular expression</entry>
                        <entry>no</entry>
                        <entry>A regexp containing hostnames which should not be handled as
                            hostnames. </entry>
                    </row>
                    <row id="option_chain_hostnames">
                        <entry>chain_hostnames()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>Enable or disable the chained hostname format.</entry>
                    </row>
                    <row>
                        <entry>check_hostname()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>Enable or disable checking whether the hostname contains valid
                            characters.</entry>
                    </row>
                    <row>
                        <entry>create_dirs()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>Enable or disable directory creation for destination files.</entry>
                    </row>
                    <row>
                        <entry>dir_group()</entry>
                        <entry>groupid</entry>
                        <entry>root</entry>
                        <entry>The default group for newly created directories.</entry>
                    </row>
                    <row>
                        <entry>dir_owner()</entry>
                        <entry>userid</entry>
                        <entry>root</entry>
                        <entry>The default owner of newly created directories.</entry>
                    </row>
                    <row>
                        <entry>dir_perm()</entry>
                        <entry>permission value</entry>
                        <entry>0700</entry>
                        <entry>The default permission for newly created directories.</entry>
                    </row>
                    <row>
                        <entry>dns_cache()</entry>
                        <entry>yes or no</entry>
                        <entry>yes</entry>
                        <entry>Enable or disable DNS cache usage.</entry>
                    </row>
                    <row>
                        <entry>dns_cache_expire()</entry>
                        <entry>number</entry>
                        <entry>3600</entry>
                        <entry>Number of seconds while a successful lookup is cached.</entry>
                    </row>
                    <row>
                        <entry>dns_cache_expire_failed()</entry>
                        <entry>number</entry>
                        <entry>60</entry>
                        <entry>Number of seconds while a failed lookup is cached.</entry>
                    </row>
                    <row>
                        <entry>dns_cache_hosts()</entry>
                        <entry>filename</entry>
                        <entry>unset</entry>
                        <entry>Name of a file in <filename>/etc/hosts</filename> format that
                            contains static IP->hostname mappings. Use this option to resolve
                            hostnames locally without using a DNS. Note that any change to this file
                            triggers a reload in syslog-ng and is instantaneous. </entry>
                    </row>
                    <row>
                        <entry>dns_cache_size()</entry>
                        <entry>number</entry>
                        <entry>1007</entry>
                        <entry>Number of hostnames in the DNS cache.</entry>
                    </row>
                    <row>
                        <entry>frac_digits()</entry>
                        <entry>number</entry>
                        <entry>0</entry>
                        <entry>The syslog-ng application can store fractions of a second in the
                            timestamps according to the ISO8601 format. The
                            <parameter>frac_digits()</parameter> parameter specifies the number of
                            digits stored. The digits storing the fractions are padded by zeros if
                            the original timestamp of the message specifies only seconds. Fractions
                            can always be stored for the received time of the messages.</entry>
                    </row>
                    <row>
                        <entry>flush_lines()</entry>
                        <entry>number</entry>
                        <entry>0</entry>
                        <entry>Specifies how many lines are flushed to a destination at a time.
                            Syslog-ng waits for this number of lines to accumulate and sends them
                            off in a single batch. Setting this number high increases throughput as
                            fully filled frames are sent to the network, but also increases message
                            latency. The latency can be limited by the use of the
                                <parameter>flush_timeout</parameter> option. </entry>
                    </row>
                    <row>
                        <entry>flush_timeout()</entry>
                        <entry>time in milliseconds</entry>
                        <entry>10000</entry>
                        <entry>Specifies the time syslog-ng waits for lines to accumulate in its
                            output buffer. See the <parameter>flush_lines()</parameter> option for
                            more information. </entry>
                    </row>
                    <!--<row>
                        <entry>gc_busy_threshold() (DEPRECATED)</entry>
                        <entry>number</entry>
                        <entry>n/a</entry>
                        <entry>Has no meaning in syslog-ng 1.9.x and later. </entry>
                    </row>
                    <row>
                        <entry>gc_idle_threshold() (DEPRECATED)</entry>
                        <entry>number</entry>
                        <entry>n/a</entry>
                        <entry>Has no meaning in syslog-ng 1.9.x and later. </entry>
                    </row>-->
                    <row>
                        <entry>group()</entry>
                        <entry>groupid</entry>
                        <entry>root</entry>
                        <entry>The default group of output files. By default, syslog-ng changes the
                            privileges of accessed files (e.g., <parameter>/dev/null</parameter>) to
                                <parameter>root.root 0600</parameter>. To disable modifying
                            privileges, use this option with the <parameter>-1</parameter>
                        value.</entry>
                    </row>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(source_commonoption_keep_hostname)"/>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(source_commonoption_keep_timestamp)"/>
                    <row>
                        <entry>log_fifo_size()</entry>
                        <entry>number</entry>
                        <entry>100</entry>
                        <entry>The number of lines fitting to the output queue</entry>
                    </row>
                    <row>
                        <entry>log_msg_size()</entry>
                        <entry>number</entry>
                        <entry>8192</entry>
                        <entry>Maximum length of a message in bytes.</entry>
                    </row>
                    <row>
                        <entry>normalize_hostnames()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>Normalize hostnames, which currently translates to converting them to
                            lower case. (requires 1.9.9)</entry>
                    </row>
                    <row>
                        <entry>owner()</entry>
                        <entry>userid</entry>
                        <entry>root</entry>
                        <entry>The default owner of output files. By default, syslog-ng changes the
                            privileges of accessed files (e.g., <parameter>/dev/null</parameter>) to
                                <parameter>root.root 0600</parameter>. To disable modifying
                            privileges, use this option with the <parameter>-1</parameter>
                        value.</entry>
                    </row>
                    <row>
                        <entry>mark()</entry>
                        <entry>number</entry>
                        <entry>1200</entry>
                        <entry>An alias for the obsolete <parameter>mark_freq()</parameter> option,
                            retained for compatibility with syslog-ng version 1.6.x.</entry>
                    </row>
                    <row>
                        <entry>mark_freq()</entry>
                        <entry>number</entry>
                        <entry>1200</entry>
                        <entry>The number of seconds between two <parameter>MARK</parameter>
                            messages. <parameter>MARK</parameter> messages are generated when there
                            was no message traffic to inform the receiver that the connection is
                            still alive. Note that only local messages postpone the sending of the
                                <parameter>MARK</parameter> message, relayed messages do not. If set
                            to zero (<parameter>0</parameter>), no <parameter>MARK</parameter>
                            messages are sent. </entry>
                    </row>
                    <row>
                        <entry>perm()</entry>
                        <entry>permission value</entry>
                        <entry>0600</entry>
                        <entry>The default permission for output files. By default, syslog-ng
                            changes the privileges of accessed files (e.g.,
                            <parameter>/dev/null</parameter>) to <parameter>root.root
                            0600</parameter>. To disable modifying privileges, use this option with
                            the <parameter>-1</parameter> value.</entry>
                    </row>
                    <row>
                        <entry>recv_time_zone()</entry>
                        <entry>time offset (e.g.: <parameter>+03:00</parameter>)</entry>
                        <entry>local timezone</entry>
                        <entry>Specifies the time zone associated with the incoming messages, if not
                            specified otherwise in the message or in the source driver. See also
                                <xref linkend="timezone_handling"/> and <xref
                                linkend="example_timezones"/> for details.</entry>
                    </row>
                    <row>
                        <entry>send_time_zone()</entry>
                        <entry>time offset (e.g.: <parameter>+03:00</parameter>)</entry>
                        <entry>local timezone</entry>
                        <entry>Specifies the time zone associated with the messages sent by
                            syslog-ng, if not specified otherwise in the message or in the
                            destination driver. See <xref linkend="timezone_handling"/> for
                        details.</entry>
                    </row>
                    <row>
                        <entry>stats_freq()</entry>
                        <entry>number</entry>
                        <entry>600</entry>
                        <entry>The period between two STATS messages in seconds. STATS are log
                            messages sent by syslog-ng, containing statistics about dropped log
                            messages.</entry>
                    </row>
                    <row>
                        <entry>sync() or sync_freq() (DEPRECATED)</entry>
                        <entry>number</entry>
                        <entry>0</entry>
                        <entry>Obsolete aliases for <parameter>flush_lines()</parameter></entry>
                    </row>
                    <row>
                        <entry>time_reap()</entry>
                        <entry>number</entry>
                        <entry>60</entry>
                        <entry>The time to wait in seconds before an idle destination file is
                            closed.</entry>
                    </row>
                    <row>
                        <entry>time_reopen()</entry>
                        <entry>number</entry>
                        <entry>60</entry>
                        <entry>The time to wait in seconds before a dead connection is
                            reestablished.</entry>
                    </row>
                    <row>
                        <entry>time_sleep()</entry>
                        <entry>number</entry>
                        <entry>0</entry>
                        <entry>The time to wait in milliseconds between each invocation of the
                                <parameter>poll()</parameter> iteration.</entry>
                    </row>
                    <row>
                        <entry>ts_format()</entry>
                        <entry>rfc3164, bsd, rfc3339, iso</entry>
                        <entry>rfc3164</entry>
                        <entry>Specifies the timestamp format used when syslog-ng itself formats a
                            timestamp and nothing else specifies a format (e.g.:
                            <parameter>STAMP</parameter> macros, internal messages, messages without
                            original timestamps). See also <xref linkend="example_timezones"
                        />.</entry>
                    </row>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(source_commonoption_use_dns)"/>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(source_commonoption_use_fqdn)"/>
                    <row>
                        <entry>use_time_recvd() (DEPRECATED)</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>
                            <para>This option controls how the time related macros are expanded in
                                filename and content templates. If set to yes, then the non-prefixed
                                versions of the time related macros (e.g.:
                                <parameter>HOUR</parameter> instead of <parameter>R_HOUR</parameter>
                                and <parameter>S_HOUR</parameter>) refer to the time when the
                                message was received, otherwise it refers to the timestamp which is
                                in the message. </para>
                            <para>NOTE: The timestamps in the messages are generated by the
                                originating host and might not be accurate. </para>
                            <para>This option is deprecated as many users assumed that it controls
                                the timestamp as it is written to logfiles/destinations, which is
                                not the case. To change how messages are formatted, specify a
                                content-template referring to the appropriate prefixed
                                    (<parameter>S_</parameter> or <parameter>R_</parameter>) time
                                macro. </para>
                        </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </section>
    <section id="tlsoptions">
        <title>TLS options</title>
        <indexterm>
            <primary>TLS</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>The syslog-ng application is able to encrypt incoming and outgoing syslog message
            flows using SSL/TLS, if the TCP transport protocol (the <parameter>tcp()</parameter> or
                <parameter>tcp6()</parameter> sources or destination) is used. </para>
        <note>
            <para>The format of the TLS connections used by syslog-ng is similar to using syslog-ng
                and stunnel, but the source IP information is not lost. </para>
        </note>
        <para>To encrypt connections, use the <parameter>tls()</parameter> option in the source and
            destination statements. </para>
        <para>The tls() option can include the following settings: </para>
        <table>
            <title>List of TLS options</title>
            <tgroup cols="4">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Accepted values</entry>
                        <entry>Default</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>ca_dir()</entry>
                        <entry>Directory name</entry>
                        <entry>none</entry>
                        <entry>Name of a directory, that contains a set of trusted CA certificates
                            in PEM format. The CA certificate files has to be named after the 32-bit
                            hash of the subject's name. This naming can be created using the
                            c_rehash utility in openssl. </entry>
                    </row>
                    <row>
                        <entry>cert_file()</entry>
                        <entry>Filename</entry>
                        <entry>none</entry>
                        <entry>Name of a file, that contains an X.509 certificate in PEM format,
                            suitable as a TLS certificate, matching the private key. </entry>
                    </row>
                    <row>
                        <entry>crl_dir()</entry>
                        <entry>Directory name</entry>
                        <entry>none</entry>
                        <entry>Name of a directory that contains the Certificate Revocation Lists
                            for trusted CAs. Similarly to <parameter>ca_dir()</parameter> files, use
                            the 32-bit hash of the name of the issuing CAs as filenames. The
                            extension of the files must be <parameter>.r0</parameter>.</entry>
                    </row>
                    <row>
                        <entry>key_file()</entry>
                        <entry>Filename</entry>
                        <entry>none</entry>
                        <entry>Name of a file, that contains an unencrypted private key in PEM
                            format, suitable as a TLS key. </entry>
                    </row>
                    <row>
                        <entry>peer_verify()</entry>
                        <entry>optional-trusted | optional-untrusted | required-trusted |
                            required-untrusted</entry>
                        <entry>required-trusted</entry>
                        <entry>Verification method of the peer, the four possible values is a
                            combination of two properties of validation: whether the peer is
                            required to provide a certificate (required or optional prefix), and
                            whether the certificate provided needs to be trusted or not. For
                            untrusted certificates only the existence of the certificate is checked,
                            but it does not have to be valid &mdash; syslog-ng accepts the
                            certificate even if it is expired, signed by an unknown CA, or its CN
                            and the name of the machine mismatch. </entry>
                    </row>
                    <row>
                        <entry>trusted_dn()</entry>
                        <entry>list of accepted distinguished names</entry>
                        <entry>none</entry>
                        <entry>To accept connections only from hosts using certain certificates
                            signed by the trusted CAs, list the distinguished names of the accepted
                            certificates in this parameter. E.g., using <parameter>trusted_dn("*,
                                O=Example Inc, ST=Some-State, C=*")</parameter> will accept only
                            certificates issued for the <parameter>Example Inc</parameter>
                            organization in <parameter>Some-State</parameter> state.</entry>
                    </row>
                    <row>
                        <entry>trusted_keys()</entry>
                        <entry>list of accepted SHA-1 fingerprints</entry>
                        <entry>none</entry>
                        <entry>To accept connections only from hosts using certain certificates
                            having specific SHA-1 fingerprints, list the fingerprints of the
                            accepted certificates in this parameter. E.g.,
                                <parameter>trusted_keys("SHA1:00:EF:ED:A4:CE:00:D1:14:A4:AB:43:00:EF:00:91:85:FF:89:28:8F",
                                "SHA1:0C:42:00:3E:B2:60:36:64:00:E2:83:F0:80:46:AD:00:A8:9D:00:15")</parameter>.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <note>
            <para>When using the <parameter>trusted_keys()</parameter> and
                <parameter>trusted_dn()</parameter> parameters, note the following:</para>
            <itemizedlist>
                <listitem>
                    <para>First, the <parameter>trusted_keys()</parameter> parameter is checked. If
                        the fingerprint of the peer is listed, the certificate validation is
                        performed.</para>
                </listitem>
                <listitem>
                    <para>If the fingerprint of the peer is not listed in the
                            <parameter>trusted_keys()</parameter> parameter, the
                            <parameter>trusted_dn()</parameter> parameter is checked. If the DN of
                        the peer is not listed in the <parameter>trusted_dn()</parameter> parameter,
                        the authentication of the peer fails and the connection is closed.</para>
                </listitem>
            </itemizedlist>
        </note>
    </section>
</chapter>
