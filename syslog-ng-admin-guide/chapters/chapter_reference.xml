<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter SYSTEM "../../xml-stylesheet/pdf/dtd/docbookx.dtd"
 [  
<!ENTITY % entities SYSTEM "../syslog-ng-entities.ent">
 %entities;]> 
<chapter id="chapter_reference">
    <title>Reference</title>
    <para>This chapter documents the drivers and options that can be used in the configuration file.
        For details on how to use syslog-ng, see <xref linkend="chapter_configuration"/>.</para>
    <section id="reference_sourcedrivers">
        <title>Source drivers</title>
        <indexterm>
            <primary>source drivers</primary>
            <secondary>reference</secondary>
        </indexterm>
        <section id="reference_source_internal">
            <title>internal()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>internal()</parameter> driver</secondary>
            </indexterm>
            <para>All messages generated internally by syslog-ng use this special source. To collect
                warnings, errors and notices from syslog-ng itself, include this source in one of
                your source statements. </para>
            <note>
                <para>Internal messages always use the local timezone of the host.</para>
            </note>
            <synopsis>internal()</synopsis>
            <para>This driver does not have any parameters.</para>
            <example id="example_source_internal">
                <title>Using the internal() driver</title>
                <synopsis>source s_local { internal(); };</synopsis>
            </example>
        </section>
        <section id="reference_source_file">
            <title>file()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>file()</parameter> driver</secondary>
            </indexterm>
            <para>Collects log messages from plain-text files. The file driver has a single required
                parameter specifying the file to open.</para>
            <synopsis>Declaration:
    file(filename);</synopsis>            
            <note>
                <para>If the message does not have a proper syslog header, syslog-ng treats messages
                    received from files as sent by the <parameter>kern</parameter> facility. Use the
                        <parameter>default-facility</parameter> and
                    <parameter>default-priority</parameter> options in the source definition to
                    assign a different facility if needed.</para>
            </note>
            <para>The <parameter>file()</parameter> driver has the following options:</para>
            <table>
                <?dbfo keep-together="auto" ?>
                <title>Options of the file() sources</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_default-facility)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_default-priority)"/>
                        <row>
                            <entry>file</entry>
                            <entry>filename with path</entry>
                            <entry/>
                            <entry>The file to read messages from.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_encoding)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_tags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_file">
                <title>Using the file() driver</title>
                <synopsis>source s_file { file("/var/log/messages"};</synopsis>
            </example>
            <example>
                <title>Tailing files</title>
                <para>The following source checks the <filename>access.log</filename> file every
                    second for new messages.</para>
                <synopsis>source s_tail { file("/var/log/apache/access.log" 
                    follow_freq(1) flags(no-parse)); };</synopsis>
            </example>
        </section>


        <section id="reference_source_pipe">
            <title>pipe()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>pipe()</parameter> driver</secondary>
            </indexterm>
            <para>The pipe driver opens a named pipe with the specified name and listens for
                messages. It is used as the native message delivery protocol on HP-UX.</para>
            <para>The pipe driver has a single required parameter, specifying the filename of the
                pipe to open.</para>
            <synopsis>Declaration:
    pipe(filename);</synopsis>
            <note>
                <para>As of syslog-ng Open Source Edition 3.0.2, pipes are created automatically. In
                    earlier versions, you had to create the pipe using the
                    <command>mkfifo(1)</command> command. </para>
            </note>
            <para>The <parameter>pipe</parameter> driver has the following options:</para>
            <table>
                <?dbfo keep-together="auto" ?>
                <title>Options of the pipe() sources</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <row>
                            <entry>pipe</entry>
                            <entry>filename with path</entry>
                            <entry/>
                            <entry>The filename of the pipe to read messages from. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_tags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_pipe">
                <title>Using the pipe() driver</title>
                <synopsis>source s_pipe { pipe("/dev/pipe" pad_size(2048)); };</synopsis>
            </example>
        </section>
        <section id="reference_source_program">
            <title>program()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>program()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>reading messages form external applications</primary>
            </indexterm>
            <para>The program driver starts an external application and reads messages from the
                standard output (stdout) of the application. It is mainly useful to receive log
                messages from daemons that accept incoming messages and convert them to log
                messages.</para>
            <para>The program driver has a single required parameter, specifying the name of the
                application to start.</para>
            <synopsis>Declaration:
    program(filename);</synopsis>
            <note>
                <para>The program is restarted automatically if it exits.</para>
            </note>
            <para>The <parameter>program</parameter> driver has the following options:</para>
            <table>
                <?dbfo keep-together="auto" ?>
                <title>Options of the program() source</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <row>
                            <entry>program</entry>
                            <entry>filename with path</entry>
                            <entry/>
                            <entry>The name of the application to start and read messages from.
                            </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_tags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_program">
                <title>Using the program() driver</title>
                <synopsis>source s_program { program("/etc/init.d/mydaemon"); };</synopsis>
            </example>
        </section>
        <section id="reference_source_sunstreams">
            <title>sun-streams() driver</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>sun-streams()</parameter> driver</secondary>
            </indexterm>
            <para>Solaris uses its <parameter>STREAMS</parameter> framework to send messages to the
                    <parameter>syslogd</parameter> process.</para>
            <para>Newer versions of Solaris (2.5.1 and above), use a new IPC in addition to
                    <parameter>STREAMS</parameter>, called door to confirm the delivery of a
                message. The syslog-ng application supports this new IPC mechanism via the
                    <parameter>door()</parameter> option (see below).</para>
            <note>
                <para>The <parameter>sun-streams()</parameter> driver must be enabled when the
                    syslog-ng application is compiled (see <command>./configure
                --help</command>).</para>
            </note>
            <para>The <parameter>sun-streams()</parameter> driver has a single required argument
                specifying the <parameter>STREAMS</parameter> device to open, and the
                    <parameter>door()</parameter> option.</para>
            <synopsis>Declaration:
    sun-streams(name_of_the_streams_device door(filename_of_the_door));</synopsis>
            <!-- FIXME a required argumentnek van neve, hogy a tablazatba belerakhassuk? -->
            <table>
                <title>Options for sun-streams</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>door()</entry>
                            <entry>string</entry>
                            <entry>none</entry>
                            <entry>Specifies the filename of a door to open, needed on Solaris above
                                2.5.1. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_tags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_sunstreams">
                <title>Using the sun-streams() driver</title>
                <synopsis>source s_stream { sun-streams("/dev/log" door("/etc/.syslog_door")); };</synopsis>
            </example>
        </section>
        <section id="reference_source_syslog">
            <title>syslog()</title>
            <!-- FIXME update ha lesz syslog6 -->
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>syslog()</parameter> driver</secondary>
            </indexterm>
            <para>This driver enables to receive messages from the network using the new standard
                syslog protocol and message format (see <xref linkend="concepts_message_ietfsyslog"
                /> for details about the protocol). UDP, TCP, and TLS-encrypted TCP can all be used
                to transport the messages.</para>
            <indexterm>
                <primary>TLS</primary>
            </indexterm>
            <synopsis>Declaration:
    syslog(ip() port() transport() options());</synopsis>
            <table>
                <title>Options for syslog() sources</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_host_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip_tos)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip_ttl)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_hostname)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_max_connections)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_port)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_tags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_tcp_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                        <row>
                            <entry>transport</entry>
                            <entry>udp, tcp, or tls</entry>
                            <entry>tcp</entry>
                            <entry>Specifies the protocol used to receive messages from the source.
                            </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_tls)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_use_dns)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_use_fqdn)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_syslog">
                <title>Using the syslog() driver</title>
                <para>TCP source listening on the localhost on port 1999.</para>
                <synopsis>source s_syslog { syslog(ip(127.0.0.1) port(1999) transport("tcp")); };</synopsis>
                <para>UDP source with defaults.</para>
                <synopsis>source s_udp { syslog( transport("udp")); };</synopsis>
                <para>Encrypted source where the client is also authenticated. See <xref
                        linkend="tlsoptions"/> for details on the encryption settings.</para>
                <synopsis>source s_syslog_tls{ syslog(
                    ip(10.100.20.40)
                    transport("tls")
                    tls(
                    peer-verify(required-trusted)
                    ca_dir('/opt/syslog-ng/etc/syslog-ng/keys/ca.d/')
                    key_file('/opt/syslog-ng/etc/syslog-ng/keys/server_privatekey.pem')
                    cert_file('/opt/syslog-ng/etc/syslog-ng/keys/server_certificate.pem')
                    )
                    );};</synopsis>
            </example>
        </section>
        <section id="reference_source_tcpudp">
            <title>tcp(), tcp6(), udp() and udp6()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>tcp()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>tcp6()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>udp()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>udp6()</parameter> driver</secondary>
            </indexterm>
            <para>The <parameter>tcp()</parameter>, <parameter>tcp6()</parameter>,
                <parameter>udp()</parameter>, <parameter>udp6()</parameter> drivers can receive
                messages from the network using the TCP and UDP networking protocols. The
                    <parameter>tcp6()</parameter> and <parameter>udp6()</parameter> drivers use the
                IPv6 network protocol, while <parameter>tcp()</parameter> and
                <parameter>udp()</parameter> use IPv4.</para>
            <para>The <parameter>tcp()</parameter> and <parameter>udp()</parameter> drivers do not
                have any required parameters. By default they bind to
                <parameter>0.0.0.0:514</parameter>, which means that syslog-ng will listen on all
                available interfaces, port 514. To limit accepted connections to only one interface,
                use the <parameter>localip()</parameter> parameter as described below. </para>
            <note>
                <para>The tcp port 514 is reserved for use with <command>rshell</command>, so select
                    a different port if syslog-ng and <command>rshell</command> is used at the same
                    time. </para>
            </note>
            <para>If you specify a multicast bind address to <parameter>udp()</parameter> and
                    <parameter>udp6()</parameter>, syslog-ng will automatically join the necessary
                multicast group. TCP does not support multicasting. </para>
            <para>The syslog-ng application supports TLS (Transport Layer Security,
                also known as SSL) for the tcp() and tcp6() drivers. See the TLS-specific options
                below and <xref linkend="tls_serverauth"/> for details.</para>
            <indexterm>
                <primary>TLS</primary>
            </indexterm>
            <synopsis>Declaration:
  tcp([options]);
  udp([options]);</synopsis>
            <para>The following options are valid for <parameter>tcp()</parameter>,
                    <parameter>tcp6()</parameter>, <parameter>udp()</parameter>, and
                    <parameter>udp6()</parameter> drivers: </para>
            <table>
                <title>Options for tcp, tcp6, udp, and udp6 drivers</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_encoding)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_host_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip_tos)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_ip_ttl)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_hostname)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_max_connections)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_port)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_tcp_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_tags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_tls)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_use_dns)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_use_fqdn)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_tcpudp">
                <title>Using the udp() and tcp() drivers</title>
                <para>A simple udp() source with default settings.</para>
                <synopsis>source s_udp { udp(); };# An UDP source with default settings.</synopsis>
                <para>A TCP source listening on the localhost interface, with a limited number of
                    connections allowed.</para>
                <synopsis>source s_tcp { tcp(ip(127.0.0.1) port(1999) max-connections(10)); };</synopsis>
                <para>A TCP source listening on a TLS-encrypted channel.</para>
                <synopsis>source s_tcp { tcp(ip(127.0.0.1) port(1999) 
                   tls(peer-verify('required-trusted') 
                       key_file('/opt/syslog-ng/etc/syslog-ng/syslog-ng.key') 
                   cert_file('/opt/syslog-ng/etc/syslog-ng/syslog-ng.crt'))); 
};</synopsis>
                <para>A TCP source listening for messages using the IETF-syslog message format. Note
                    that for transferring IETF-syslog messages, generally you are recommended to use
                    the <parameter>syslog()</parameter> driver on both the client and the server, as
                    it uses both the IETF-syslog message format and the protocol. See <xref
                        linkend="configuring_sources_syslog"/> for details.</para>
                <synopsis>source s_tcp_syslog { tcp(ip(127.0.0.1) port(1999) flags(syslog-protocol)); };</synopsis>
            </example>
        </section>
        <section id="reference_source_unixstream">
            <title>unix-stream() and unix-dgram()</title>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>unix-stream()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>source drivers</primary>
                <secondary><parameter>unix-dgram()</parameter> driver</secondary>
            </indexterm>
            <para>These two drivers behave similarly: they open an <parameter>AF_UNIX</parameter>
                socket and start listening on it for messages.</para>
            <para>Both unix-stream and unix-dgram have a single required argument, specifying the
                filename of the socket to create. </para>
            <synopsis>Declaration: 
    unix-stream(filename [options]);
    unix-dgram(filename [options]);</synopsis>
            <para>The following options can be specified for these divers:</para>
            <table>
                <title>Options for unix-stream() and unix-dgram()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_encoding)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_follow_freq)"/>
                        <row>
                            <entry>group()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the gid of the socket.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_host_override)"/>
                        <row>
                            <entry>keep-alive()</entry>
                            <entry>yes or no</entry>
                            <entry>yes</entry>
                            <entry>Selects whether to keep connections open when syslog-ng is
                                restarted; cannot be used with <parameter>unix-dgram()</parameter>.
                            </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_keep_timestamp)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_fetch_limit)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_iw_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_msg_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_log_prefix)"/>
                        <row>
                            <entry>max-connections()</entry>
                            <entry>number</entry>
                            <entry>256</entry>
                            <entry>Limits the number of simultaneously open connections. Cannot be
                                used with <parameter>unix-dgram()</parameter>.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_optional)"/>
                        <row>
                            <entry>owner()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the uid of the socket.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_pad_size)"/>
                        <row>
                            <entry>perm()</entry>
                            <entry>number</entry>
                            <entry>0666</entry>
                            <entry>Set the permission mask. For octal numbers prefix the number with
                                '0', e.g.: use 0755 for rwxr-xr-x.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_program_override)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_tags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_commonoption_time_zone)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_source_unixstream">
                <title>Using the unix-stream() and unix-dgram() drivers</title>
                <synopsis>source s_stream { unix-stream("/dev/log" max-connections(10)); };</synopsis>
                <synopsis>source s_dgram { unix-dgram("/var/run/log"); };</synopsis>
            </example>
        </section>
    </section>

    <section id="reference_destinationdrivers">
        <title>Destination drivers</title>
        <indexterm>
            <primary>destination drivers</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>Destination drivers output log messages to somewhere outside syslog-ng e.g., to a file
            or a network socket. </para>

        <section id="reference_destination_file">
            <title>file()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>file()</parameter> driver</secondary>
            </indexterm>
            <para>The file driver outputs messages to the specified text file, or to a set of files. </para>
            <para>The destination filename may include macros which get expanded when the message is
                written, thus a simple <parameter>file()</parameter> driver may create several
                files. For more information on available macros see <xref linkend="reference_macros"
                />. </para>
            <xi:include href="reference_common.xml" xmlns:xi="http://www.w3.org/2001/XInclude"
                xpointer="element(warning-fd-ulimit)"/>
            <para>The <parameter>file()</parameter> destination has the following options:</para>
            <!-- FIXME required parameters?? -->
            <table>
                <title>Options for file()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>create_dirs()</entry>
                            <entry>yes or no</entry>
                            <entry> no </entry>
                            <entry>Enable creating non-existing directories. </entry>
                        </row>
                        <row>
                            <entry>dir_group()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>The group of directories created by syslog-ng. </entry>
                        </row>
                        <row>
                            <entry>dir_owner()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>The owner of directories created by syslog-ng. </entry>
                        </row>
                        <row>
                            <entry>dir_perm()</entry>
                            <entry>number</entry>
                            <entry> 0600 </entry>
                            <entry>The permission mask of directories created by syslog-ng. Log
                                directories are only created if a file after macro expansion refers
                                to a non-existing directory, and directory creation is enabled (see
                                the <parameter>create_dirs()</parameter> option below). For octal
                                numbers prefix the number with <parameter>0</parameter>, e.g., use
                                    <parameter>0755</parameter> for
                                <parameter>rwxr-xr-x</parameter>. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <row>
                            <entry>group()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the group of the created file to the one specified. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_local_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <row>
                            <entry>
                                <parameter>overwrite_if_older()</parameter>
                            </entry>
                            <entry>number</entry>
                            <entry>0</entry>
                            <entry>If set to a value higher than 0, syslog-ng checks when the file
                                was last modified before starting to write into the file. If the
                                file is older than the specified amount of time (in seconds), then
                                syslog-ng removes the existing file and opens a new file with the
                                same name. In combination with e.g., the
                                <parameter>$WEEKDAY</parameter> macro, this can be used for simple
                                log rotation, in case not all history has to be kept. (Note that in
                                this weekly log rotation example if its Monday 00:01, then the file
                                from last Monday is not seven days old, because it was probably last
                                modified shortly before 23:59 last Monday, so it is actually not
                                even six days old. So in this case, set the
                                    <parameter>overwrite_if_older()</parameter> parameter to
                                a-bit-less-than-six-days, for example, to
                                <parameter>518000</parameter> seconds. </entry>
                        </row>
                        <row>
                            <entry>owner()</entry>
                            <entry>string</entry>
                            <entry>root</entry>
                            <entry>Set the owner of the created file to the one specified. </entry>
                        </row>
                        <row>
                            <entry>perm()</entry>
                            <entry>number</entry>
                            <entry> 0600 </entry>
                            <entry>The permission mask of the file if it is created by syslog-ng.
                                For octal numbers prefix the number with <parameter>0</parameter>,
                                e.g., use <parameter>0755</parameter> for
                                <parameter>rwxr-xr-x</parameter>. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                        <!--<row>
                            <entry>remove_if_older()</entry>
                            <entry>number</entry>
                            <entry>0</entry>
                            <entry>Obsolete alias of the <parameter>overwrite_if_older()</parameter>
                                option. </entry>
                        </row>-->
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_file">
                <title>Using the file() driver</title>
                <synopsis>destination d_file { file("/var/log/messages" ); };</synopsis>
            </example>
            <example id="example_destination_file_macro">
                <title>Using the file() driver with macros in the file name and a template for the
                    message</title>
                <synopsis>destination d_file {
        file("/var/log/$YEAR.$MONTH.$DAY/messages"
             template("$HOUR:$MIN:$SEC $TZ $HOST [$LEVEL] $MSG $MSG\n")
             template_escape(no));
};</synopsis>
            </example>
        </section>
        <section id="reference_destination_pipe">
            <title>pipe()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>pipe()</parameter> driver</secondary>
            </indexterm>
            <para>This driver sends messages to a named pipe like
                <filename>/dev/xconsole</filename>. </para>
            <para>The pipe driver has a single required parameter, specifying the filename of the
                pipe to open. The filename can include macros.</para>
            <synopsis>Declaration:
    pipe(filename);</synopsis>
            <warning>
                <para>As of syslog-ng Open Source Edition 3.0.2, pipes are created automatically. In
                    earlier versions, you had to create the pipe using the
                    <command>mkfifo(1)</command> command. </para>
            </warning>
            <para>The <parameter>pipe()</parameter> destination has the following options:</para>
            <table>
                <title>Options for pipe()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <row>
                            <entry>group()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>Set the group of the pipe to the one specified. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <row>
                            <entry>owner()</entry>
                            <entry>string</entry>
                            <entry> root </entry>
                            <entry>Set the owner of the pipe to the one specified. </entry>
                        </row>
                        <row>
                            <entry>perm()</entry>
                            <entry>number</entry>
                            <entry> 0600 </entry>
                            <entry>The permission mask of the pipe. For octal numbers prefix the
                                number with '0', e.g.: use 0755 for rwxr-xr-x. </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_pipe">
                <title>Using the pipe() driver</title>
                <synopsis>destination d_pipe { pipe("/dev/xconsole"); };</synopsis>
            </example>
        </section>
        <section id="reference_destination_program">
            <title>program()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>program()</parameter> driver</secondary>
            </indexterm>
            <para>This driver starts an external application or script and sends the log messages to
                its standard input (<parameter>stdin</parameter>). </para>
            <para>The <parameter>program()</parameter> driver has a single required parameter,
                specifying a program name to start.</para>
            <synopsis>Declaration: 
    program(command_to_run);</synopsis>
            <para>The <parameter>program()</parameter> destination has the following options:</para>
            <table>
                <title>Options for program()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_program">
                <title>Using the program() destination driver</title>
                <synopsis>destination d_prog { program("/bin/script" template("&lt;$PRI&gt;$DATE $HOST $MSG\n"); };</synopsis>
            </example>
        </section>
        <section id="reference_destination_sql">
            <title>sql()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>sql()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary>database driver</secondary>
            </indexterm>
            <para>This driver sends messages into an SQL database. The <parameter>sql()</parameter>
                driver has the following required parameters: <parameter>type</parameter>,
                    <parameter>database</parameter>, <parameter>table</parameter>,
                    <parameter>columns</parameter>, <parameter>values</parameter>.</para>
            <!-- FIXME melyek a kotelezo parameterek? -->
            <synopsis>Declaration: 
    sql(database_type host_parameters database_parameters [options]);</synopsis>
            <para>The <parameter>sql()</parameter> destination has the following options:</para>
            <table>
                <title>Options for sql()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row id="sql_option_columns">
                            <entry>columns</entry>
                            <entry>string list</entry>
                            <entry>"date", "facility", "level", "host", "program", "pid", "message"</entry>
                            <entry>Name of the columns storing the data in <parameter>fieldname
                                    [dbtype]</parameter> format. The <parameter>[dbtype]</parameter>
                                parameter is optional, and specifies the type of the field. By
                                default, syslog-ng creates <parameter>text</parameter> columns. Note
                                that not every database engine can index text fields. </entry>
                        </row>
                        <row id="sql_option_database">
                            <entry>database</entry>
                            <entry>string</entry>
                            <entry>n/a</entry>
                            <entry>Name of the database that stores the logs.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <row>
                            <entry>host</entry>
                            <entry>hostname or IP address</entry>
                            <entry>n/a</entry>
                            <entry>Hostname of the database server. Note that Oracle destinations do
                                not use this parameter, but retrieve the hostname from the
                                    <filename>/etc/tnsnames.ora</filename> file.</entry>
                        </row>
                        <row id="sql_option_indexes">
                            <entry>indexes</entry>
                            <entry>string list</entry>
                            <entry>"date", "facility", "host", "program"</entry>
                            <entry>The list of columns that are indexed by the database to speed up
                                searching. To disable indexing for the destination, include the
                                empty <parameter>indexes()</parameter> parameter in the destination,
                                simply omitting the <parameter>indexes</parameter> parameter will
                                cause syslog-ng to request indexing on the default columns.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_local_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <row id="sql_option_null">
                            <entry>null</entry>
                            <entry>string</entry>
                            <entry/>
                            <entry>If the content of a column matches the string specified in the
                                    <parameter>null()</parameter> parameter, the contents of the
                                column will be replaced with an SQL NULL value. If unset (by
                                default), the option does not match on any string. See the <xref
                                    linkend="example_destination_sql_null"/> for details.</entry>
                        </row>
                        <row>
                            <entry>password</entry>
                            <entry>string</entry>
                            <entry>n/a</entry>
                            <entry>Password of the database user.</entry>
                        </row>
                        <row id="sql_option_table">
                            <entry>table</entry>
                            <entry>string</entry>
                            <entry>n/a</entry>
                            <entry>Name of the database table to use (can include macros). When
                                using macros, note that some databases limit the length of table
                                names.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <row id="sql_option_type">
                            <entry>type</entry>
                            <entry>mssql, mysql, oracle, pgsql, or sqlite3</entry>
                            <entry>n/a</entry>
                            <entry>Specifies the type of the database, i.e., the DBI database driver
                                to use. Use the <parameter>mssql</parameter> option to send logs to
                                an MSSQL database. See the examples of the databases on the
                                following sections for details.</entry>
                        </row>
                        <row>
                            <entry>username</entry>
                            <entry>string</entry>
                            <entry>n/a</entry>
                            <entry>Name of the database user.</entry>
                        </row>
                        <row id="sql_option_values">
                            <entry>values</entry>
                            <entry>string list</entry>
                            <entry>"${R_YEAR}-${R_MONTH}-${R_DAY} ${R_HOUR}:${R_MIN}:${R_SEC}",
                                "$FACILITY", "$LEVEL", "$HOST", "$PROGRAM", "$PID", "$MSGONLY"</entry>
                            <entry>The parts of the message to store in the fields specified in the
                                    <parameter>columns</parameter> parameter.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <note>
                <para>If you specify <parameter>host="localhost"</parameter>, syslog-ng will use a
                    socket to connect to the local database server. Use
                    <parameter>host="127.0.0.1"</parameter> to force TCP communication between
                    syslog-ng and the local database server.</para>
                <para>To specify the socket to use, set and export the
                    <parameter>MYSQL_UNIX_PORT</parameter> environment variable, e.g.,
                        <command>MYSQL_UNIX_PORT=/var/lib/mysql/mysql.sock; export
                    MYSQL_UNIX_PORT</command>.</para>
            </note>
            <example id="example_destination_sql">
                <title>Using the sql() driver</title>
                <indexterm>
                    <primary>destinations</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <indexterm>
                    <primary>PostgreSQL</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <para>The following example sends the log messages into a PostgreSQL database
                    running on the <parameter>logserver</parameter> host. The messages are inserted
                    into the <parameter>logs</parameter> database, the name of the table includes
                    the exact date and the name of the host sending the messages. The syslog-ng
                    application automatically creates the required tables and columns, if the user
                    account used to connect to the database has the required privileges.</para>
                <synopsis>destination d_sql { 
  sql(type(pgsql)
  host("logserver") username("syslog-ng") password("password")
  database("logs")
  table("messages_${HOST}_${R_YEAR}${R_MONTH}${R_DAY}")
  columns("datetime", "host", "program", "pid", "message")
  values("$R_DATE", "$HOST", "$PROGRAM", "$PID", "$MSGONLY")
  indexes("datetime", "host", "program", "pid", "message"));
  };</synopsis>
                <para>The following example specifies the type of the database columns as well:</para>
                <synopsis>destination d_sql { 
  sql(type(pgsql)
  host("logserver") username("syslog-ng") password("password")
  database("logs")
  table("messages_${HOST}_${R_YEAR}${R_MONTH}${R_DAY}")
  columns("datetime varchar(16)", "host varchar(32)", "program  varchar(20)", "pid varchar(8)", "message  varchar(200)")
  values("$R_DATE", "$HOST", "$PROGRAM", "$PID", "$MSGONLY")
  indexes("datetime", "host", "program", "pid", "message"));
};</synopsis>
            </example>
            <example id="example_destination_sql_oracle">
                <title>Using the sql() driver with an Oracle database</title>
                <indexterm>
                    <primary>destinations</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <indexterm>
                    <primary>Oracle</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <para>The following example sends the log messages into an Oracle database running
                    on the <parameter>logserver</parameter> host, which must be set in the
                        <filename>/etc/tnsnames.ora</filename> file. The messages are inserted into
                    the <parameter>LOGS</parameter> database, the name of the table includes the
                    exact date when the messages were sent. The syslog-ng application automatically
                    creates the required tables and columns, if the user account used to connect to
                    the database has the required privileges.</para>
                <synopsis>destination d_sql { 
  sql(type(oracle)
  username("syslog-ng") password("password")
  database("LOGS")
  table("msgs_${R_YEAR}${R_MONTH}${R_DAY}")
  columns("datetime varchar(16)", "host varchar(32)", "program varchar(32)", "pid varchar(8)", "message varchar2")                        
  values("$R_DATE", "$HOST", "$PROGRAM", "$PID", "$MSGONLY")
  indexes("datetime", "host", "program", "pid", "message"));
  };</synopsis>
                <para>The Oracle Instant Client retrieves the address of the database server from
                    the <filename>/etc/tnsnames.ora</filename> file. Edit or create this file as
                    needed for your configuration. A sample is provided below.</para>
                <synopsis>LOGS =
(DESCRIPTION =
(ADDRESS_LIST =
(ADDRESS = (PROTOCOL = TCP)
(HOST = logserver)
(PORT = 1521))
)
(CONNECT_DATA =
(SERVICE_NAME = EXAMPLE.SERVICE)
)
)</synopsis>
            </example>
            <example id="example_destination_sql_mssql">
                <title>Using the sql() driver with an MSSQL database</title>
                <indexterm>
                    <primary>destinations</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <indexterm>
                    <primary>MSSQL</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <para>The following example sends the log messages into an MSSQL database running on
                    the <parameter>logserver</parameter> host. The messages are inserted into the
                        <parameter>syslogng</parameter> database, the name of the table includes the
                    exact date when the messages were sent. The syslog-ng application automatically
                    creates the required tables and columns, if the user account used to connect to
                    the database has the required privileges.</para>
                <synopsis>destination d_mssql { 
sql(type(mssql) host("logserver") port("1433") 
  username("syslogng") password("syslogng") database("syslogng") 
  table("msgs_${R_YEAR}${R_MONTH}${R_DAY}")columns("datetime varchar(16)", "host varchar(32)",
  "program varchar(32)", "pid varchar(8)", "message varchar(4096)")
  values("$R_DATE", "$HOST", "$PROGRAM", "$PID", "$MSGONLY")
  indexes("datetime", "host", "program", "pid", "message"));
  };</synopsis>
                <para>The date format used by the MSSQL database must be explicitly set in the
                        <filename>/etc/locales.conf</filename> file of the syslog-ng server. Edit or
                    create this file as needed for your configuration. A sample is provided below.</para>
                <synopsis>[default]
date = "%Y-%m-%d %H:%M:%S"</synopsis>
            </example>
            <example id="example_destination_sql_null">
                <title>Using SQL NULL values</title>
                <indexterm>
                    <primary>destinations</primary>
                    <secondary>sql() configuration</secondary>
                </indexterm>
                <indexterm>
                    <primary>SQL NULL values</primary>
                </indexterm>
                <para>The <parameter>null()</parameter> parameter of the SQL driver can be used to
                    replace the contents of a column with a special SQL NULL value. To replace every
                    column that contains an empty string with NULL, use the
                    <parameter>null("")</parameter> option, e.g.,</para>
                <synopsis>destination d_sql { 
                    sql(type(pgsql)
                    host("logserver") username("syslog-ng") password("password")
                    database("logs")
                    table("messages_${HOST}_${R_YEAR}${R_MONTH}${R_DAY}")
                    columns("datetime", "host", "program", "pid", "message")
                    values("$R_DATE", "$HOST", "$PROGRAM", "$PID", "$MSGONLY")
                    indexes("datetime", "host", "program", "pid", "message")
                    null(""));                    
                    };</synopsis>
                <para>To replace only a specific column (e.g., <parameter>pid</parameter>) if it is
                    empty, assign a default value to the column, and use this default value in the
                        <parameter>null()</parameter> parameter:</para>
                <synopsis>destination d_sql { 
                    sql(type(pgsql)
                    host("logserver") username("syslog-ng") password("password")
                    database("logs")
                    table("messages_${HOST}_${R_YEAR}${R_MONTH}${R_DAY}")
                    columns("datetime", "host", "program", "pid", "message")
                    values("$R_DATE", "$HOST", "$PROGRAM", "${PID:-@@NULL@@}", "$MSGONLY")
                    indexes("datetime", "host", "program", "pid", "message")
                    null("@@NULL@@"));                    
                    };</synopsis>
                <para>Ensure that the default value you use does not appear in the actual log
                    messages, because other occurrences of this string will be replaced with NULL as
                    well.</para>
            </example>
        </section>

        <section id="reference_destination_syslog">
            <title>syslog()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>syslog()</parameter> driver</secondary>
            </indexterm>
            <para>The <parameter>syslog()</parameter> driver sends messages to a remote host (e.g.,
                a syslog-ng server or relay) on the local intranet or internet using the new
                standard syslog protocol developed by IETF (see <xref
                    linkend="concepts_message_ietfsyslog"/> for details about the protocol). The
                protocol supports sending messages using the UDP, TCP, or the encrypted TLS
                networking protocols.</para>
            <para>The required arguments of the driver are the address of the destination host
                (where messages should be sent) and the transport method (networking protocol). </para>
            <para>The <parameter>udp</parameter> transport method
                <!-- FIXME ez erre a driverre is igaz? --> automatically sends multicast packets if
                a multicast destination address is specified. The <parameter>tcp</parameter> and
                    <parameter>tls</parameter> methods do not support multicasting.</para>
            <synopsis>Declaration:
    syslog(host transport [options]);</synopsis>
            <para>These destinations have the following options:</para>
            <table id="table_destination_syslog_options">
                <title>Options for syslog() destinations</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_ip_tos)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_ip_ttl)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_localip)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_localport)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <row id="destination_option_port">
                            <entry>port() or destport()</entry>
                            <entry>number</entry>
                            <entry>601</entry>
                            <entry>The port number to connect to. Note that the default port numbers
                                used by syslog-ng do not comply with the latest RFC which was
                                published after the release of syslog-ng 3.0.2, therefore the
                                default port numbers will change in the future releases.</entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_spoof_source)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_tls)"/>
                        <row>
                            <entry>transport</entry>
                            <entry>udp, tcp, or tls</entry>
                            <entry>tcp</entry>
                            <entry>Specifies the protocol used to receive messages from the source.
                            </entry>
                        </row>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_syslog">
                <title>Using the syslog() driver</title>
                <synopsis>destination d_tcp { syslog(ip"10.1.2.3" transport("tcp") port(1999); localport(999)); };</synopsis>
                <para>If name resolution is configured, the hostname of the target server can be
                    used as well.</para>
                <synopsis>destination d_tcp { syslog(ip"target_host" transport("tcp") port(1999); localport(999)); };</synopsis>
                <para>Send the log messages using TLS encryption and use mutual authentication. See
                        <xref linkend="tlsoptions"/> for details on the encryption and
                    authentication options.</para>
                <synopsis>destination d_syslog_tls{ 
                syslog("10.100.20.40"
                transport("tls")
                port(6514)
                tls(peer-verify(required-trusted)
                ca_dir('/opt/syslog-ng/etc/syslog-ng/keys/ca.d/')
                key_file('/opt/syslog-ng/etc/syslog-ng/keys/client_key.pem')
                cert_file('/opt/syslog-ng/etc/syslog-ng/keys/client_certificate.pem'))
                );};</synopsis>
            </example>
        </section>

        <section id="reference_destination_tcpudp">
            <title>tcp(), tcp6(), udp(), and udp6(),</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>tcp()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>tcp6()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>udp()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>udp6()</parameter> driver</secondary>
            </indexterm>
            <para>This driver sends messages to another host on the local intranet or internet using
                the UDP or TCP protocol. The <parameter>tcp6()</parameter> and
                <parameter>udp6()</parameter> drivers use the IPv6 network protocol.</para>
            <para>Both drivers have a single required argument specifying the destination host
                address, where messages should be sent, and several optional parameters. Note that
                this differs from source drivers, where local bind address is implied, and none of
                the parameters are required. </para>
            <para>The <parameter>udp()</parameter> and <parameter>udp6()</parameter> drivers
                automatically send multicast packets if a multicast destination address is
                specified. The <parameter>tcp()</parameter> and <parameter>tcp6()</parameter>
                drivers do not support multicasting.</para>
            <synopsis>Declaration:
    tcp(host [options]);
    udp(host [options]);
    tcp6(host [options]);
    udp6(host [options]);</synopsis>
            <para>These destinations have the following options:</para>
            <table id="table_destination_tcp_options">
                <title>Options for tcp, tcp6, udp, and udp6 destinations</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_ip_tos)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_ip_ttl)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_localip)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_localport)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_port)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_spoof_source)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_tls)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_tcpudp">
                <title>Using the tcp() driver</title>
                <synopsis>destination d_tcp { tcp("10.1.2.3" port(1999); localport(999)); };</synopsis>
                <para>If name resolution is configured, the hostname of the target server can be
                    used as well.</para>
                <synopsis>destination d_tcp { tcp("target_host" port(1999); localport(999)); };</synopsis>
                <para>To send messages using the IETF-syslog message format, enable the
                        <parameter>syslog-protocol</parameter> flag:</para>
                <synopsis>destination d_tcp { tcp("10.1.2.3" port(1999); flags(syslog-protocol) };</synopsis>
            </example>
        </section>

        <section id="reference_destination_unixstream">
            <title>unix-stream() &amp; unix-dgram()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>unix-stream()</parameter> driver</secondary>
            </indexterm>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>unix-dgram()</parameter> driver</secondary>
            </indexterm>
            <para>These drivers send messages to a unix socket in either
                <parameter>SOCK_STREAM</parameter> or <parameter>SOCK_DGRAM</parameter> mode. </para>
            <para>Both drivers have a single required argument specifying the name of the socket to
                connect to. </para>
            <synopsis>Declaration: 
    unix-stream(filename [options]);
    unix-dgram(filename [options]);</synopsis>
            <para>The <parameter>unix-stream()</parameter> and <parameter>unix-dgram()</parameter>
                destinations have the following options:</para>
            <table>
                <title>Options for unix-stream() and unix-dgram()</title>
                <tgroup cols="4">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Type</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flags)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_lines)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_flush_timeout)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_frac_digits)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_fsync)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_log_fifo_size)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_keep_alive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_broadcast)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(source_option_so_keepalive)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_rcvbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_option_so_sndbuf)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_suppress)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_template_escape)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_throttle)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_timezone)"/>
                        <xi:include href="reference_common.xml"
                            xmlns:xi="http://www.w3.org/2001/XInclude"
                            xpointer="element(destination_commonoption_ts_format)"/>
                    </tbody>
                </tgroup>
            </table>
            <example id="example_destination_unixstream">
                <title>Using the unix-stream() driver</title>
                <synopsis>destination d_unix_stream { unix-stream("/var/run/logs"); };</synopsis>
            </example>
        </section>

        <section id="reference_destination_usertty">
            <title>usertty()</title>
            <indexterm>
                <primary>destination drivers</primary>
                <secondary><parameter>usertty()</parameter> driver</secondary>
            </indexterm>
            <para>This driver writes messages to the terminal of a logged-in user. </para>
            <para>The <parameter>usertty()</parameter> driver has a single required argument,
                specifying a username who should receive a copy of matching messages. </para>
            <synopsis>Declaration: 
    usertty(username);</synopsis>
            <para>The <parameter>usertty()</parameter> does not have any further options nor does it
                support templates.</para>
            <example>
                <title>Using the usertty() driver</title>
                <synopsis>destination d_usertty { usertty("root"); };</synopsis>
            </example>
        </section>

    </section>
    <section id="reference_logflags">
        <title>Log path flags</title>
        <para>Flags influence the behavior of syslog-ng, and the way it processes messages. The
            following flags may be used in the log paths, as described in <xref linkend="logpath"/>.</para>
        <table id="logflags">
            <title>Log statement flags</title>
            <indexterm>
                <primary>log paths</primary>
                <secondary>flags</secondary>
            </indexterm>
            <indexterm>
                <primary>flags</primary>
            </indexterm>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Flag</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>catchall</entry>
                        <entry>This flag means that the source of the message is ignored, only the
                            filters are taken into account when matching messages. A log statement
                            using the <parameter>catchall</parameter> flag processes every message
                            that arrives to any of the defined sources.</entry>
                    </row>
                    <row>
                        <entry>fallback</entry>
                        <entry>This flag makes a log statement 'fallback'. Fallback log statements
                            process messages that were not processed by other, 'non-fallback' log
                            statements. </entry>
                    </row>
                    <row>
                        <entry>final</entry>
                        <entry>This flag means that the processing of log messages processed by the
                            log statement ends here, other log statements appearing later in the
                            configuration file will not process the messages processed by the log
                            statement labeled as 'final'. Note that this does not necessarily mean
                            that matching messages will be stored only once, as there can be
                            matching log statements processed prior the current one. </entry>
                    </row>
                    <row>
                        <entry>flow-control</entry>
                        <entry>Enables flow-control to the log path, meaning that syslog-ng will
                            stop reading messages from the sources of this log statement if the
                            destinations are not able to process the messages at the required speed.
                            If disabled, syslog-ng will drop messages if the destination queues are
                            full. If enabled, syslog-ng will only drop messages if the destination
                            queues/window sizes are improperly sized. </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <warning id="warning_embedded_log_flags">
            <para>The <parameter>final</parameter>, <parameter>fallback</parameter>, and
                    <parameter>catchall</parameter> flags apply only for the top-level log paths,
                they have no effect on embedded log paths.</para>
        </warning>
        <example id="example_logpath_flags">
            <title>Using log path flags</title>
            <!--<para>The following log path processes every message received to the
                    <parameter>s_localhost</parameter> source that was not processed by earlier log
                paths. As syslog-ng processes log paths in the order they appear in the
                configuration file, place such log paths at the end of the file. A typical situation
                is to use filters to select the most important messages and send them to specific
                destinations, and process the remaining messages with a fallback log path.</para>
            <synopsis>.
.
.
log { source(s_localhost); destination(d_tcp); flags(fallback); };</synopsis>-->
            <para>Let's suppose that you have two hosts (<parameter>myhost_A</parameter> and
                    <parameter>myhost_B</parameter>) that run two applications each
                    (<parameter>application_A</parameter> and <parameter>application_B</parameter>),
                and you collect the log messages to a central syslog-ng server. On the server, you
                create two log paths:</para>
            <itemizedlist>
                <listitem>
                    <para>one that processes only the messages sent by
                        <parameter>myhost_A</parameter>; and</para>
                </listitem>
                <listitem>
                    <para>one that processes only the messages sent by
                        <parameter>application_A</parameter>.</para>
                </listitem>
            </itemizedlist>
            <para>This means that messages sent by <parameter>application_A</parameter> running on
                    <parameter>myhost_A</parameter> will be processed by both log paths, and the
                messages of <parameter>application_B</parameter> running on
                <parameter>myhost_B</parameter> will not be processed at all.</para>
            <itemizedlist>
                <listitem>
                    <para>If you add the <parameter>final</parameter> flag to the first log path,
                        then only this log path will process the messages of
                        <parameter>myhost_A</parameter>, so the second log path will receive only
                        the messages of <parameter>application_A</parameter> running on
                            <parameter>myhost_B</parameter>. </para>
                </listitem>
                <listitem>
                    <para>If you create a third log path that includes the
                        <parameter>fallback</parameter> flag, it will process the messages not
                        processed by the first two log paths, in this case, the messages of
                            <parameter>application_B</parameter> running on
                        <parameter>myhost_B</parameter>.</para>
                </listitem>
                <listitem>
                    <para>Adding a fourth log path with the <parameter>catchall</parameter> flag
                        would process every message received by the syslog-ng server.</para>
                    <synopsis>log { source(s_localhost); destination(d_file); flags(catchall); };</synopsis>
                </listitem>
            </itemizedlist>
        </example>
    </section>
    <section id="reference_filters">
        <title>Filter functions</title>
        <indexterm>
            <primary>filters</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>The following functions may be used in the filter statement, as described in <xref
                linkend="filters"/>.</para>
        <table id="filterfunc">
            <title>Filter functions in syslog-ng</title>
            <tgroup cols="3">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Synopsis</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>facility()</entry>
                        <entry>facility(facility[,facility])</entry>
                        <entry>Match messages having one of the listed facility code. An alternate
                            syntax permits the use an arbitrary facility codes.</entry>
                    </row>
                    <row>
                        <entry>facility()</entry>
                        <entry>facility(&lt;numeric facility code&gt;)</entry>
                        <entry>An alternate syntax for <parameter>facility</parameter> permitting
                            the use of an arbitrary facility code. Facility codes 0-23 are
                            predefined and can be referenced by their usual name. Facility codes
                            above 24 are not defined but can be used by this alternate syntax.
                        </entry>
                    </row>
                    <row>
                        <entry>filter()</entry>
                        <entry>filter(filtername)</entry>
                        <entry>Call another filter rule and evaluate its value.</entry>
                    </row>
                    <row>
                        <entry>host()</entry>
                        <entry>host(regexp)</entry>
                        <entry>Match messages by using a regular expression against the hostname
                            field of log messages. </entry>
                    </row>
                    <row>
                        <entry>level() or priority()</entry>
                        <entry>level(pri[,pri1..pri2[,pri3]])</entry>
                        <entry>Match messages based on priority.</entry>
                    </row>
                    <row>
                        <entry>match()</entry>
                        <entry>match(regexp)</entry>
                        <entry>Match a regular expression to the headers and the message itself
                            (i.e., the values returned by the <parameter>MSGHDR</parameter> and
                                <parameter>MSG</parameter> macros). Note that in syslog-ng version
                            2.1 and earlier, the <parameter>match()</parameter> filter was applied
                            only to the text of the message, excluding the headers. This
                            functionality has been moved to the <parameter>message()</parameter>
                            filter. To limit the scope of the match to a specific part of the
                            message (identified with a macro), use the <parameter>match(regexp
                                value("MACRO"))</parameter> syntax. Do nor include the $ sign in the
                            parameter of the <parameter>value()</parameter> option.</entry>
                    </row>
                    <row>
                        <entry>message()</entry>
                        <entry>message(regexp)</entry>
                        <entry>Match a regular expression to the text of the log message, excluding
                            the headers (i.e., the value returned by the <parameter>MSG</parameter>
                            macros). Note that in syslog-ng version 2.1 and earlier, this
                            functionality was performed by the <parameter>match()</parameter>
                            filter.</entry>
                    </row>
                    <row>
                        <entry>netmask()</entry>
                        <entry>netmask(ip/mask)</entry>
                        <entry>Select only messages sent by a host whose IP address belongs to the
                            specified IP subnet. Note that this filter checks the IP address of the
                            last-hop relay (the host that actually sent the message to syslog-ng),
                            not the contents of the <parameter>HOST</parameter> field of the
                            message.</entry>
                    </row>
                    <row>
                        <entry>program()</entry>
                        <entry>program(regexp)</entry>
                        <entry>Match messages by using a regular expression against the program name
                            field of log messages.</entry>
                    </row>
                    <row>
                        <entry>source()</entry>
                        <entry>string</entry>
                        <entry>Select messages of a source statement. This filter can be used in
                            embedded log statements if the parent statement contains multiple source
                            groups &mdash; only messages originating from the selected source
                            group are sent to the destination of the embedded log statement.</entry>
                    </row>
                    <row>
                        <entry>tags()</entry>
                        <entry>tag</entry>
                        <entry>Select messages labeled with the specified tag. Every message
                            automatically has the tag of its source in
                                <parameter>.source.&lt;id_of_the_source_statement&gt;</parameter>
                            format. This option is available only in syslog-ng 3.1 and later.
                        </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <indexterm>
            <primary>regular expressions</primary>
            <secondary>posix</secondary>
        </indexterm>
        <para>The <parameter>host()</parameter>, <parameter>match()</parameter>, and
                <parameter>program()</parameter> filter functions accept regular expressions as
            parameters. The exact type of the regular expression to use can be specified with the
                <parameter>type()</parameter> option. The following expression types are available:</para>
        <table id="reference_filter_types">
            <title>Filter match types</title>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>posix</entry>
                        <entry>Use POSIX regular expressions. If the <parameter>type()</parameter>
                            parameter is not specified, syslog-ng uses POSIX regular expressions by
                            default. For additional details on the use and flags of regular
                            expressions, see <xref linkend="reference_regular_expressions"
                        />.</entry>
                    </row>
                    <row>
                        <entry>pcre</entry>
                        <entry>Use PCRE regular expressions. This is available only if syslog-ng was
                            compiled with the <parameter>--enable-pcre</parameter> option. Execute
                            the <command>syslog-ng -V</command> command to list the options
                            supported by your binary. For additional details on the use and flags of
                            regular expressions, see <xref linkend="reference_regular_expressions"
                            />.</entry>
                    </row>
                    <row>
                        <entry>string</entry>
                        <entry>Match the strings literally, without regular expression support. By
                            default, only identical strings are matched. For partial matches, use
                            the <parameter>flags("prefix")</parameter> or the
                                <parameter>flags("substring")</parameter> flags.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <indexterm>
            <primary>filters</primary>
            <secondary>priorities</secondary>
        </indexterm>
        <para>The <parameter>level()</parameter> filter accepts the following levels:
                <parameter>emerg</parameter>, <parameter>alert</parameter>,
            <parameter>crit</parameter>, <parameter>err</parameter>, <parameter>warning</parameter>,
                <parameter>notice</parameter>, <parameter>info</parameter>,
            <parameter>debug</parameter>. </para>
        <indexterm>
            <primary>filters</primary>
            <secondary>facilities, </secondary>
        </indexterm>
        <para>The <parameter>facility()</parameter> filter accepts both the name and the numerical
            code of the facility or the importance level. The syslog-ng application recognizes the
            following facilities: (Note that some of these facilities are available only on specific
            platforms.)</para>
        <!-- FIXME authpriv -->
        <table>
            <title>syslog Message Facilities recognized by the facility() filter</title>
            <?dbfo keep-together="auto" ?>
            <indexterm>
                <primary>facilities</primary>
            </indexterm>
            <indexterm>
                <primary>message facilities</primary>
            </indexterm>
            <tgroup cols="3">
                <thead>
                    <row>
                        <entry>Numerical Code</entry>
                        <entry>Facility name</entry>
                        <entry>Facility</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>0</entry>
                        <entry>kern</entry>
                        <entry>kernel messages</entry>
                    </row>
                    <row>
                        <entry>1</entry>
                        <entry>user</entry>
                        <entry>user-level messages</entry>
                    </row>
                    <row>
                        <entry>2</entry>
                        <entry>mail</entry>
                        <entry>mail system</entry>
                    </row>
                    <row>
                        <entry>3</entry>
                        <entry>daemon</entry>
                        <entry>system daemons</entry>
                    </row>
                    <row>
                        <entry>4</entry>
                        <entry>auth</entry>
                        <entry>security/authorization messages</entry>
                    </row>
                    <row>
                        <entry>5</entry>
                        <entry>syslog</entry>
                        <entry>messages generated internally by syslogd</entry>
                    </row>
                    <row>
                        <entry>6</entry>
                        <entry>lpr</entry>
                        <entry>line printer subsystem</entry>
                    </row>
                    <row>
                        <entry>7</entry>
                        <entry>news</entry>
                        <entry>network news subsystem</entry>
                    </row>
                    <row>
                        <entry>8</entry>
                        <entry>uucp</entry>
                        <entry>UUCP subsystem</entry>
                    </row>
                    <row>
                        <entry>9</entry>
                        <entry>cron</entry>
                        <entry>clock daemon</entry>
                    </row>
                    <row>
                        <entry>10</entry>
                        <entry>auth</entry>
                        <entry>security/authorization messages</entry>
                    </row>
                    <row>
                        <entry>11</entry>
                        <entry>ftp</entry>
                        <entry>FTP daemon</entry>
                    </row>
                    <row>
                        <entry>12</entry>
                        <entry><!-- FIXME --></entry>
                        <entry>NTP subsystem</entry>
                    </row>
                    <row>
                        <entry>13</entry>
                        <entry><!-- FIXME --></entry>
                        <entry>log audit</entry>
                    </row>
                    <row>
                        <entry>14</entry>
                        <entry><!-- FIXME --></entry>
                        <entry>log alert</entry>
                    </row>
                    <row>
                        <entry>15</entry>
                        <entry>cron</entry>
                        <entry>clock daemon</entry>
                    </row>
                    <row>
                        <entry>16-23</entry>
                        <entry>local0..local7</entry>
                        <entry>locally used facilities (local0-local7)</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </section>
    <section id="reference_macros">
        <title>Macros</title>
        <indexterm>
            <primary>macros</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>Certain parts of syslog-ng (e.g., destination filenames and message content templates)
            can refer to one or more macros, which get expanded as a message is processed. The table
            below summarizes the macros available in syslog-ng.</para>        
        <para>Macros can be included by prefixing the macro name with a <parameter>$</parameter>
            sign, just like in Bourne compatible shells. Regarding braces around macro names, the
            following two formats are equivalent <parameter>"$MSG"</parameter> and
                <parameter>"${MSG}"</parameter>. </para>
        <para>Default values for macros can also be specified by appending the
            <parameter>:-</parameter> characters and the default value to the macro, e.g.,</para>
        <synopsis>${HOST:-default_hostname}</synopsis>
        <para>Macros can be used to format messages, and also in the name of destination files. However, they cannot be used in sources as wildcards, for example, to read messages from files or directories that include a date in their name.</para>
        <table>
            <title>Available macros</title>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>BSDTAG</entry>
                        <entry>Facility/priority information in the format used by the FreeBSD
                            syslogd: a priority number followed by a letter that indicates the
                            facility. The priority number can range from <parameter>0</parameter> to
                                <parameter>7</parameter>. The facility letter can range from
                                <parameter>A</parameter> to <parameter>Y</parameter>, where
                                <parameter>A</parameter> corresponds to facility number zero
                            (LOG_KERN), <parameter>B</parameter> corresponds to facility 1
                            (LOG_USER), etc.</entry>
                    </row>
                    <row id="macro_date">
                        <entry>DATE, R_DATE, S_DATE</entry>
                        <entry>Date of the message using the BSD-syslog style timestamp format
                            (month/day/hour/minute/second, each expressed in two digits). This is
                            the original syslog time stamp without year information, e.g.:
                                <parameter>Jun 13 15:58:00</parameter>. </entry>
                    </row>
                    <row id="macro_day">
                        <entry>DAY, R_DAY, S_DAY</entry>
                        <entry>The day the message was sent. </entry>
                    </row>
                    <row id="macro_facility">
                        <entry>FACILITY</entry>
                        <entry>The facility that sent the message.</entry>
                    </row>
                    <row id="macro_fulldate">
                        <entry>FULLDATE, R_FULLDATE, S_FULLDATE</entry>
                        <entry>A nonstandard format for the date of the message using the same
                            format as <parameter>DATE</parameter>, but including the year as well,
                            e.g.: <parameter>2006 Jun 13 15:58:00</parameter>.</entry>
                    </row>
                    <row>
                        <entry>FULLHOST</entry>
                        <entry>The full FQDN of the host name chain (without trimming chained
                            hosts), including the domain name. To use this macro, make sure that the
                                <link linkend="source_commonoption_keep_hostname">
                                <parameter>keep_hostname()</parameter>
                            </link> option is enabled.</entry>
                    </row>
                    <row>
                        <entry>FULLHOST_FROM</entry>
                        <entry>FQDN of the host that sent the message to syslog-ng as resolved by
                            syslog-ng using DNS. If the message traverses several hosts, this is the
                            last host in the chain. To use this macro, make sure that the <link
                                linkend="source_commonoption_keep_hostname">
                                <parameter>keep_hostname()</parameter>
                            </link> option is enabled.</entry>
                    </row>
                    <row id="macro_hour">
                        <entry>HOUR, R_HOUR, S_HOUR</entry>
                        <entry>The hour of day the message was sent. </entry>
                    </row>
                    <row id="macro_host">
                        <entry>HOST</entry>
                        <entry>The name of the source host where the message originates from. If the
                            message traverses several hosts and the <link
                                linkend="option_chain_hostnames">
                                <parameter>chain_hostnames()</parameter>
                            </link> option is on, the first host in the chain is used. To use this
                            macro, make sure that the <link
                                linkend="source_commonoption_keep_hostname">
                                <parameter>keep_hostname()</parameter>
                            </link> option is enabled.</entry>
                    </row>
                    <row>
                        <entry>HOST_FROM</entry>
                        <entry>Name of the host that sent the message to syslog-ng, as resolved by
                            syslog-ng using DNS. If the message traverses several hosts, this is the
                            last host in the chain. To use this macro, make sure that the <link
                                linkend="source_commonoption_keep_hostname">
                                <parameter>keep_hostname()</parameter>
                            </link> option is enabled.</entry>
                    </row>
                    <row id="macro_isodate">
                        <entry>ISODATE, R_ISODATE, S_ISODATE</entry>
                        <entry>Date of the message in the ISO 8601 compatible standard timestamp
                            format (yyyy-mm-ddThh:mm:ss+-ZONE), e.g.:
                                <parameter>2006-06-13T15:58:00.123+01:00</parameter>. If possible,
                            it is recommended to use <parameter>ISODATE</parameter> for
                            timestamping. Note that syslog-ng can produce fractions of a second
                            (e.g., milliseconds) in the timestamp by using the
                                <parameter>frac_digits()</parameter> global or per-destination
                            option.</entry>
                    </row>
                    <row id="macro_min">
                        <entry>MIN, R_MIN, S_MIN</entry>
                        <entry>The minute the message was sent. </entry>
                    </row>
                    <row id="macro_month">
                        <entry>MONTH, R_MONTH, S_MONTH</entry>
                        <entry>The month the message was sent as a decimal value, prefixed with a
                            zero if smaller than 10. </entry>
                    </row>
                    <row id="macro_month_abbrev">
                        <entry>MONTH_ABBREV, R_MONTH_ABBREV, S_MONTH_ABBREV</entry>
                        <entry>The English abbreviation of the month name (3 letters). </entry>
                    </row>
                    <row id="macro_month_name">
                        <entry>MONTH_NAME, R_MONTH_NAME, S_MONTH_NAME</entry>
                        <entry>The English name of the month name. </entry>
                    </row>
                    <row id="macro_month_week">
                        <entry>MONTH_WEEK, R_MONTH_WEEK, S_MONTH_WEEK</entry>
                        <entry>The number of the week in the given month (0-5). 
                        The week with numerical value 1 is the first week 
                        containing a Monday. The days of month before the first 
                        Monday are considered week 0. For example, if a 31-day 
                        month begins on a Sunday, then the 1st of the month is 
                        week 0, and the end of the month (the 30th and 31st) is 
                        week 5.
                        </entry>
                    </row>
                    <row id="macro_msg">
                        <entry>MSG or MESSAGE</entry>
                        <entry>Text contents of the log message without the program name and pid.
                            Note that this has changed in syslog-ng version 3.0; in earlier versions
                            this macro included the program name and the pid. In syslog-ng 3.0, the
                                <parameter>MSG</parameter> macro became equivalent with the
                                <parameter>MSGONLY</parameter> macro. The program name and the pid
                            together are available in the <parameter>MSGHDR</parameter>
                        macro.</entry>
                    </row>
                    <row>
                        <entry>MSGHDR</entry>
                        <entry>The name and the pid of the program that sent the log message in
                                <parameter>PROGRAM: PID </parameter> format. Includes a trailing
                            whitespace. Note that the macro returns an empty value if both the
                            program and pid fields of the message are empty.</entry>
                    </row>
                    <row>
                        <entry>MSGONLY</entry>
                        <entry>Message contents without the program name or pid. </entry>
                    </row>
                    <row>
                        <entry>PID</entry>
                        <entry>The PID of the program sending the message. </entry>
                    </row>
                    <row id="macro_pri">
                        <entry>PRI</entry>
                        <entry>The priority and facility encoded as a 2 or 3 digit decimal number as
                            it is present in syslog messages. </entry>
                    </row>
                    <row id="macro_priority">
                        <entry>PRIORITY or LEVEL</entry>
                        <entry>The priority of the message. </entry>
                    </row>
                    <row>
                        <entry>PROGRAM</entry>
                        <entry>The name of the program sending the message. Note that the content of
                            the $PROGRAM variable may not be completely trusted as it is provided by
                            the client program that constructed the message.</entry>
                    </row>
                    <row id="macro_sdata">
                        <entry>SDATA.SDID.SDNAME</entry>
                        <entry>The syslog-ng application automatically parses the STRUCTURED-DATA
                            part of IETF-syslog messages, which can be referenced in macros. For
                            example, if a log message contains the following structured data:
                                <parameter>[exampleSDID@0 iut="3" eventSource="Application"
                                eventID="1011"][examplePriority@0 class="high"]</parameter> you can
                            use macros like: <parameter>${SDATA.EXAMPLE.EVENTSOURCE}</parameter> &mdash; this would return the <parameter>Application</parameter> string in this case.
                        </entry>
                    </row>
                    <row id="macro_sec">
                        <entry>SEC, R_SEC, S_SEC</entry>
                        <entry>The second the message was sent. </entry>
                    </row>
                    <row id="macro_seqnum">
                        <entry>SEQNUM</entry>
                        <entry>The sequence number of the message is a unique identifier of the
                            message between the end-points. The syslog-ng client calculates this
                            number when processing a new message from a local source; it is not
                            calculated for relayed messages. The sequence number increases for every
                            message, and is not lost even if syslog-ng is reloaded or restarted. The
                            sequence number is a part of every message that uses the new IETF-syslog
                            protocol (<parameter>.SDATA.meta.sequenceId</parameter>), and can be
                            added to BSD-syslog messages using this macro.</entry>
                        <!-- FIXME kellene rola leiras/concept esetleg -->
                    </row>
                    <row>
                        <entry>SOURCEIP</entry>
                        <entry>IP address of the host that sent the message to syslog-ng. (I.e. the
                            IP address of the host in the <parameter>FULLHOST_FROM</parameter>
                            macro.) Please note that when a message traverses several relays, this
                            macro contains the IP of the last relay. </entry>
                    </row>
                    <row id="macro_stamp">
                        <entry>STAMP, R_STAMP, S_STAMP</entry>
                        <entry>A timestamp formatted according to the <link
                                linkend="reference_options">
                                <parameter>ts_format()</parameter>
                            </link> global or per-destination option.</entry>
                    </row>
                    <row id="macro_tag">
                        <entry>TAG</entry>
                        <entry>The priority and facility encoded as a 2 digit hexadecimal number.
                        </entry>
                    </row>
                    <row id="macro_tz">
                        <entry>TZ, R_TZ, S_TZ</entry>
                        <entry>Equivalent to TZOFFSET, used to mean the time zone name abbreviation
                            in syslog-ng 1.6.x. </entry>
                    </row>
                    <row id="macro_tzoffset">
                        <entry>TZOFFSET, R_TZOFFSET, S_TZOFFSET</entry>
                        <entry>The time-zone as hour offset from GMT; e.g.:
                            <parameter>-07:00</parameter>. In syslog-ng 1.6.x this used to be
                                <parameter>-0700</parameter> but as <parameter>ISODATE</parameter>
                            requires the colon it was added to <parameter>TZOFFSET</parameter> as
                            well. </entry>
                    </row>
                    <row id="macro_unixtime">
                        <entry>UNIXTIME, R_UNIXTIME, S_UNIXTIME</entry>
                        <entry>Standard unix timestamp, represented as the number of seconds since
                                <parameter>1970-01-01T00:00:00</parameter>. </entry>
                    </row>
                    <row id="macro_year">
                        <entry>YEAR, R_YEAR, S_YEAR</entry>
                        <entry>The year the message was sent. </entry>
                    </row>
                    <row id="macro_week">
                        <entry>WEEK, R_WEEK, S_WEEK</entry>
                        <entry>The week number of the year, prefixed with a zero for the first nine
                            week of the year. (The first Monday in the year marks the first
                        week.)</entry>
                    </row>
                    <row id="macro_week_abbrev">
                        <entry>WEEK_ABBREV, R_WEEK_ABBREV, S_WEEK_ABBREV</entry>
                        <entry>The English abbreviation of the name of the day (3 letters).</entry>
                    </row>
                    <row id="macro_week_day">
                        <entry>WEEK_DAY, R_WEEK_DAY, S_WEEK_DAY</entry>
                        <entry>The day of the week as a numerical value (1-7).</entry>
                    </row>
                    <row id="macro_weekday">
                        <entry>WEEKDAY, R_WEEKDAY, S_WEEKDAY</entry>
                        <entry>The 3-letter name of the day of week the message was sent, e.g.
                                <parameter>Thu</parameter>. </entry>
                    </row>
                    <row id="macro_week_day_name">
                        <entry>WEEK_DAY_NAME, R_WEEK_DAY_NAME, S_WEEK_DAY_NAME</entry>
                        <entry>The English name of the day.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </section>
    <section id="reference_parsers">
        <title>Message parsers</title>
        <indexterm>
            <primary>parsers</primary>
            <secondary>reference</secondary>
        </indexterm>
        <indexterm>
            <primary>message parsing</primary>
        </indexterm>
        <indexterm>
            <primary>parsing messages</primary>
        </indexterm>
        <para>The following sections provide reference for the parsers available in syslog-ng.</para>
        <itemizedlist>
            <listitem>
                <para>To segment structured messages like comma-separated values, see <xref
                        linkend="reference_parsers_csv"/>.</para>
            </listitem>
            <listitem>
                <para>To classify messages using a pattern database, see <xref
                        linkend="reference_parsers_pattern_databases"/>.</para>
            </listitem>
        </itemizedlist>

        <section id="reference_parsers_csv">
            <title>CSV parsers</title>
            <indexterm>
                <primary>segmenting messages</primary>
            </indexterm>
            <indexterm>
                <primary>CSV parsers</primary>
            </indexterm>
            <indexterm>
                <primary>splitting messages</primary>
            </indexterm>
            <para>The syslog-ng application can separate parts of log messages (i.e., the contents
                of the $MSG macro) to named fields (columns). These fields act as user-defined
                macros that can be referenced in message templates, file- and tablenames, etc. </para>
            <para>To create a parser, define the columns of the message, the delimiter or separator
                characters, and optionally the characters that are used to escape the delimiter
                characters (quote-pairs).</para>
            <synopsis>Declaration:
    parser parser_name {
        csv-parser(column1, column2, ...)
        delimiters()
        quote-pairs()
    };</synopsis>
            <para>Column names work like macros. Always use a prefix to identify the columns of the
                parsers, e.g., <parameter>MYPARSER1.COLUMN1, MYPARSER2.COLUMN2</parameter>, etc.
                Column names starting with a dot (e.g., <parameter>.HOST</parameter>) are reserved
                for use by syslog-ng. </para>
            <table id="parser_options">
                <title>Parser parameters</title>
                <tgroup cols="3">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Synopsis</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>csv-parser</entry>
                            <entry>csv-parser(columns("PARSER.COLUMN1", "PARSER.COLUMN2", ...))</entry>
                            <entry>Specifies the type of parser to use, and the name of the columns
                                to separate messages to. Currently only the
                                <parameter>csv-parser</parameter> is implemented, which can separate
                                columns based on delimiter characters and strings.</entry>
                        </row>
                        <row>
                            <entry>delimiters</entry>
                            <entry>delimiters("&lt;delimiter_characters&gt;")</entry>
                            <entry>The character that separates the columns in the message. </entry>
                        </row>
                        <row>
                            <entry>flags()</entry>
                            <entry>drop-invalid, escape-none, escape-backslash, escape-double-char,
                                greedy, strip-whitespace</entry>
                            <entry>
                                <para>When the <parameter>drop-invalid</parameter> option is set,
                                    the parser does not process messages that have less columns than
                                    defined in the parser. Using this option practically turns the
                                    parser into a special filter, that matches messages that have
                                    the predifined number of columns (using the specified
                                    delimiters).</para>
                                <para>The <parameter>escape-none, escape-backslash,
                                        escape-double-char</parameter> flags set the escaping rules
                                    used by the parser. </para>
                                <para>The <parameter>greedy</parameter> option assigns the remainder
                                    of the message to the last column, regardless of the delimiter
                                    characters set. You can use this option to process messages
                                    where the number of columns varies.</para>
                                <para>The <parameter>strip-whitespace</parameter> flag removes
                                    trailing whitespaces from the beginning and the end of the
                                    columns.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>quote-pairs()</entry>
                            <entry>quote-pairs('&lt;quote_pairs&gt;')</entry>
                            <entry>List quote-pairs between single quotes. Delimiter characters
                                enclosed between quote characters are ignored. Note that the
                                beginning and ending quote character does not have to be identical,
                                e.g., <parameter>[}</parameter> can also be a quote-pair.</entry>
                        </row>
                        <row>
                            <entry>template()</entry>
                            <entry>template("${&lt;macroname&gt;}")</entry>
                            <entry>The macro that contains the part of the message that the parser
                                will process. It can also be a macro created by a previous parser of
                                the log path. By default, this is empty and the parser processes the
                                entire message.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>

            <example id="example_parser">
                <title>Segmenting hostnames separated with a dash</title>
                <para>The following example separates hostnames like
                    <parameter>example-1</parameter> and <parameter>example-2</parameter> into two
                    parts.</para>
                <synopsis>parser p_hostname_segmentation {
    csv-parser(columns("HOSTNAME.NAME", "HOSTNAME.ID")
    delimiters("-")
    flags(escape-none)
    template("${HOST}"));
};
destination d_file { file("/var/log/messages-${HOSTNAME.NAME:-examplehost}"); };
log { source(s_local); parser(p_hostname_segmentation); destination(d_file);};</synopsis>
            </example>
            <example id="example_parser_apache">
                <title>Parsing Apache log files</title>
                <para>The following parser processes the log of Apache web servers and separates
                    them into different fields. Apache log messages can be formatted like:</para>
                <synopsis>"%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %T %v"</synopsis>
                <para>Here is a sample message: </para>
                <synopsis>192.168.1.1 - - [31/Dec/2007:00:17:10 +0100] "GET /cgi-bin/example.cgi HTTP/1.1" 200 2708 "-" "curl/7.15.5 (i4 86-pc-linux-gnu) libcurl/7.15.5 OpenSSL/0.9.8c zlib/1.2.3 libidn/0.6.5" 2 example.balabit</synopsis>
                <para>To parse such logs, the delimiter character is set to a single whitespace
                        (<parameter>delimiters(" ")</parameter>). Whitespaces between quotes and
                    brackets are ignored (<parameter>quote-pairs('""[]')</parameter>).</para>
                <synopsis>parser p_apache {
    csv-parser(columns("APACHE.CLIENT_IP", "APACHE.IDENT_NAME", "APACHE.USER_NAME",
        "APACHE.TIMESTAMP", "APACHE.REQUEST_URL", "APACHE.REQUEST_STATUS",
        "APACHE.CONTENT_LENGTH", "APACHE.REFERER", "APACHE.USER_AGENT",
        "APACHE.PROCESS_TIME", "APACHE.SERVER_NAME")
         flags(escape-double-char,strip-whitespace)
         delimiters(" ")
         quote-pairs('""[]')
         );
};</synopsis>
                <para>The results can be used for example to separate log messages into different
                    files based on the APACHE.USER_NAME field. If the field is empty, the
                        <parameter>nouser</parameter> name is assigned.</para>
                <synopsis>log { source(s_local);
    parser(p_apache); destination(d_file);};
};
destination d_file { file("/var/log/messages-${APACHE.USER_NAME:-nouser}"); };</synopsis>
            </example>
            <example id="example_parser_multiple">
                <title>Segmenting a part of a message</title>
                <para>The following example splits the timestamp of a parsed Apache log message into
                    separate fields.</para>
                <synopsis>parser p_apache_timestamp {
    csv-parser(columns("APACHE.TIMESTAMP.DAY", "APACHE.TIMESTAMP.MONTH", "APACHE.TIMESTAMP.YEAR", "APACHE.TIMESTAMP.HOUR", "APACHE.TIMESTAMP.MIN", "APACHE.TIMESTAMP.MIN", "APACHE.TIMESTAMP.ZONE")
    delimiters("/: ")
    flags(escape-none)
    template("${APACHE.TIMESTAMP}"));
    };
log { source(s_local);
    log { parser(p_apache); parser(p_apache_timestamp); destination(d_file);};
};
</synopsis>
            </example>
            <example id="example_parser_greedy">
                <title>Adding the end of the message to the last column</title>
                <para>If the <parameter>greedy</parameter> option is enabled, the syslog-ng
                    application adds the not-yet-parsed part of the message to the last column,
                    ignoring any delimiter characters that may appear in this part of the message.</para>
                <para>For example, you receive the following comma-separated message:
                        <parameter>example 1, example2, example3</parameter>, and you segment it
                    with the following parser:</para>
                <synopsis>csv_parser(columns("COLUMN1", "COLUMN2", "COLUMN3") delimiters(","));</synopsis>
                <para>The <parameter>COLUMN1</parameter>, <parameter>COLUMN2</parameter>, and
                        <parameter>COLUMN3</parameter> variables will contain the strings
                        <parameter>example1</parameter>, <parameter>example2</parameter>, and
                        <parameter>example3</parameter>, respectively. If the message looks like
                        <parameter>example 1, example2, example3, some more information</parameter>,
                    then any text appearing after the third comma (i.e., <parameter>some more
                        information</parameter>) is not parsed, and possibly lost if you use only
                    the variables to reconstruct the message (for example, to send it to different
                    columns of an SQL table). </para>
                <para>Using the <parameter>greedy</parameter> flag will assign the remainder of the
                    message to the last column, so that the <parameter>COLUMN1</parameter>,
                        <parameter>COLUMN2</parameter>, and <parameter>COLUMN3</parameter> variables
                    will contain the strings <parameter>example1</parameter>,
                    <parameter>example2</parameter>, and <parameter>example3, some more
                    information</parameter>.</para>
                <synopsis>csv_parser(columns("COLUMN1", "COLUMN2", "COLUMN3") delimiters(",") flags(greedy));</synopsis>
            </example>
        </section>
        <section id="reference_parsers_pattern_databases">
            <title>Pattern databases</title>
            <xi:include href="../../common/chapters/patterndb_common.xml"
                xmlns:xi="http://www.w3.org/2001/XInclude"
                xpointer="element(patterndb-using-parsers)"/>
            <section id="patterndb-filtering">
                <title>Filtering messages based on classification</title>
                <indexterm>
                    <primary>parsers</primary>
                </indexterm>
                <indexterm>
                    <primary>message parsing</primary>
                </indexterm>
                <indexterm>
                    <primary>parsing messages</primary>
                </indexterm>
                <indexterm>
                    <primary>pattern database</primary>
                </indexterm>
                <indexterm>
                    <primary>classifying messages</primary>
                    <secondary>filtering</secondary>
                </indexterm>
                <indexterm>
                    <primary>message classification</primary>
                </indexterm>
                <para>The results of message classification and parsing can be used in custom
                    filters and file and database templates as well. There are two built-in macros
                    in &abbrev; that allow you to use the results of the classification: the
                        <parameter>.classifier.class</parameter> macro contains the class assigned
                    to the message (e.g., violation, security, or unknown), while the
                        <parameter>.classifier.rule_id</parameter> macro contains the identifier of
                    the message pattern that matched the message.</para>
                <example id="example_patterndb_filtering">
                    <title>Using classification results for filtering messages</title>
                    <para>To filter on a specific message class, create a filter that checks the
                            <guimenu>.classifier_class</guimenu> macro, and use this filter in a log
                        statement.</para>
                    <synopsis>filter fi_class_violation {
                        match("violation"
                        value(".classifier.class")
                        type("string")
                        );
                        };</synopsis>
                    <synopsis>log { 
                        source(s_all);
                        parser(pattern_db);
                        filter(fi_class_violation);
                        destination(di_class_violation);
                        };</synopsis>
                    <para>Filtering on the <parameter>unknown</parameter> class selects messages
                        that did not match any rule of the pattern database. Routing these messages
                        into a separate file allows you to periodically review new or unknown
                        messages.</para>
                    <para>To filter on messages matching a specific classification rule, create a
                        filter that checks the <guimenu>.classifier_rule_id</guimenu> macro. The
                        unique identifier of the rule (e.g.,
                            <parameter>e1e9c0d8-13bb-11de-8293-000c2922ed0a</parameter>) is the
                            <parameter>id</parameter> attribute of the rule in the XML database.</para>
                    <synopsis>filter fi_class_rule {
                        match("e1e9c0d8-13bb-11de-8293-000c2922ed0a"
                        value(".classifier_rule_id")
                        type("string")
                        );
                        };</synopsis>
                </example>

                <para>The message-segments parsed by the pattern parsers can also be used as macros
                    as well. To accomplish this, you have to add a name to the parser, and then you
                    can use this name as a macro that refers to the parsed value of the message.</para>
                <example id="example_patterndb_patternfilter">
                    <title>Using pattern parsers as macros</title>
                    <para>For example, you want to parse messages of an application that look like
                            <parameter>"Transaction: &lt;type&gt;."</parameter>, where
                        &lt;type&gt; is a string that has different values (e.g., refused,
                        accepted, incomplete, etc.). To parse these messages, you can use the
                        following pattern:</para>
                    <synopsis>'Transaction: @ESTRING::.@'</synopsis>
                    <para>Here the @ESTRING@ parser parses the message until the next full stop
                        character. To use the results in a filter or a filename template, include a
                        name in the parser of the pattern, e.g.:</para>
                    <synopsis>'Transaction: @ESTRING:TRANSACTIONTYPE:.@'</synopsis>
                    <para>After that, add a custom template to the logpath that uses this template.
                        For example, to select every <parameter>accepted</parameter> transaction,
                        use the following custom filter in the log path:</para>
                    <synopsis>match("accepted" value("TRANSACTIONTYPE"));</synopsis>
                </example>
                <note>
                    <para>The above macros can be used in database columns and filename templates as
                        well, if you create custom templates for the destination or logspace.</para>
                    <para>Use a consistent naming scheme for your macros, for example,
                            <parameter>APPLICATIONNAME_MACRONAME</parameter>.</para>
                </note>
            </section>
            <section id="reference_patterndb_schemes">
                <title>Creating pattern databases</title>
                <indexterm>
                    <primary>pattern database</primary>
                </indexterm>
                <indexterm>
                    <primary>classifying messages</primary>
                    <secondary>creating databases</secondary>
                </indexterm>
                <indexterm>
                    <primary>message classification</primary>
                </indexterm>
                <para>Pattern databases are XML files that contain rules describing the message
                    patterns. For sample pattern databases, see <xref linkend="patterndb-download"
                    />.</para>
                <section id="patterndb-version-comparison">
                    <title>What's new in the syslog-ng pattern database format V3</title>
                    <para>The V3 database format has the following differences compared to the
                        original V1 format:</para>
                    <itemizedlist>
                        <listitem>
                            <para>The rules that are applied to the messages of a program can be
                                separated into multiple rulesets.</para>
                        </listitem>
                        <listitem>
                            <para>The program pattern of the rulesets can be empty; such rulesets
                                act as fallback rulesets that are applied to the log messages if no
                                program pattern is matching or when a message does not have a
                                program part.</para>
                        </listitem>
                        <listitem>
                            <para>Rules can contain multiple patterns to cover messages that have
                                multiple formats (e.g., multilingual messages).</para>
                        </listitem>
                        <listitem>
                            <para>Tags can be defined in the rules; these tags are automatically
                                assigned to messages matching the patterns of the rule.</para>
                        </listitem>
                        <listitem>
                            <para>Static named values can be defined in the rules; these are
                                automatically assigned to messages matching the patterns of the
                                rule. The assigned values can be used in filters and macros.</para>
                        </listitem>
                        <listitem>
                            <para>It is also possible to include sample messages in the rules, and
                                also the expected values of the parsers. These can be used to test
                                the behavior of the patterns.</para>
                        </listitem>
                    </itemizedlist>
                </section>
                <section>
                    <title>The syslog-ng pattern database format</title>
                    <para>The following scheme describes the V3 format of the pattern database. This
                        format is used by syslog-ng 3.1 and later, and the syslog-ng Store Box (SSB)
                        appliance version 1.1 and later (see <ulink
                            url="http://www.balabit.com/network-security/syslog-ng/log-server-appliance/"
                            >http://www.balabit.com/network-security/syslog-ng/log-server-appliance/</ulink>
                        for details on SSB).</para>
                    <para>For a sample database containing only a single pattern, see <xref
                            linkend="example_pattern_database_v3_su"/>.</para>
                    <para>For earlier versions of the syslog-ng pattern database formats, see <xref
                            linkend="app-patterndb"/>.</para>
                    <para>For a summary of differences between the different syslog-ng pattern
                        database formats, see <xref linkend="patterndb-version-comparison"/>.</para>
                    <tip>
                        <para>Use the <command>pdbtool</command> utility that is bundled with
                            syslog-ng to test message patterns and convert existing databases to the
                            latest format. See <xref linkend="pdbtool.1"/> for details.</para>
                    </tip>
                    <itemizedlist id="reference_patterndb_scheme_v3">
                        <listitem>
                            <para><guimenu>&lt;patterndb&gt;</guimenu>: The container
                                element of the pattern database. For example:
                                <synopsis>&lt;patterndb version='3' pub_date='2009-10-25'&gt;</synopsis></para>
                        </listitem>
                        <listitem>
                            <para><emphasis>version</emphasis>: The schema version of the pattern
                                database. The current version is <parameter>3</parameter>.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis>pubdate</emphasis>: The publication date of the XML
                                file.</para>
                        </listitem>
                        <listitem>
                            <para><guimenu>&lt;ruleset&gt;</guimenu>: A container element to
                                group log patterns for an application or program. For example:
                                <synopsis>&lt;ruleset name='su' id='480de478-d4a6-4a7f-bea4-0c0245d361e1'&gt;</synopsis></para>
                            <para> A <parameter>&lt;patterndb&gt;</parameter> element may
                                contain any number of <guimenu>&lt;ruleset&gt;</guimenu>
                                elements.</para>
                            <itemizedlist>
                                <listitem>
                                    <para><emphasis>name</emphasis>: The name of the application.
                                        Note that the function of this attribute is to make the
                                        database more readable, syslog-ng uses the
                                            <parameter>&lt;pattern&gt;</parameter> element
                                        to identify the applications sending log messages.</para>
                                </listitem>
                                <listitem>
                                    <para><emphasis>id</emphasis>: A unique ID of the application,
                                        for example, the md5 sum of the <parameter>name</parameter>
                                        attribute.</para>
                                </listitem>
                                <listitem>
                                    <para><guimenu>description</guimenu>: OPTIONAL &mdash; A
                                        description of the ruleset or the application.</para>
                                </listitem>
                                <listitem>
                                    <para><guimenu>url</guimenu>: OPTIONAL &mdash; An URL
                                        referring to further information about the ruleset or the
                                        application.</para>
                                </listitem>
                                <listitem>
                                    <para><guimenu>pattern</guimenu>: The name of the application
                                        &mdash; syslog-ng matches this value to the $PROGRAM
                                        header of the syslog message to find the rulesets applicable
                                        to the syslog message. This element is also called
                                            <parameter>program pattern</parameter>. E.g., <synopsis>&lt;pattern&gt;su&lt;/pattern&gt;</synopsis>
                                        <note>
                                            <para>If the
                                                <parameter>&lt;pattern&gt;</parameter>
                                                element of a ruleset is not specified, -ng will use
                                                this ruleset as a fallback ruleset: it will apply
                                                the ruleset to messages that have an empty PROGRAM
                                                header, or if none of the program patterns matched
                                                the PROGRAM header of the incoming message. </para>
                                        </note>
                                    </para>
                                </listitem>
                                <listitem>
                                    <para><guimenu>&lt;rules&gt;</guimenu>: A container
                                        element for the rules of the ruleset.</para>
                                    <itemizedlist>
                                        <listitem>
                                            <para><guimenu>&lt;rule&gt;</guimenu>: An
                                                element containing message patterns and how a
                                                message that matches these patterns is classified.
                                                For example:
                                                <synopsis>&lt;rule provider='balabit'
                                                id='f57196aa-75fd-11dd-9bba-001e6806451b'
                                                class='violation'&gt;</synopsis></para>
                                            <note>
                                                <para>If the following characters appear in the
                                                  message, they must be escaped in the rule as
                                                  follows:</para>
                                                <itemizedlist>
                                                  <listitem>
                                                  <para><parameter>@</parameter>: Use @@,
                                                  e.g.,
                                                  <parameter>user@@example.com</parameter></para>
                                                  </listitem>
                                                  <listitem>
                                                  <para><emphasis>&lt;</emphasis>: Use
                                                  <parameter>&amp;lt;</parameter></para>
                                                  </listitem>
                                                  <listitem>
                                                  <para><emphasis>&gt;</emphasis>: Use
                                                  <parameter>&amp;gt;</parameter></para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>&amp;: Use
                                                  <parameter>&amp;amp;</parameter></para>
                                                  </listitem>
                                                </itemizedlist>
                                            </note>
                                            <para>The <guimenu>&lt;rules&gt;</guimenu>
                                                element may contain any number of
                                                  <guimenu>&lt;rule&gt;</guimenu>
                                                elements.</para>
                                        </listitem>
                                        <listitem>
                                            <para><emphasis>provider</emphasis>: The provider of the
                                                rule. This is used to distinguish between who
                                                supplied the rule; i.e., if it has been created by
                                                BalaBit, or added to the xml by a local user.</para>
                                        </listitem>
                                        <listitem>
                                            <para><emphasis>id</emphasis>: The globally unique ID of
                                                the rule.</para>
                                        </listitem>
                                        <listitem>
                                            <para><emphasis>class</emphasis>: The class of the rule
                                                &mdash; syslog-ng assigns this class to the
                                                messages matching a pattern of this rule.</para>
                                        </listitem>

                                        <listitem>
                                            <para><guimenu>&lt;patterns&gt;</guimenu>: An
                                                element containing the patterns of the rule. If a
                                                  <guimenu>&lt;patterns&gt;</guimenu>
                                                element contains multiple
                                                  <guimenu>&lt;pattern&gt;</guimenu>
                                                elements, the class of the
                                                  <guimenu>&lt;rule&gt;</guimenu> is
                                                assigned to every syslog message matching any of the
                                                patterns. </para>
                                            <itemizedlist>
                                                <listitem>
                                                  <para><guimenu>&lt;pattern&gt;</guimenu>:
                                                  A pattern describing a log message. This
                                                  element is also called <parameter>message
                                                  pattern</parameter>. For example:
                                                  <synopsis>&lt;pattern&gt;+ ??? root-&lt;/pattern&gt;</synopsis></para>
                                                </listitem>
                                                <listitem>
                                                  <para><guimenu>description</guimenu>: OPTIONAL
                                                  &mdash; A description of the pattern or
                                                  the log message matching the pattern.
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para><guimenu>urls</guimenu>: OPTIONAL
                                                  &mdash; An element containing one or
                                                  more URLs referring to further information
                                                  about the patterns or the matching log
                                                  messages.</para>
                                                  <itemizedlist>
                                                  <listitem>
                                                  <para><guimenu>url</guimenu>: OPTIONAL
                                                  &mdash; An URL referring to
                                                  further information about the
                                                  patterns or the matching log
                                                  messages.</para>
                                                  </listitem>
                                                  </itemizedlist>
                                                </listitem>
                                                <listitem>
                                                  <para><guimenu>values</guimenu>: OPTIONAL
                                                  &mdash; Name-value pairs that are
                                                  assigned to messages matching the patterns,
                                                  for example, the representation of the event
                                                  described in the message in Common Event
                                                  Format (CEF). The names can be used as
                                                  macros to reference the assigned values.</para>
                                                  <itemizedlist>
                                                  <listitem>
                                                  <para><guimenu>value</guimenu>: OPTIONAL
                                                  &mdash; Contains the value of
                                                  the name-value pair that is assigned
                                                  to the message. For example:
                                                  <synopsis>&lt;value name=".classifier.outcome"&gt;/Success&lt;/value&gt;</synopsis>
                                                  </para>
                                                  </listitem>
                                                  <listitem>
                                                  <para><emphasis>name</emphasis>: The
                                                  name of the name-value pair. It can
                                                  also be used as a macro to reference
                                                  the assigned value.</para>
                                                  </listitem>
                                                  </itemizedlist>
                                                </listitem>
                                                <listitem>
                                                  <para><guimenu>examples</guimenu>: OPTIONAL
                                                  &mdash; A container element for sample
                                                  log messages that should be recognized by
                                                  the pattern. These messages can be used also
                                                  to test the patterns and the parsers.</para>
                                                  <itemizedlist>
                                                  <listitem>
                                                  <para><guimenu>example</guimenu>:
                                                  OPTIONAL &mdash; A container
                                                  element for a sample log message. </para>
                                                  <itemizedlist>
                                                  <listitem>
                                                  <para><guimenu>test_message</guimenu>:
                                                  OPTIONAL &mdash; A
                                                  sample log message that
                                                  should match this pattern.
                                                  For example:
                                                  <synopsis>&lt;test_message&gt;Content filter has been enabled&lt;/test_message&gt;</synopsis></para>
                                                  </listitem>
                                                  <listitem>
                                                  <para><guimenu>test_values</guimenu>:
                                                  OPTIONAL &mdash; A
                                                  container element to test
                                                  the results of the parsers
                                                  used in the pattern.</para>
                                                  <itemizedlist>
                                                  <listitem>
                                                  <para><guimenu>test_value</guimenu>:
                                                  OPTIONAL &mdash;
                                                  The expected value
                                                  of the parser when
                                                  matching the pattern
                                                  to the test message.
                                                  For example:
                                                  <synopsis>&lt;test_value name=".dict.ContentFilter"&gt;enabled&lt;/test_value&gt;</synopsis></para>
                                                  </listitem>
                                                  <listitem>
                                                  <para><emphasis>name</emphasis>:
                                                  The name of the
                                                  parser to
                                                  test.</para>
                                                  </listitem>
                                                  </itemizedlist>
                                                  </listitem>
                                                  </itemizedlist>
                                                  </listitem>
                                                  </itemizedlist>
                                                </listitem>
                                                <listitem>
                                                  <indexterm>
                                                  <primary>tagging messages</primary>
                                                  </indexterm>
                                                  <indexterm>
                                                  <primary>tags</primary>
                                                  </indexterm>
                                                  <para><guimenu>tags</guimenu>: OPTIONAL
                                                  &mdash; An element containing custom
                                                  keywords (tags) about the messages matching
                                                  the patterns. The tags can be used to label
                                                  specific events (e.g., user logons). It is
                                                  also possible to filter on these tags later
                                                  (see <xref linkend="tagging_messages"/> for
                                                  details).</para>
                                                  <itemizedlist>
                                                  <listitem>
                                                  <para><guimenu>tag</guimenu>: OPTIONAL
                                                  &mdash; A keyword or tags
                                                  applied to messages matching the
                                                  rule. For example:
                                                  <synopsis>&lt;tags&gt;&lt;tag&gt;UserLogin&lt;/tag&gt;&lt;/tags&gt;</synopsis></para>
                                                  </listitem>
                                                  </itemizedlist>
                                                </listitem>
                                            </itemizedlist>
                                        </listitem>
                                    </itemizedlist>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                    </itemizedlist>
                    <example id="example_pattern_database_v3_su">
                        <title>A V3 pattern database containing a single rule</title>
                        <indexterm>
                            <primary>pattern database</primary>
                        </indexterm>
                        <para>The following pattern database contains a single rule that matches a
                            log message of the <parameter>ssh</parameter> application. A sample log
                            message looks like:</para>
                        <synopsis>Accepted password for sampleuser from 10.50.0.247 port 42156 ssh2</synopsis>
                        <para>The following is a simple pattern database containing a matching rule.</para>
                        <synopsis>&lt;patterndb version='3' pub_date='2009-04-17'&gt;
    &lt;ruleset name='ssh' id='123456678'&gt;
        &lt;pattern&gt;ssh&lt;/pattern&gt;
            &lt;rules&gt;
                &lt;rule provider='me' id='182437592347598' class='system'&gt;
                    &lt;patterns&gt;
                        &lt;pattern&gt;Accepted @QSTRING:SSH.AUTH_METHOD: @ for@QSTRING:SSH_USERNAME: @from\ @QSTRING:SSH_CLIENT_ADDRESS: @port @NUMBER:SSH_PORT_NUMBER:@ ssh2&lt;/pattern&gt;
                    &lt;/patterns&gt;
                &lt;/rule&gt;
            &lt;/rules&gt;
    &lt;/ruleset&gt;
&lt;/patterndb&gt;</synopsis>
                        <para>Note that the rule uses macros that refer to parts of the message, for
                            example, you can use the <parameter>$SSH_USERNAME</parameter> macro
                            refer to the username used in the connection.</para>
                        <para>The following is the same example, but with a test message and test
                            values for the parsers.</para>
                        <synopsis>&lt;patterndb version='3' pub_date='2009-04-17'&gt;
    &lt;ruleset name='ssh' id='123456678'&gt;
        &lt;pattern&gt;ssh&lt;/pattern&gt;
            &lt;rules&gt;
                &lt;rule provider='me' id='182437592347598' class='system'&gt;
                    &lt;patterns&gt;
                        &lt;pattern&gt;Accepted @QSTRING:SSH.AUTH_METHOD: @ for@QSTRING:SSH_USERNAME: @from\ @QSTRING:SSH_CLIENT_ADDRESS: @port @NUMBER:SSH_PORT_NUMBER:@ ssh2&lt;/pattern&gt;
                    &lt;/patterns&gt;
                    &lt;examples&gt;
                        &lt;example&gt;
                            &lt;test_message&gt;Accepted password for sampleuser from 10.50.0.247 port 42156 ssh2&lt;/test_message&gt;
                            &lt;test_values&gt;
                                &lt;test_value name="SSH.AUTH_METHOD"&gt;password&lt;/test_value&gt;
                                &lt;test_value name="SSH_USERNAME"&gt;sampleuser&lt;/test_value&gt;
                                &lt;test_value name="SSH_CLIENT_ADDRESS"&gt;10.50.0.247&lt;/test_value&gt;
                                &lt;test_value name="SSH_PORT_NUMBER"&gt;42156&lt;/test_value&gt;
                            &lt;/test_values&gt;
                       &lt;/example&gt;
                    &lt;/examples&gt;
                &lt;/rule&gt;
            &lt;/rules&gt;
    &lt;/ruleset&gt;
&lt;/patterndb&gt;</synopsis>
                    </example>
                </section>
            </section>
        </section>
    </section>
    <section id="reference_rewrite">
        <title>Rewriting messages</title>
        <indexterm>
            <primary>rewrite</primary>
            <secondary>reference</secondary>
        </indexterm>
        <indexterm>
            <primary>rewriting messages</primary>
        </indexterm>
        <indexterm>
            <primary>sedding messages</primary>
        </indexterm>
        <indexterm>
            <primary>replacing message text</primary>
        </indexterm>
        <para>The syslog-ng application can rewrite parts of log
            messages<!--( i.e., the contents of
        the $MSG macro)-->: it can search and
            replace text, and also set a specific field to a specified value. Rewriting messages is
            often used in conjunction with message parsing <xref linkend="reference_parsers"/>.</para>
        <para>To create replace a part of the log message, define the string or regular expression
            to replace, the string to replace the original text (macros can be used as well), and
            the field of the message that the rewrite rule should process. Substitution rules can
            operate on any value available via macros, e.g., HOST, MESSAGE, PROGRAM, or any
            user-defined macros created using parsers (see <xref linkend="reference_parsers"/> for
            details).</para>
        <para>As of syslog-ng 3.1, it is also possible to rewrite the structured-data fields of
            messages complying to the RFC5424 (IETF-syslog) message format. Substitution rules use
            the following syntax:</para>
        <synopsis>Declaration:
    rewrite &lt;name_of_the_rule&gt;
    {subst("&lt;string or regular expression to find&gt;", "&lt;replacement string&gt;", value(&lt;field name&gt;) type() flags());};</synopsis>
        <para>The <parameter>type()</parameter> and <parameter>flags()</parameter> options are
            optional. The <parameter>type()</parameter> specifies the type of regular expression to
            use; while the <parameter>flags()</parameter> are the flags of the regular expressions
            (see <xref linkend="reference_regular_expressions"/> for details):</para>
        <table id="reference_rewrite_types">
            <title>Rewrite rule types</title>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>posix</entry>
                        <entry>Use POSIX regular expressions. If the <parameter>type()</parameter>
                            parameter is not specified, syslog-ng uses POSIX regular expressions by
                            default.</entry>
                    </row>
                    <row>
                        <entry>pcre</entry>
                        <entry>Use PCRE regular expressions. This is available only if syslog-ng was
                            compiled with the <parameter>--enable-pcre</parameter> option. Execute
                            the <command>syslog-ng -V</command> command to list the options
                            supported by your binary.</entry>
                    </row>
                    <row>
                        <entry>string</entry>
                        <entry>Match the strings literally, without regular expression support. By
                            default, only identical strings are matched. For partial matches, use
                            the <parameter>flags("prefix")</parameter> or the
                                <parameter>flags("substring")</parameter> flags.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <example id="example_rewrite_subst">
            <title>Using substitution rules</title>
            <para>The following example replaces the first occurrence of the string
                <parameter>IP</parameter> in the text of the message with the string
                    <parameter>IP-Address</parameter>.</para>
            <synopsis>rewrite r_rewrite_subst{subst("IP", "IP-Address", value("MESSAGE"));};</synopsis>
            <para>To replace every occurrence, use:</para>
            <synopsis>rewrite r_rewrite_subst{subst("IP", "IP-Address", value("MESSAGE"), flags("global"));};</synopsis>
            <para>Multiple substitution rules are applied sequentially; the following rules replace
                the first occurrence of the string <parameter>IP</parameter> with the string
                    <parameter>IP-Addresses</parameter>. </para>
            <synopsis>rewrite r_rewrite_subst{subst("IP", "IP-Address", value("MESSAGE")); subst("Address", "Addresses", value("MESSAGE"));};</synopsis>
        </example>
        <indexterm>
            <primary>setting message fields</primary>
        </indexterm>
        <para>To set a field of the message to a specific value, define the string to include in the
            message, and the field where it should be included. Setting a field can operate on any
            value available via macros, e.g., HOST, MESSAGE, PROGRAM, or any user-defined macros
            created using parsers (see <xref linkend="reference_parsers"/> for details.). Note that
            this operation completely replaces any previous value of that field. Use the following
            syntax:</para>
        <synopsis>Declaration:
    rewrite &lt;name_of_the_rule&gt;
    {set("&lt;string to include&gt;", value(&lt;field name&gt;)  flags());};</synopsis>
        <example id="example_rewrite_set">
            <title>Setting message fields to a particular value</title>
            <para>The following example sets the HOST field of the message to
                <parameter>myhost</parameter>. </para>
            <synopsis>rewrite r_rewrite_set{set("myhost", value("HOST"));};</synopsis>
            <para>The following example sets the sequence ID field of the RFC5424-formatted
                (IETF-syslog) messages to a fixed value.</para>
            <synopsis>rewrite r_sd { set("55555" value(".SDATA.meta.sequenceId")); };</synopsis>
        </example>
    </section>
    <section id="reference_regular_expressions">
        <title>Regular expressions</title>
        <indexterm significance="preferred">
            <primary>regular expressions</primary>
        </indexterm>
        <para>Filters and substitution rewrite rules can use regular expressions. The regular expressions can use up to 255 regexp matches (<parameter>${1} ... ${255}</parameter>), but only from the last filter and only if the <parameter>flags("store-matches")</parameter> flag was set for the filter. For case-insensitive searches, use the <parameter>flags("ignore-case")</parameter> option.</para>
        <indexterm>
            <primary>regular expressions</primary>
            <secondary>pcre</secondary>
        </indexterm>
        <para>By default, syslog-ng uses POSIX-style regular expressions, but if compiled with the
                <parameter>--enable-pcre</parameter> option, Perl Compatible Regular Expressions can
            be used as well. To use Perl Compatible Regular Expressions (PCRE), add the
            <parameter>type("pcre")</parameter> option after the regular expression. Note that PCRE
            expressions can be used only if syslog-ng was explicitly compiled with the
            <parameter>--enable-pcre</parameter> option. Execute the <command>syslog-ng -V</command>
            command to list the options supported by your binary.</para>
        <para>Posix regular expressions have the following flag options:</para>
        <table>
            <title>Posix options</title>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>global</entry>
                        <entry>Usable only in rewrite rules; match for every occurrence of the
                            expression, not only the first one.</entry>
                    </row>
                    <row>
                        <entry>ignore-case</entry>
                        <entry>Disable case-sensitivity.</entry>
                    </row>
                    <!--<row>
                        <entry>newline</entry>
                        <entry></entry>
                    </row>-->
                    <row>
                        <entry>store-matches</entry>
                        <entry>Store the matches of the regular expression into the <parameter>$1,
                                ... $255</parameter> variables. Matches from the last filter
                            expression can be referenced in regular expressions</entry>
                    </row>
                    <row>
                        <entry>utf8</entry>
                        <entry>Use UTF-8 matching.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <example id="example_regexp_posix">
            <title>Using Posix regular expressions</title>
            <synopsis>filter f_message { message("keyword" flags("utf8" "ignore-case") );</synopsis>
        </example>
        <para>PCRE regular expressions have the following flag options:</para>
        <table>
            <title>PCRE options</title>
            <tgroup cols="2">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>global</entry>
                        <entry>Usable only in rewrite rules; match for every occurrence of the
                            expression, not only the first one.</entry>
                    </row>
                    <row>
                        <entry>ignore-case</entry>
                        <entry>Disable case-sensitivity.</entry>
                    </row>
                    <!--<row>
                        <entry>newline</entry>
                        <entry>Process the string until the end of the string, ignoring newline
                            characters.</entry>
                    </row>-->
                    <row>
                        <entry>nobackref</entry>
                        <entry>Do not store back references for the matches &mdash; improves
                            performance.</entry>
                    </row>
                    <row>
                        <entry>store-matches</entry>
                        <entry>Store the matches of the regular expression into the <parameter>$1,
                                ... $255</parameter> variables. Named matches (also called named
                            subpatterns), e.g., <parameter>(?&lt;name&gt;...)</parameter>,
                            are stored as well. Matches from the last filter expression can be
                            referenced in regular expressions</entry>
                    </row>
                    <row>
                        <entry>unicode</entry>
                        <entry>Use Unicode support for UTF-8 matches: UTF-8 character sequences are
                            handled as single characters.</entry>
                    </row>
                    <row>
                        <entry>utf8</entry>
                        <entry>An alias for the <parameter>unicode</parameter> flag.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <example id="example_regexp_pcre">
            <title>Using PCRE regular expressions</title>
            <synopsis>rewrite r_rewrite_subst 
        {subst("a*", "?", field("message") type("pcre") flags("utf8" "global"));  };</synopsis>
        </example>
    </section>


    <section id="reference_options">
        <title>Global options</title>
        <indexterm>
            <primary>options</primary>
            <secondary>reference</secondary>
        </indexterm>
        <indexterm>
            <primary>global options</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>The following options can be specified in the options statement, as described in <xref
                linkend="options"/>.</para>
        <table>
            <title>List of global options supported in syslog-ng</title>
            <tgroup cols="4">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Accepted values</entry>
                        <entry>Default</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>bad_hostname()</entry>
                        <entry>regular expression</entry>
                        <entry>no</entry>
                        <entry>A regexp containing hostnames which should not be handled as
                            hostnames. </entry>
                    </row>
                    <row id="option_chain_hostnames">
                        <entry>chain_hostnames()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>Enable or disable the chained hostname format.</entry>
                    </row>
                    <row>
                        <entry>check_hostname()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>Enable or disable checking whether the hostname contains valid
                            characters.</entry>
                    </row>
                    <row>
                        <entry>create_dirs()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>Enable or disable directory creation for destination files.</entry>
                    </row>
                    <row>
                        <entry>dir_group()</entry>
                        <entry>groupid</entry>
                        <entry>root</entry>
                        <entry>The default group for newly created directories.</entry>
                    </row>
                    <row>
                        <entry>dir_owner()</entry>
                        <entry>userid</entry>
                        <entry>root</entry>
                        <entry>The default owner of newly created directories.</entry>
                    </row>
                    <row>
                        <entry>dir_perm()</entry>
                        <entry>permission value</entry>
                        <entry>0700</entry>
                        <entry>The default permission for newly created directories.</entry>
                    </row>
                    <row>
                        <entry>dns_cache()</entry>
                        <entry>yes or no</entry>
                        <entry>yes</entry>
                        <entry>Enable or disable DNS cache usage.</entry>
                    </row>
                    <row>
                        <entry>dns_cache_expire()</entry>
                        <entry>number</entry>
                        <entry>3600</entry>
                        <entry>Number of seconds while a successful lookup is cached.</entry>
                    </row>
                    <row>
                        <entry>dns_cache_expire_failed()</entry>
                        <entry>number</entry>
                        <entry>60</entry>
                        <entry>Number of seconds while a failed lookup is cached.</entry>
                    </row>
                    <row>
                        <entry>dns_cache_hosts()</entry>
                        <entry>filename</entry>
                        <entry>unset</entry>
                        <entry>Name of a file in <filename>/etc/hosts</filename> format that
                            contains static IP->hostname mappings. Use this option to resolve
                            hostnames locally without using a DNS. Note that any change to this file
                            triggers a reload in syslog-ng and is instantaneous. </entry>
                    </row>
                    <row>
                        <entry>dns_cache_size()</entry>
                        <entry>number</entry>
                        <entry>1007</entry>
                        <entry>Number of hostnames in the DNS cache.</entry>
                    </row>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(destination_commonoption_timezone)"/>
                    <row>
                        <entry>flush_lines()</entry>
                        <entry>number</entry>
                        <entry>0</entry>
                        <entry>Specifies how many lines are flushed to a destination at a time.
                            Syslog-ng waits for this number of lines to accumulate and sends them
                            off in a single batch. Setting this number high increases throughput as
                            fully filled frames are sent to the network, but also increases message
                            latency. The latency can be limited by the use of the
                                <parameter>flush_timeout</parameter> option. </entry>
                    </row>
                    <row>
                        <entry>flush_timeout()</entry>
                        <entry>time in milliseconds</entry>
                        <entry>10000</entry>
                        <entry>Specifies the time syslog-ng waits for lines to accumulate in its
                            output buffer. See the <parameter>flush_lines()</parameter> option for
                            more information. </entry>
                    </row>
                    <row>
                        <entry>group()</entry>
                        <entry>groupid</entry>
                        <entry>root</entry>
                        <entry>The default group of output files. By default, syslog-ng changes the
                            privileges of accessed files (e.g., <parameter>/dev/null</parameter>) to
                                <parameter>root.root 0600</parameter>. To disable modifying
                            privileges, use this option with the <parameter>-1</parameter>
                        value.</entry>
                    </row>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(source_commonoption_keep_hostname)"/>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(source_commonoption_keep_timestamp)"/>
                    <row>
                        <entry>log_fifo_size()</entry>
                        <entry>number</entry>
                        <entry>1000</entry>
                        <entry>The number of lines fitting to the output queue. Note that it is not possible to set this option lower than 1000.</entry>
                    </row>
                    <row>
                        <entry>log_msg_size()</entry>
                        <entry>number</entry>
                        <entry>8192</entry>
                        <entry>Maximum length of a message in bytes.</entry>
                    </row>
                    <row>
                        <entry>normalize_hostnames()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>Normalize hostnames, which currently translates to converting them to
                            lower case. (requires 1.9.9)</entry>
                    </row>
                    <row>
                        <entry>owner()</entry>
                        <entry>userid</entry>
                        <entry>root</entry>
                        <entry>The default owner of output files. By default, syslog-ng changes the
                            privileges of accessed files (e.g., <parameter>/dev/null</parameter>) to
                                <parameter>root.root 0600</parameter>. To disable modifying
                            privileges, use this option with the <parameter>-1</parameter>
                        value.</entry>
                    </row>
                    <row>
                        <entry>mark()</entry>
                        <entry>number</entry>
                        <entry>1200</entry>
                        <entry>An alias for the obsolete <parameter>mark_freq()</parameter> option,
                            retained for compatibility with syslog-ng version 1.6.x.</entry>
                    </row>
                    <row>
                        <entry>mark_freq()</entry>
                        <entry>number</entry>
                        <entry>1200</entry>
                        <entry>The number of seconds between two <parameter>MARK</parameter>
                            messages. <parameter>MARK</parameter> messages are generated when there
                            was no message traffic to inform the receiver that the connection is
                            still alive. Note that only local messages postpone the sending of the
                                <parameter>MARK</parameter> message, relayed messages do not. If set
                            to zero (<parameter>0</parameter>), no <parameter>MARK</parameter>
                            messages are sent. </entry>
                    </row>
                    <row>
                        <entry>perm()</entry>
                        <entry>permission value</entry>
                        <entry>0600</entry>
                        <entry>The default permission for output files. By default, syslog-ng
                            changes the privileges of accessed files (e.g.,
                            <parameter>/dev/null</parameter>) to <parameter>root.root
                            0600</parameter>. To disable modifying privileges, use this option with
                            the <parameter>-1</parameter> value.</entry>
                    </row>
                    <row>
                        <entry>recv_time_zone()</entry>
                        <entry>time offset (e.g.: <parameter>+03:00</parameter>)</entry>
                        <entry>local timezone</entry>
                        <entry>Specifies the time zone associated with the incoming messages, if not
                            specified otherwise in the message or in the source driver. See also
                                <xref linkend="timezone_handling"/> and <xref
                                linkend="example_timezones"/> for details.</entry>
                    </row>
                    <row>
                        <entry>send_time_zone()</entry>
                        <entry>time offset (e.g.: <parameter>+03:00</parameter>)</entry>
                        <entry>local timezone</entry>
                        <entry>Specifies the time zone associated with the messages sent by
                            syslog-ng, if not specified otherwise in the message or in the
                            destination driver. See <xref linkend="timezone_handling"/> for
                        details.</entry>
                    </row>
                    <row>
                        <entry>stats_freq()</entry>
                        <entry>number</entry>
                        <entry>600</entry>
                        <entry>The period between two STATS messages in seconds. STATS are log
                            messages sent by syslog-ng, containing statistics about dropped log
                            messages. Set to <parameter>0</parameter> to disable the STATS
                        messages.</entry>
                    </row>
                    <row id="global_option_stats_level">
                        <entry>stats_level()</entry>
                        <entry>0, 1, 2, or 3</entry>
                        <entry>0</entry>
                        <entry><para>Specifies the detail of statistics syslog-ng collects about the processed messages.</para>
                        <itemizedlist>
                            <listitem>
                                <para>Level 0 collects only statistics about the sources
                            and destinations</para>
                            </listitem>
                            <listitem>
                                <para>Level 1 contains details about the different
                            connections and log files, but has a slight memory overhead</para>
                            </listitem>
                            <listitem>
                                <para>Level 2 contains detailed statistics based on the hostname.</para>
                            </listitem>
                            <listitem>
                                <para>Level 3 contains detailed statistics based on various message parameters like facility, severity, or tags.</para>
                            </listitem>
                        </itemizedlist>
                         <para>Note that level 2 and 3 increase the memory requirements and CPU load.</para> </entry>
                    </row>
                    <row id="global_option_stats_reset">
                        <entry>stats_reset()</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry><para>If enabled, the statistics of orphaned objects (object that were present earlier in the syslog-ng configuration file, but have been deleted) are automatically deleted when the configuration is reloaded.</para>
                        </entry>
                    </row>
                    <row>
                        <entry>sync() or sync_freq() (DEPRECATED)</entry>
                        <entry>number</entry>
                        <entry>0</entry>
                        <entry>Obsolete aliases for <parameter>flush_lines()</parameter></entry>
                    </row>
                    <row>
                        <entry>time_reap()</entry>
                        <entry>number</entry>
                        <entry>60</entry>
                        <entry>The time to wait in seconds before an idle destination file is
                            closed.</entry>
                    </row>
                    <row>
                        <entry>time_reopen()</entry>
                        <entry>number</entry>
                        <entry>60</entry>
                        <entry>The time to wait in seconds before a dead connection is
                            reestablished.</entry>
                    </row>
                    <row>
                        <entry>time_sleep()</entry>
                        <entry>number</entry>
                        <entry>0</entry>
                        <entry>The time to wait in milliseconds between each invocation of the
                                <parameter>poll()</parameter> iteration.</entry>
                    </row>
                    <row>
                        <entry>ts_format()</entry>
                        <entry>rfc3164, bsd, rfc3339, iso</entry>
                        <entry>rfc3164</entry>
                        <entry>Specifies the timestamp format used when syslog-ng itself formats a
                            timestamp and nothing else specifies a format (e.g.:
                            <parameter>STAMP</parameter> macros, internal messages, messages without
                            original timestamps). See also <xref linkend="example_timezones"
                        />.</entry>
                    </row>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(source_commonoption_use_dns)"/>
                    <xi:include href="reference_common.xml"
                        xmlns:xi="http://www.w3.org/2001/XInclude"
                        xpointer="element(source_commonoption_use_fqdn)"/>
                    <row>
                        <entry>use_time_recvd() (DEPRECATED)</entry>
                        <entry>yes or no</entry>
                        <entry>no</entry>
                        <entry>
                            <para>This option controls how the time related macros are expanded in
                                filename and content templates. If set to yes, then the non-prefixed
                                versions of the time related macros (e.g.:
                                <parameter>HOUR</parameter> instead of <parameter>R_HOUR</parameter>
                                and <parameter>S_HOUR</parameter>) refer to the time when the
                                message was received, otherwise it refers to the timestamp which is
                                in the message. </para>
                            <para>NOTE: The timestamps in the messages are generated by the
                                originating host and might not be accurate. </para>
                            <para>This option is deprecated as many users assumed that it controls
                                the timestamp as it is written to logfiles/destinations, which is
                                not the case. To change how messages are formatted, specify a
                                content-template referring to the appropriate prefixed
                                    (<parameter>S_</parameter> or <parameter>R_</parameter>) time
                                macro. </para>
                        </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </section>
    <section id="tlsoptions">
        <title>TLS options</title>
        <indexterm>
            <primary>TLS</primary>
            <secondary>reference</secondary>
        </indexterm>
        <para>The syslog-ng application is able to encrypt incoming and outgoing syslog message
            flows using SSL/TLS, if the TCP transport protocol (the <parameter>tcp()</parameter> or
                <parameter>tcp6()</parameter> sources or destination) is used. </para>
        <note>
            <para>The format of the TLS connections used by syslog-ng is similar to using syslog-ng
                and stunnel, but the source IP information is not lost. </para>
        </note>
        <para>To encrypt connections, use the <parameter>tls()</parameter> option in the source and
            destination statements. </para>
        <para>The tls() option can include the following settings: </para>
        <table>
            <title>List of TLS options</title>
            <tgroup cols="4">
                <thead>
                    <row>
                        <entry>Name</entry>
                        <entry>Accepted values</entry>
                        <entry>Default</entry>
                        <entry>Description</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>ca_dir()</entry>
                        <entry>Directory name</entry>
                        <entry>none</entry>
                        <entry>Name of a directory, that contains a set of trusted CA certificates
                            in PEM format. The CA certificate files has to be named after the 32-bit
                            hash of the subject's name. This naming can be created using the
                            c_rehash utility in openssl. </entry>
                    </row>
                    <row>
                        <entry>cert_file()</entry>
                        <entry>Filename</entry>
                        <entry>none</entry>
                        <entry>Name of a file, that contains an X.509 certificate in PEM format,
                            suitable as a TLS certificate, matching the private key. </entry>
                    </row>
                    <row>
                        <entry>crl_dir()</entry>
                        <entry>Directory name</entry>
                        <entry>none</entry>
                        <entry>Name of a directory that contains the Certificate Revocation Lists
                            for trusted CAs. Similarly to <parameter>ca_dir()</parameter> files, use
                            the 32-bit hash of the name of the issuing CAs as filenames. The
                            extension of the files must be <parameter>.r0</parameter>.</entry>
                    </row>
                    <row>
                        <entry>key_file()</entry>
                        <entry>Filename</entry>
                        <entry>none</entry>
                        <entry>Name of a file, that contains an unencrypted private key in PEM
                            format, suitable as a TLS key. </entry>
                    </row>
                    <row>
                        <entry>peer_verify()</entry>
                        <entry>optional-trusted | optional-untrusted | required-trusted |
                            required-untrusted</entry>
                        <entry>required-trusted</entry>
                        <entry>Verification method of the peer, the four possible values is a
                            combination of two properties of validation: whether the peer is
                            required to provide a certificate (required or optional prefix), and
                            whether the certificate provided needs to be trusted or not. For
                            untrusted certificates only the existence of the certificate is checked,
                            but it does not have to be valid &mdash; syslog-ng accepts the
                            certificate even if it is expired, signed by an unknown CA, or its CN
                            and the name of the machine mismatch. </entry>
                    </row>
                    <row>
                        <entry>trusted_dn()</entry>
                        <entry>list of accepted distinguished names</entry>
                        <entry>none</entry>
                        <entry>To accept connections only from hosts using certain certificates
                            signed by the trusted CAs, list the distinguished names of the accepted
                            certificates in this parameter. E.g., using <parameter>trusted_dn("*,
                                O=Example Inc, ST=Some-State, C=*")</parameter> will accept only
                            certificates issued for the <parameter>Example Inc</parameter>
                            organization in <parameter>Some-State</parameter> state.</entry>
                    </row>
                    <row>
                        <entry>trusted_keys()</entry>
                        <entry>list of accepted SHA-1 fingerprints</entry>
                        <entry>none</entry>
                        <entry>To accept connections only from hosts using certain certificates
                            having specific SHA-1 fingerprints, list the fingerprints of the
                            accepted certificates in this parameter. E.g.,
                                <parameter>trusted_keys("SHA1:00:EF:ED:A4:CE:00:D1:14:A4:AB:43:00:EF:00:91:85:FF:89:28:8F",
                                "SHA1:0C:42:00:3E:B2:60:36:64:00:E2:83:F0:80:46:AD:00:A8:9D:00:15")</parameter>.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <note>
            <para>When using the <parameter>trusted_keys()</parameter> and
                <parameter>trusted_dn()</parameter> parameters, note the following:</para>
            <itemizedlist>
                <listitem>
                    <para>First, the <parameter>trusted_keys()</parameter> parameter is checked. If
                        the fingerprint of the peer is listed, the certificate validation is
                        performed.</para>
                </listitem>
                <listitem>
                    <para>If the fingerprint of the peer is not listed in the
                            <parameter>trusted_keys()</parameter> parameter, the
                            <parameter>trusted_dn()</parameter> parameter is checked. If the DN of
                        the peer is not listed in the <parameter>trusted_dn()</parameter> parameter,
                        the authentication of the peer fails and the connection is closed.</para>
                </listitem>
            </itemizedlist>
        </note>
    </section>
</chapter>
