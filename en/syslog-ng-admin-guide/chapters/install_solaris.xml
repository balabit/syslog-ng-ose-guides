<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter 
 [  <!ENTITY % entities SYSTEM "../syslog-ng-entities.ent">
 %entities;]> 
<chapter xml:id="chapter_solaris" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title>Installing syslog-ng on Solaris</title>
    <section xml:id="install_solaris_89">
        <title>Installing syslog-ng on Sun Solaris 8 and 9</title>
        <indexterm>
            <primary>installing syslog-ng</primary>
            <secondary>on Solaris 8 and 9</secondary>
        </indexterm>
        <para>To successfully install syslog-ng, complete the following simple procedure. Lines
            starting with <parameter>#</parameter> are commands that have to be executed from a
            command line console.</para>
        <note>
            <para>Direct SQL access is currently available only for Sparc systems.</para>
        </note>
        <note>
            <para>Steps 4 and 7 are slightly different on Solaris 8 systems, see the notes at the
                respective steps for details.</para>
        </note>

        <procedure xml:id="installing-solaris">
            <title>Installing syslog-ng on Sun Solaris 8 or 9</title>
            <step>
                <para>Use the your username and password received together with your syslog-ng
                    Premium Edition license to download the following binaries. Make sure to
                    download the package specific for the processor architecture of the host.</para>
                <itemizedlist>
                    <listitem>
                        <para>The syslog-ng Premium Edition package
                                (<filename>syslog-ng-premium-edition_&lt;version&gt;</filename>)
                            from </para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/s/syslog-ng-premium-edition/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/s/syslog-ng-premium-edition/</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para>The eventlog library package
                            (<filename>libevtlog_&lt;version&gt;</filename>)
                            from </para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/e/eventlog/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/e/eventlog/</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para>The <filename>libdbi8</filename> package from</para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8/</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para>The <filename>libiconv</filename> and <filename>libgcc</filename>
                            packages required by the <filename>libdbi8</filename> package. For
                            Solaris 9, download the
                            <filename>libiconv-1.11-sol9-sparc-local.gz</filename> and
                                <filename>libgcc-3.4.6-sol9-sparc-local.gz</filename> packages from
                                <ulink url="http://www.sunfreeware.com"
                            >http://www.sunfreeware.com</ulink>. For Solaris 8, download the
                                <filename>libiconv-1.11-sol8-sparc-local.gz</filename> and
                                <filename>libgcc-3.4.6-sol8-sparc-local.gz</filename> packages.
                        </para>
                    </listitem>
                    <listitem>
                        <para>If you plan to use an SQL destination (excluding Oracle), download the
                            package corresponding to your database from</para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8-drivers/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8-drivers/</ulink>
                        </para>
                        <para>Also download the package corresponding to the database, architecture,
                            and Solaris version you plan to use from <ulink
                                url="http://www.sunfreeware.com">http://www.sunfreeware.com</ulink>.
                            The Sunfreeware.com website includes details on installing the database,
                            and any required dependencies.</para>
                        <itemizedlist>
                            <!-- FIXME most copyzva sol 10-bol -->
                            <!-- FIXME add oracle if tested -->
                            <listitem>
                                <para>For MySQL, download the
                                        <parameter>mysql-5.0.41-sol9-sparc-local</parameter> and
                                        <parameter>openssl-0.9.8h-sol9-sparc-local</parameter>
                                    packages.</para>
                            </listitem>
                            <listitem>
                                <para>For PostgreSQl, the required packages are available on the
                                    Solaris 9 installation DVD.</para>
                            </listitem>
                           <!-- <listitem>
                                <para>For SQLite, download the
                                        <parameter>-3.3.6-sol9-sparc-local.gz</parameter>
                                    package. </para>
                            </listitem>-->
                        </itemizedlist>
                        <note>
                            <para>The database packages contain the full database applications, but
                                syslog-ng does not use the databases, only the
                                <parameter>.so</parameter> file. Installing the database packages
                                does not start the database services.</para>
                        </note>
                    </listitem>
                    <listitem>
                        <para>If you plan to use the Oracle destination, download the
                                <filename>libdbi8</filename> package corresponding to your platform
                            from</para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8-drivers/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8-drivers/</ulink>
                        </para>
                    </listitem>
                </itemizedlist>
            </step>
            <step>
                <para>Download or copy the
                        <filename>syslog-ng_&lt;version_number&gt;_sparc.pkg.gz</filename>
                    package to your computer running Solaris.</para>
            </step>
            <step>
                <para>Unpack and install the syslog-ng Premium Edition, libdbi8, libiconv
                    and the libgcc packages by
                    issuing the following commands from the command line: </para>
                <synopsis># gunzip libiconv-1.11-sol9-sparc-local.gz
# gunzip libgcc-3.4.6-sol9-sparc-local.gz
# gunzip syslog-ng_&lt;version_number&gt;_sparc.pkg.gz
# gunzip libevtlog_&lt;version&gt;_&lt;arch&gt;.gz
# gunzip libdbi8_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d libiconv-1.11-sol9-sparc-local.gz
# pkgadd -d libgcc-3.4.6-sol9-sparc-local.gz
# pkgadd -d syslog-ng_&lt;version_number&gt;_sparc.pkg
# pkgadd -d libdbi8_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
            </step>
            <step>
                <para>If you use an SQL destination, issue the commands corresponding to the
                    database:</para>
                <itemizedlist>
                    <listitem>
                        <!-- FIXME SOlaris 10-be is, ha mar teszteltek -->
                        <para>For Oracle:</para>
                        <synopsis># gunzip libdbd8-oracle_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d libdbd8-oracle_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
                    </listitem>
                    <listitem>
                        <para>For MySQL:</para>
                        <synopsis># gunzip libdbd8-mysql_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d libdbd8-mysql_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
                    </listitem>
                    <listitem>
                        <para>For PostgreSQL:</para>
                        <synopsis># gunzip libdbd8-pgsql_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d libdbd8-pgsql_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
                    </listitem>
                    <!--<listitem>
                        <para>For SQLite:</para>
                        <synopsis># gunzip libdbd8-3_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d libdbd8-3_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
                    </listitem>-->
                </itemizedlist>
<!--                <para>For MySQL, PostgreSQL, and SQLite, install the corresponding database package -->
                <para>For MySQL and PostgreSQL, install the corresponding database package
                    and its dependencies downloaded from <ulink url="http://www.sunfreeware.com"
                        >http://www.sunfreeware.com</ulink>.</para>
            </step>
            <step>
                <para>Rename the <filename>syslog-ng.conf.sample</filename> file (located under
                        <filename>/opt/syslog-ng/etc/</filename>) to
                    <parameter>syslog-ng.conf</parameter>.</para>
                <synopsis># mv /opt/syslog-ng/etc/syslog-ng.conf.sample /opt/syslog-ng/etc/syslog-ng.conf</synopsis>
            </step>
            <step>
                <para>Modify the <filename>syslog-ng.conf</filename>.to suit your needs. For details
                    on how to configure syslog-ng, see <emphasis>The syslog-ng Administrator
                    Guide</emphasis>, <xref linkend="chapter_configuration"/>.</para>
            </step>
            <step>
                <para>Copy the startup script into the <filename>/etc/init.d</filename> folder and
                    set its privileges. </para>
                <synopsis># cp /etc/init.d/syslog /etc/init.d/syslog.orig
# cp /opt/syslog-ng/doc/syslog-ng.init.d /etc/init.d/syslog
# chmod 744 /etc/init.d/syslog &amp;&amp; chown root:sys /etc/init.d/syslog</synopsis>
                <note>
                    <para>Under Solaris 8, issue the following commands as well:</para>
                    <synopsis># rm /etc/rc2.d/S74syslog
# ln -s /etc/init.d/syslog /etc/rc2.d/S74syslog
# rm /etc/rc0.d/K40syslog /etc/rc1.d/K40syslog /etc/rcS.d/K40syslog 
# ln -s /etc/init.d/syslog /etc/rc0.d/K40syslog
# ln -s /etc/init.d/syslog /etc/rc1.d/K40syslog
# ln -s /etc/init.d/syslog /etc/rcS.d/K40syslog</synopsis>
                </note>
            </step>
            <step>
                <xi:include href="install_common.xml" xmlns:xi="http://www.w3.org/2001/XInclude"
                    xpointer="xpointer(//section[@id='install_oracle']/*)"/>
            </step>
            <step>
                <para><emphasis>Optional step</emphasis>: When installing syslog-ng to the central
                    syslog-ng server, copy the <filename>license.txt</filename> license file to the
                        <filename>/opt/syslog-ng/syslog-ng.conf</filename> directory of the
                server.</para>
            </step>
            <step>
                <para>Stop the original syslog daemon.</para>
                <synopsis># /etc/init.d/syslog.orig stop</synopsis>
            </step>
            <step>
                <para>Modify the <filename>/etc/logadm.conf</filename> file and replace all
                        <parameter>kill -HUP `cat /var/run/syslog.pid`</parameter> commands with
                        <parameter>kill -HUP `cat /var/run/syslog-ng.pid`</parameter>. This can be
                    accomplished for example using the vi text editor: </para>
                <synopsis># cp /etc/logadm.conf /etc/logadm.conf.orig
# vi /etc/logadm.conf</synopsis>
                <para>Type <parameter>:</parameter> and issue the following command from vi:</para>
                <synopsis>g&lt;/var/run/syslog.pid&lt;s&lt;/var/run/syslog.pid&lt;/var/run/syslog-ng.pid&lt;g</synopsis>
                <note>
                    <para>There is no <parameter>logadm</parameter> utility under Solaris 8,
                        therefore <parameter>newsyslog</parameter> has to be modified. Modify the
                            <filename>/usr/lib/newsyslog</filename> file and replace all
                            <parameter>kill -HUP `cat /etc/syslog.pid`</parameter> commands with
                            <parameter>kill -HUP `cat /var/run/syslog-ng.pid`</parameter>. This can
                        be accomplished for example using the vi text editor: </para>
                    <synopsis># cp /usr/lib/newsyslog /usr/lib/newsyslog.orig# vi /usr/lib/newsyslog</synopsis>
                    <para> Type ':' and issue the following command from vi:</para>
                    <synopsis>g&lt;/etc/syslog.pid&lt;s&lt;/var/run/syslog.pid&lt;/var/run/syslog-ng.pid&lt;g</synopsis>
                </note>
            </step>
            <step>
                <para>Start syslog-ng.</para>
                <synopsis># /etc/init.d/syslog start</synopsis>
            </step>
            <step>
                <para>Verify that the <filename>/var/run/syslog-ng.pid</filename> file
                exists.</para>
            </step>
            <step>
                <para>Verify that syslog-ng is running.</para>
                <synopsis># ps -Af | grep -v grep | grep syslog-ng</synopsis>
            </step>
            <step>
                <para>Send a test message and verify that it has successfully arrived into the
                        <filename>/var/log/messages</filename> file.</para>
                <synopsis># logger -p daemon.crit syslog-ng test
# tail /var/log/messages</synopsis>
            </step>
        </procedure>
    </section>

    <section xml:id="install_solaris_10">
        <title>Installing syslog-ng on Sun Solaris 10</title>
        <indexterm>
            <primary>installing syslog-ng</primary>
            <secondary>on Solaris 10</secondary>
        </indexterm>
        <para>To successfully install syslog-ng, complete the following simple procedure. Lines
            starting with <parameter>#</parameter> are commands that have to be executed from a
            command line console.</para>
        <note>
            <para>Direct SQL access is currently available only for Sparc systems.</para>
        </note>

        <procedure xml:id="installing-solaris-10">
            <title>Installing syslog-ng on Sun Solaris 10</title>
            <step>
                <para>Use the your username and password received together with your syslog-ng
                    Premium Edition license to download the following binaries. Make sure to
                    download the package specific for the processor architecture of the host.</para>
                <itemizedlist>
                    <listitem>
                        <para>The syslog-ng Premium Edition package
                                (<filename>syslog-ng-premium-edition_&lt;version&gt;</filename>)
                            from </para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/s/syslog-ng-premium-edition/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/s/syslog-ng-premium-edition/</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para>The eventlog library package
                            (<filename>libevtlog_&lt;version&gt;</filename>)
                            from </para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/e/eventlog/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/e/eventlog/</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para>The <filename>libdbi8</filename> package from </para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8/</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para> The <filename>libiconv-1.11-sol9-sparc-local.gz</filename> and
                                <filename>libgcc-3.4.6-sol9-sparc-local.gz</filename> packages from
                                <ulink url="http://www.sunfreeware.com"
                            >http://www.sunfreeware.com</ulink>. These packages (originally created
                            for Solaris 9) are required by the <filename>libdbi8</filename> package.
                        </para>
                    </listitem>
                    <listitem>
                        <para>If you plan to use an SQL destination, download the package
                            corresponding to your database from </para>
                        <para>
                            <ulink
                                url="http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8-drivers/"
                                >http://www.balabit.com/downloads/files/syslog-ng/binaries/premium-edition/pool/l/libdbi8-drivers/</ulink>
                        </para>
                        <para>Also download the package corresponding to the database, architecture,
                            and Solaris version you plan to use from <ulink
                                url="http://www.sunfreeware.com">http://www.sunfreeware.com</ulink>.
                            The Sunfreeware.com website includes details on installing the database,
                            and any required dependencies.</para>
                        <itemizedlist>
                            <!-- FIXME most copyzva sol 8-9-be is -->
                            <!-- FIXME add oracle if tested -->
                            <listitem>
                                <para>For MySQL, download the
                                        <parameter>mysql-5.0.41-sol9-sparc-local</parameter> and
                                        <parameter>openssl-0.9.8e-sol9-sparc-local</parameter>
                                    packages.</para>
                            </listitem>
                            <listitem>
                                <para>For PostgreSQl, the required packages are available on the
                                    Solaris 10 installation DVD.</para>
                            </listitem>
                            <!--<listitem>
                                <para>For SQLite, download the
                                        <parameter>-3.3.6-sol9-sparc-local.gz</parameter>
                                    package. </para>
                            </listitem>-->
                        </itemizedlist>
                        <note>
                            <para>The database packages contain the full database applications, but
                                syslog-ng does not use the databases, only the
                                <parameter>.so</parameter> file. Installing the database packages
                                does not start the database services.</para>
                        </note>
                    </listitem>
                </itemizedlist>
            </step>
            <step>
                <para>Download or copy the
                        <filename>syslog-ng_&lt;version_number&gt;_sparc.pkg.gz</filename>
                    package to your computer running Solaris.</para>
            </step>
            <step>
                <para>Unpack and install the syslog-ng Premium Edition, the libdbi8, the libiconv
                    and the libgcc packages by issuing the following commands from the command line: </para>
                <synopsis># gunzip libiconv-1.11-sol9-sparc-local.gz
# gunzip libgcc-3.4.6-sol9-sparc-local.gz <!-- FIXME ez a ketto majd megszunik, ha rendesen SOl10-re lesz forgatva a syslogpe/libdbi -->
# gunzip syslog-ng_&lt;version_number&gt;_sparc.pkg.gz
# gunzip libevtlog_&lt;version&gt;_&lt;arch&gt;.gz
# gunzip libdbi8_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d libiconv-1.11-sol9-sparc-local.gz
# pkgadd -d libgcc-3.4.6-sol9-sparc-local.gz
# pkgadd -d syslog-ng_&lt;version_number&gt;_sparc.pkg
# pkgadd -d libdbi8_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
            </step>
            <step>
                <para>If you use an SQL destination, issue the commands corresponding to the
                    database:</para>
                <itemizedlist>
                    <listitem>
                        <para>For MySQL:</para>
                        <synopsis># gunzip mysql-5.0.41-sol9-sparc-local
# gunzip openssl-0.9.8e-sol9-sparc-local
# gunzip libdbd8-mysql_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d mysql-5.0.41-sol9-sparc-local
# pkgadd -d openssl-0.9.8e-sol9-sparc-local
# pkgadd -d libdbd8-mysql_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
                    </listitem>
                    <listitem>
                        <para>For PostgreSQL:</para>
                        <para>Make sure that the <parameter>SUNWpostgr-libs</parameter> package has
                            been installed. It is available on the Solaris 10 installation DVD. (It
                            is the part of the Postgresql software package in the installer. It is
                            not the same as the <parameter>Postgresql-8.2</parameter> package. If it
                            is not already installed on the system, insert the Solaris 10
                            installation DVD, change to the <filename>Solaris_10/Product/</filename>
                            directory of the DVD (e.g., <filename>cd
                                /cdrom/sol_10_807_sparc/s0/Solaris_10/Product/</filename>), and
                            issue the following command:</para>
                        <synopsis># pkgadd -d . SUNWpostgr-libs</synopsis>
                        <para>Issue the following commands to install the libdbi8 driver packages
                            for PostgreSQL:</para>
                        <synopsis># gunzip libdbd8-pgsql_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d libdbd8-pgsql_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
                    </listitem>
                   <!-- <listitem>
                        <para>For SQLite:</para>
                        <synopsis># gunzip -3.3.6-sol9-sparc-local.gz 
# pkgadd -d -3.3.6-sol9-sparc-local
# gunzip libdbd8-3_&lt;version&gt;_&lt;arch&gt;.gz
# pkgadd -d libdbd8-3_&lt;version&gt;_&lt;arch&gt;.pkg</synopsis>
                    </listitem> -->
                </itemizedlist>
            </step>
            <step>
                <para>Rename the <filename>syslog-ng.conf.sample</filename> file (located under
                        <filename>/opt/syslog-ng/etc/</filename>) to
                    <parameter>syslog-ng.conf</parameter>.</para>
                <synopsis># mv /opt/syslog-ng/etc/syslog-ng.conf.sample /opt/syslog-ng/etc/syslog-ng.conf</synopsis>
            </step>
            <step>
                <para>Modify the <filename>syslog-ng.conf</filename>.to suit your needs. For details
                    on how to configure syslog-ng, see <emphasis>The syslog-ng Administrator
                    Guide</emphasis>, <xref linkend="chapter_configuration"/>.</para>
            </step>
            <step>
                <para><emphasis>Optional step</emphasis>: When installing syslog-ng to the central
                    syslog-ng server, copy the <filename>license.txt</filename> license file to the
                        <filename>/opt/syslog-ng/syslog-ng.conf</filename> directory of the
                server.</para>
            </step>
            <step>
                <para>Disable the original syslogd application.</para>
                <synopsis># svcadm -v disable svc:/system/system-log</synopsis>
            </step>
            <step>
                <para>Copy the following files to their proper places by issuing the following
                    commands and modify them if needed.</para>
                <synopsis># cp /opt/syslog-ng/doc/syslog-ng.example.xml \ /var/svc/manifest/system/syslog-ng.xml
# cp /opt/syslog-ng/doc/syslog-ng.method /lib/svc/method/syslog-ng</synopsis>
            </step>
            <step>
                <para>Issue the following command:</para>
                <synopsis>crle -u -l /usr/local/ssl/lib</synopsis>
            </step>            
            <step>
                <para>Validate and import the <filename>syslog-ng.xml</filename> file using
                        <parameter>svccfg</parameter>.</para>
                <synopsis># svccfg
svc:> validate /var/svc/manifest/system/syslog-ng.xml
svc:> import /var/svc/manifest/system/syslog-ng.xml
svc:> quit</synopsis>
            </step>
            <step>
                <para>Enable and start syslog-ng.</para>
                <synopsis># svcadm enable -t svc:/system/syslog-ng</synopsis>
            </step>
            <step>
                <para>Verify that syslog-ng is running.</para>
                <synopsis># svcs -a | grep syslog</synopsis>
                <para>You should receive a similar output: <parameter>online 10:15:01
                        svc:/system/syslog-ng:default</parameter></para>

            </step>
        </procedure>
    </section>
</chapter>
