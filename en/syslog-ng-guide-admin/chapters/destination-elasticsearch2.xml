<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section
 [  <!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
 %entities;]>
<section xml:id="configuring-destinations-elasticsearch2" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title><parameter>elasticsearch2</parameter>: Sending logs directly to Elasticsearch and Kibana 2.0 or higher</title>
    <indexterm> <primary>destination drivers</primary> <secondary><parameter>java()</parameter> driver</secondary> </indexterm>
    <indexterm> <primary>destination drivers</primary> <secondary><parameter>elasticsearch2</parameter></secondary> </indexterm>
    <para>Starting with version <phrase condition="pe">5.6</phrase><phrase condition="ose">3.7</phrase> of &abbrev; can directly send log messages to <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.elastic.co/products/elasticsearch">Elasticsearch</link>, allowing you to search and analyze your data in real time, and visualize it with <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.elastic.co/products/kibana">Kibana</link>.</para>
    <para>Note the following limitations when using the &abbrev; <parameter>elasticsearch2</parameter> destination:</para>
    <itemizedlist>
        <xi:include href="../../shared/chunk/listitem-java-supported-platforms.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        <listitem>
            <para>Since &abbrev; uses Java libraries, the <parameter>elasticsearch2</parameter> destination has significant memory usage.</para>
        </listitem>
        <xi:include href="../../shared/chunk/listitem-java-internal-messages.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
    </itemizedlist>
    <formalpara>
        <title>Declaration:</title>
        <para/>
    </formalpara>
    <synopsis>@module mod-java
@include "scl.conf"

elasticsearch2(
    index("syslog-ng")
    type("test")
    cluster("syslog-ng")
);</synopsis>
    <example xml:id="example-destination-elasticsearch2">
        <title>Sending log data to Elasticsearch version 2.x and above</title>
        <para>The following example defines an <parameter>elasticsearch2</parameter> destination that sends messages in transport mode to an Elasticsearch server running on the localhost, using only the required parameters.</para>
        <synopsis>@module mod-java
@include "scl.conf"

destination d_elastic {
  elasticsearch2(
    index("syslog-ng")
    type("test")
  );
};
</synopsis>
        <para>The following example sends 10000 messages in a batch, in transport mode, and includes a custom unique ID for each message.</para>
        <synopsis>@module mod-java
@include "scl.conf"

options {
  threaded(yes);
  use-uniqid(yes);
};

source s_syslog {
  syslog();
};

destination d_elastic {
  elasticsearch2(
    index("syslog-ng")
    type("test")
    cluster("syslog-ng")
    client-mode("transport")
    custom-id("${UNIQID}")
    flush-limit("10000")
  );
};

log {
  source(s_syslog);
  destination(d_elastic);
  flags(flow-control);
};</synopsis>
    </example>
    <example xml:id="example-destination-elasticsearch2-http" condition="ose">
        <title>Sending log data to Elasticsearch using the HTTP REST API</title>
        <para>The following example send messages to Elasticsearch over HTTP using its REST API:</para>
        <synopsis>@include "scl.conf"

source s_network {
    network(port(5555));
};

destination d_elastic {
    elasticsearch2(
        client-mode("http")
        cluster("es-syslog-ng")
        index("x201")
        cluster-url("http://192.168.33.10:9200")
        type("slng_test_type")
        flush-limit("0")
    );
};

log {
   source(s_network);
   destination(d_elastic);
   flags(flow-control);
};</synopsis>
        <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
    </example>
    <itemizedlist>
        <listitem>
            <para>To install the software required for the <parameter>elasticsearch2</parameter> destination, see <xref linkend="destination-elasticsearch2-prerequisites"/>.</para>
        </listitem>
        <listitem>
            <para>For details on how the <parameter>elasticsearch2</parameter> destination works, see <xref linkend="destination-elasticsearch2-interaction"/>.</para>
        </listitem>
        <listitem>
            <para>For the list of options, see <xref linkend="reference-destination-elasticsearch2"/>.</para>
        </listitem>
    </itemizedlist>
    <para condition="ose">The <parameter>elasticsearch2()</parameter> driver is actually a reusable configuration snippet configured to receive log messages using the Java language-binding of &abbrev;. For details on using or writing such configuration snippets, see <xref linkend="config-blocks"/>. You can find the source of the elasticsearch configuration snippet on <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://github.com/balabit/syslog-ng/blob/master/scl/elasticsearch/plugin.conf">GitHub</link>. For details on extending &abbrev; in Java, see the <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://syslog-ng.gitbooks.io/getting-started/content/chapters/chapter_5/section_2.html">Getting started with syslog-ng development</link> guide.</para>
    
    <xi:include href="destination-elasticsearch2-prerequisites.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
    
    <section xml:id="destination-elasticsearch2-interaction">
        <title>How &abbrev; interacts with Elasticsearch</title>
        <para>The &abbrev; application sends the log messages to the official Elasticsearch client library, which forwards the data to the Elasticsearch nodes. The way &abbrev; interacts with Elasticsearch is described in the following steps.</para>
        <itemizedlist>
            <listitem>
                <para>After &abbrev; is started and the first message arrives to the <parameter>elasticsearch2</parameter> destination, the <parameter>elasticsearch2</parameter> destination tries to connect to the Elasticsearch server or cluster. If the connection fails, &abbrev; will repeatedly attempt to connect again after the period set in <parameter>time-reopen()</parameter> expires.</para>
            </listitem>
            <listitem>
                <para>If the connection is established, &abbrev; sends JSON-formatted messages to Elasticsearch.</para>
                <xi:include href="../../shared/chunk/option-destination-elasticsearch-flush-limit-description.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            </listitem>
            <listitem>
                <xi:include href="../../shared/chunk/option-destination-elasticsearch-timezone.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            </listitem>
        </itemizedlist>
    </section>
    <section xml:id="destination-elasticsearch2-client-modes">
        <title>Client modes</title>
        <para>The &abbrev; application can interact with Elasticsearch in the following modes of operation: <phrase condition="ose">http, https, </phrase>node,<phrase condition="ose"> searchguard,</phrase> and transport.</para>
        <xi:include href="../../shared/chunk/option-destination-elasticsearch-client-mode-description.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
    </section>
    
    <xi:include href="syslog-ng-elasticsearch2-search-guard.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
    
    <section xml:id="reference-destination-elasticsearch2">
        <title>Elasticsearch2 destination options</title>
        <indexterm> <primary>destination drivers</primary> <secondary><parameter>java()</parameter> driver</secondary> </indexterm>
        <indexterm> <primary>destination drivers</primary> <secondary><parameter>elasticsearch2</parameter></secondary> </indexterm>
        <para>The <parameter>elasticsearch2</parameter> destination can directly send log messages to <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.elastic.co/products/elasticsearch">Elasticsearch</link>, allowing you to search and analyze your data in real time, and visualize it with <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="https://www.elastic.co/products/kibana">Kibana</link>. The <parameter>elasticsearch2</parameter> destination has the following options.</para>
        <formalpara>
            <title>Required options:</title>
            <para/>
        </formalpara>
        <para>The following options are required: <parameter>index()</parameter>, <parameter>type()</parameter>. In node mode, either the <parameter>cluster()</parameter> or the <parameter>resource()</parameter> option is required as well. Note that to use <parameter>elasticsearch2</parameter>, you must add the following lines to the beginning of your &abbrev; configuration:</para>
        <synopsis>@module mod-java
@include "scl.conf"</synopsis>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-java-class-path.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para><emphasis role="bold">Description:</emphasis> Include the path to the directory where you copied the required libraries (see <xref linkend="destination-elasticsearch2-prerequisites"/>), for example, <userinput>client-lib-dir(/user/share/elasticsearch-2.2.0/lib)</userinput>.</para>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-client-mode">
            <title>client-mode()</title>
            <indexterm type="parameter"> <primary>client-mode()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>client-mode</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry><phrase condition="ose">http | https | </phrase>transport | node<phrase condition="ose"> | searchguard</phrase></entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>node</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies the client mode used to connect to the Elasticsearch server, for example, <userinput>client-mode("node")</userinput>.</para>
            <xi:include href="../../shared/chunk/option-destination-elasticsearch-client-mode-description.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-cluster">
            <title>cluster()</title>
            <indexterm type="parameter"> <primary>cluster()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>cluster</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies the name or the Elasticsearch cluster, for example, <userinput>cluster("my-elasticsearch-cluster")</userinput>. Optionally, you can specify the name of the cluster in the Elasticsearch resource file. For details, see <xref linkend="elasticsearch2-option-elasticsearch2-resource"/>.</para>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-cluster-url">
            <xi:include href="../../shared/chunk/option-destination-elasticsearch-cluster-url.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-concurrent-requests">
            <title>concurrent-requests()</title>
            <indexterm type="parameter"> <primary>concurrent-requests()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>concurrent-requests</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>0</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <indexterm> <primary>elasticsearch2</primary> <secondary>performance</secondary> </indexterm>
            <para><emphasis role="bold">Description:</emphasis> The number of concurrent (simultaneous) requests that &abbrev; sends to the Elasticsearch server. Set this option to 1 or higher to increase performance. When using the <parameter>concurrent-requests()</parameter> option, make sure that the <parameter>flush-limit()</parameter> option is higher than one, otherwise it will not have any noticeable effect. For details, see <xref linkend="elasticsearch2-option-elasticsearch2-flush-limit"/>.</para>
            <warning>
                <para>Hazard of data loss! Using the <parameter>concurrent-requests()</parameter> option increases the number of messages lost in case the Elasticsearch server becomes unaccessible.</para>
            </warning>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-custom-id">
            <title>custom-id()</title>
            <indexterm type="parameter"> <primary>custom-id()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>custom-id</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>template or template function</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Use this option to specify a custom ID for the records inserted into Elasticsearch. If this option is not set, the Elasticsearch server automatically generates and ID for the message. For example: <userinput>custom-id(${UNIQID})</userinput> (Note that to use the <userinput>${UNIQID}</userinput> macro, the <parameter>use-uniqid()</parameter> global option must be enabled. For details, see <xref linkend="global-use-uniqid"/>.)</para>
        </simplesect>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-diskbuffer.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-flush-limit">
            <title>flush-limit()</title>
            <indexterm type="parameter"> <primary>flush-limit()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>flush-limit</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>5000</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <indexterm> <primary>elasticsearch2</primary> <secondary>performance</secondary> </indexterm>
            <para><emphasis role="bold">Description:</emphasis> The number of messages that &abbrev; sends to the Elasticsearch server in a single batch.</para>
            <xi:include href="../../shared/chunk/option-destination-elasticsearch-flush-limit-description.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-frac-digits.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-http-auth-type" condition="ose">
            <title>http-auth-type()</title>
            <indexterm type="parameter"> <primary>http-auth-type()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>http-auth-type</secondary> </indexterm>
            <indexterm> <primary>authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>none | basic | clientcert</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>none</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Determines how &abbrev; authenticates to the Elasticsearch server. Depending on the value of this option, you might have to set other options as well. Possible values:</para>
            <itemizedlist>
                <listitem>
                    <para><parameter>none</parameter>: Connect to the Elasticsearch server without authentication.</para>
                </listitem>
                <listitem>
                    <para><parameter>basic</parameter>: Use password authentication. Also set the <link linkend="elasticsearch2-option-elasticsearch2-http-auth-type-basic-username"><parameter>http-auth-type-basic-username</parameter></link> and <link linkend="elasticsearch2-option-elasticsearch2-http-auth-type-basic-password"><parameter>http-auth-type-basic-password</parameter></link> options.</para>
                </listitem>
                <listitem>
                    <para><parameter>clientcert</parameter>: Use a certificate to authenticate. The certificate must be available in a Java keystore. Also set the <link linkend="elasticsearch2-option-elasticsearch2-java-keystore-filepath"><parameter>java-keystore-filepath</parameter></link> and <link linkend="elasticsearch2-option-elasticsearch2-java-keystore-password"><parameter>java-keystore-password</parameter></link> options.</para>
                </listitem>
            </itemizedlist>
            <para>This option is used only in HTTPS mode: <userinput>client-mode("https")</userinput>, and is available in &abbrev; version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</para>
            <example xml:id="elasticsearch2-https-auth-examples">
                <title>HTTPS authentication examples</title>
                <para>The following simple examples show the different authentication modes.</para>
                <xi:include href="../../shared/chunk/example-elasticsearch-https-password.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                <xi:include href="../../shared/chunk/example-elasticsearch-https-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            </example>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-http-auth-type-basic-password" condition="ose">
            <title>http-auth-type-basic-password()</title>
            <indexterm type="parameter"> <primary>http-auth-type-basic-password()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>http-auth-type-basic-password</secondary> </indexterm>
            <indexterm> <primary>authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The password to use for password-authentication on the Elasticsearch server. You must also set the <link linkend="elasticsearch2-option-elasticsearch2-http-auth-type-basic-username"><parameter>http-auth-type-basic-username</parameter></link> option.</para>
            <para>This option is used only in HTTPS mode with basic authentication: <userinput>client-mode("https")</userinput> and <userinput>http-auth-type("basic")</userinput>, and is available in &abbrev; version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-password.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-http-auth-type-basic-username" condition="ose">
            <title>http-auth-type-basic-username()</title>
            <indexterm type="parameter"> <primary>http-auth-type-basic-username()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>http-auth-type-basic-username</secondary> </indexterm>
            <indexterm> <primary>authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The username to use for password-authentication on the Elasticsearch server. You must also set the <link linkend="elasticsearch2-option-elasticsearch2-http-auth-type-basic-password"><parameter>http-auth-type-basic-password</parameter></link> option.</para>
            <para>This option is used only in HTTPS mode with basic authentication: <userinput>client-mode("https")</userinput> and <userinput>http-auth-type("basic")</userinput>, and is available in &abbrev; version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-password.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-index">
            <title>index()</title>
            <indexterm type="parameter"> <primary>index()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>index</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Name of the Elasticsearch index to store the log messages. You can use macros and templates as well.</para>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-java-keystore-filepath" condition="ose">
            <title>java-keystore-filepath()</title>
            <indexterm type="parameter"> <primary>java-keystore-filepath()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>java-keystore-filepath</secondary> </indexterm>
            <indexterm> <primary>authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <indexterm> <primary>certificate authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Path to the Java keystore file that stores the certificate that &abbrev; uses to authenticate on the Elasticsearch server. You must also set the <link linkend="elasticsearch2-option-elasticsearch2-java-keystore-password"><parameter>java-keystore-password</parameter></link> option.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-java-keystore-import.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para>This option is used only in HTTPS mode with basic authentication: <userinput>client-mode("https")</userinput> and <userinput>http-auth-type("clientcert")</userinput>, and is available in &abbrev; version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-java-keystore-password" condition="ose">
            <title>java-keystore-password()</title>
            <indexterm type="parameter"> <primary>java-keystore-password()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>java-keystore-password</secondary> </indexterm>
            <indexterm> <primary>authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <indexterm> <primary>certificate authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The password of the Java keystore file set in the <link linkend="elasticsearch2-option-elasticsearch2-java-keystore-filepath"><parameter>java-keystore-filepath</parameter></link> option.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-java-keystore-import.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para>This option is used only in HTTPS mode with basic authentication: <userinput>client-mode("https")</userinput> and <userinput>http-auth-type("clientcert")</userinput>, and is available in &abbrev; version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-java-truststore-filepath" condition="ose">
            <title>java-truststore-filepath()</title>
            <indexterm type="parameter"> <primary>java-truststore-filepath()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>java-truststore-filepath</secondary> </indexterm>
            <indexterm> <primary>authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <indexterm> <primary>certificate authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Path to the Java keystore file that stores the CA certificate that &abbrev; uses to verify the certificate of the Elasticsearch server. You must also set the <link linkend="elasticsearch2-option-elasticsearch2-java-truststore-password"><parameter>java-truststore-password</parameter></link> option.</para>
            <para>If you do not set the <parameter>java-truststore-filepath</parameter> option, &abbrev; does accepts any certificate that the Elasticsearch server shows. In this case, the identity of the server is not verified, only the connection is encrypted.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-java-keystore-import.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para>This option is used only in HTTPS mode: <userinput>client-mode("https")</userinput>, and is available in &abbrev; version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-java-truststore-password" condition="ose">
            <title>java-truststore-password()</title>
            <indexterm type="parameter"> <primary>java-truststore-password()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>java-truststore-password</secondary> </indexterm>
            <indexterm> <primary>authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <indexterm> <primary>certificate authentication</primary> <secondary>Elasticsearch</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The password of the Java truststore file set in the <link linkend="elasticsearch2-option-elasticsearch2-java-truststore-filepath"><parameter>java-truststore-filepath</parameter></link> option.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-java-keystore-import.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para>This option is used only in HTTPS mode: <userinput>client-mode("https")</userinput>, and is available in &abbrev; version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</para>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <xi:include href="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch-2-destination-jvm-options">
            <xi:include href="../../shared/chunk/option-destination-jvm-options.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-log-fifo-size.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-on-error.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-port">
            <title>port()</title>
            <indexterm type="parameter"> <primary>port()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>port</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>9300</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The port number of the Elasticsearch server. This option is used only in transport mode: <userinput>client-mode("transport")</userinput></para>
        </simplesect>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-retries.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-resource">
            <title>resource()</title>
            <indexterm type="parameter"> <primary>resource()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>resource</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The list of Elasticsearch resources to load, separated by semicolons. For example, <userinput>resource("/home/user/elasticsearch/elasticsearch.yml;/home/user/elasticsearch/elasticsearch2.yml")</userinput>.</para>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-server">
            <title>server()</title>
            <indexterm type="parameter"> <primary>server()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>server</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>list of hostnames</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>127.0.0.1</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> Specifies the hostname or IP address of the Elasticsearch server. When specifying an IP address, IPv4 (for example, <userinput>192.168.0.1</userinput>) or IPv6 (for example, <userinput>[::1]</userinput>) can be used as well. When specifying multiple addresses, use space to separate the addresses, for example, <userinput>server("127.0.0.1 remote-server-hostname1 remote-server-hostname2")</userinput></para>
            <para>This option is used only in transport mode: <userinput>client-mode("transport")</userinput></para>
            <xi:include href="../../shared/chunk/para-elasticsearch-loadbalancing.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <para>For example:</para>
            <synopsis>destination d_elasticsearch {
  elasticsearch2(
    client-lib-dir("/usr/share/elasticsearch/lib/")
    index("syslog-${YEAR}.${MONTH}.${DAY}")
    type("syslog")
    time-zone("UTC")
    client-mode("http")
    server("node01 node02")
    port(9200)
  );
};</synopsis>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-skip-cluster-health-check">
            <title>skip-cluster-health-check()</title>
            <indexterm type="parameter"> <primary>skip-cluster-health-check()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>skip-cluster-health-check</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>yes|no</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>no</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> By default, when connecting to an Elasticsearch cluster, &abbrev; checks the state of the cluster. If the primary shards of the cluster are not active, &abbrev; will not send messages, but wait for them to become active. To disable this health check and send the messages to Elasticsearch anyway, use the <userinput>skip-cluster-health-check(yes)</userinput> option in your configuration.</para>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-template">
            <title>template()</title>
            <indexterm type="parameter"> <primary>template()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>template</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>template or template function</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>$(format-json --scope rfc5424 --exclude DATE --key ISODATE @timestamp=${ISODATE})</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The message as sent to the Elasticsearch server. Typically, you will want to use the command-line notation of the <userinput>format-json</userinput> template function.</para>
            <para>To add a <userinput>@timestamp</userinput> field to the message, for example, to use with Kibana, include the <userinput>@timestamp=${ISODATE}</userinput> expression in the template. For example: <userinput>template($(format-json --scope rfc5424 --exclude DATE --key ISODATE @timestamp=${ISODATE}))</userinput></para>
            <para>For details on formatting messages in JSON format, see <xref linkend="template-function-format-json"/>.</para>
        </simplesect>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-throttle.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-timezone.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            <xi:include href="../../shared/chunk/option-destination-elasticsearch-timezone.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect>
            <xi:include href="../../shared/chunk/option-destination-ts-format.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect xml:id="elasticsearch2-option-elasticsearch2-type">
            <title>type()</title>
            <indexterm type="parameter"> <primary>type()</primary> <secondary>elasticsearch2</secondary> </indexterm>
            <indexterm type="parameter"> <primary>elasticsearch2</primary> <secondary>type</secondary> </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                    <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:</entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:</entry>
                            <entry>N/A</entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
            <para><emphasis role="bold">Description:</emphasis> The type of the index. For example, <userinput>type("test")</userinput>.</para>
        </simplesect>
    </section>
    <xi:include href="../../shared/chunk/topic-elasticsearch2-practical-examples.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
</section>
