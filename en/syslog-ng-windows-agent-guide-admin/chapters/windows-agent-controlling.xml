<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
<!ENTITY % entities SYSTEM "../../shared/syslog-ng-entities.ent">
  %entities;]>
<chapter xml:id="windows-service" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title>Controlling the &agentabbrev; services</title>
    <para>During installation, &agentabbrev; registers the <parameter>syslog-ng Agent</parameter> service that is started automatically when the host boots. To disable the automatic startup of the &agentabbrev; use the <guimenu>Start Menu > Control Panel > Administrative Tools > Services</guimenu> interface. The service is running with the privileges of the <parameter>NT AUTHORITY\SYSTEM</parameter> user.</para>
    <para>To manually start or stop the service use the <guimenu>Start Menu > Control Panel > Administrative Tools > Services</guimenu> interface, or navigate to <guimenu>Start Menu > Programs > &agent;</guimenu>. Note that in the latter case if User Access Control (UAC) is enabled, you need the <parameter>Run as Administrator</parameter> privilege to start or stop the &agentabbrev;.</para>
    <para>When the &agentabbrev; service is started or stopped, it sends a syslog message to the central log server and an eventlog message to the Application eventlog container of the host.</para>
    <warning>
        <indexterm>
            <primary>timezone</primary>
            <secondary>Windows</secondary>
        </indexterm>
        <indexterm>
            <primary>&agentabbrev;</primary>
            <secondary>timezone</secondary>
        </indexterm>
        <para>If you change the timezone setting of the host while the &agentabbrev; is running, you have to restart the &agentabbrev;. Otherwise, it will not receive the updated timezone information and the date of the events will be incorrect.</para>
    </warning>
    <note>
        <para>It is possible to run the service with an administrator account that has "log on as service" rights (to set user rights, navigate to <guimenu>Local Security Policy > Local Policies > User rights Assignment</guimenu>). These settings are unsupported, use them only at your own risk. Also note that during the next upgrade procedure, these settings will be overwritten by factory default settings.</para>
    </note>
    <section xml:id="windows-command-line">
        <title>Command-line options</title>
        <para>The &agent; application has the following command-line options:</para>
        <note>
            <para>Command-line options are case-insensitive. The options consist of a single letter introduced by either "<parameter>-</parameter>" or "<parameter>/</parameter>".</para>
        </note>
        <note>
            <para>On Windows Vista or above, command line options will only work with administrator permission.</para>
        </note>
        <variablelist>
            <varlistentry>
                <term><command>/c</command>
                </term>
                <listitem>
                    <para>Start the &agentabbrev; using the specified XML configuration file.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><command>/d</command>
                </term>
                <listitem>
                    <para>Start the &agentabbrev; in debug mode.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><command>/h</command>
                </term>
                <listitem>
                    <para>Display a help message about the command-line options.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><command>/i</command>
                </term>
                <listitem>
                    <para>Install the &agentabbrev; service into the services list.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><command>/r</command>
                </term>
                <listitem>
                    <para>Remove the &agentabbrev; service from the services list.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><command>/v</command>
                </term>
                <listitem>
                    <para>Display version information.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><command>/x</command>
                </term>
                <listitem>
                    <para>Validate XML configuration file without importing it.</para>
                </listitem>
            </varlistentry>
        </variablelist>
        <para>To use these options, select <guimenu>Start > Run > cmd</guimenu>, navigate to the directory where the &agentabbrev; is installed (for example <command>cd C:\Windows\Program Files\BalaBit\syslog-ng Agent\</command>), and execute the <command>syslog-ng-agent.exe</command> file with the required option.</para>
        <example xml:id="example-using-commandline">
            <title>Using command line options</title>
            <para>To start &agentabbrev; in debug mode:</para>
            <synopsis>syslog-ng-agent.exe /d</synopsis>
            <para>To start &agentabbrev; with XML configuration file:</para>
            <synopsis>syslog-ng-agent.exe /c C:\ConfigFiles\syslog-ng-agent-conf.xml </synopsis>
            <para>To register &agentabbrev; as a service using XML configuration file:</para>
            <synopsis>syslog-ng-agent.exe /i C:\ConfigFiles\syslog-ng-agent-conf.xml</synopsis>
        </example>
    </section>
</chapter>
