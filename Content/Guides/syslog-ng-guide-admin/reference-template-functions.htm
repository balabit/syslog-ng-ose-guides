<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <meta name="description" content="" />
    </head>
    <body name="reference-template-functions">
        <h1 name="reference-template-functions">Template functions of <MadCap:variable name="General.abbrev"></MadCap:variable></h1>
        <p>The following template functions are available in <MadCap:variable name="General.abbrev"></MadCap:variable>.</p>
        <div>
            <h6 name="template-function-base64-encode"><a name="template-function-base64-encode"></a>base64-encode</h6>
            <MadCap:keyword term="base64-encode">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(base64-encode argument)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> You can use the <span class="Code">base64-encode</span> template function to <a href="https://tools.ietf.org/html/rfc4648">base64-encode</a> strings and macros. The template function can receive multiple parameters (maximum 64). In this case, <MadCap:variable name="General.abbrev"></MadCap:variable> joins the parameters into a single string and encodes this string. For example, <span class="Code">$(base64-encode string1 string2)</span> is equivalent to <span class="Code">$(base64-encode string1string2)</span>.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.18</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.11</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-basename"><a name="template-function-basename"></a>basename</h6>
            <MadCap:keyword term="basename">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(basename argument)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns the filename from an argument (for example, a macro: <span class="Code">$(basename ${FILE_NAME})</span>) that contains a filename with a path. For example, <span class="Code">$(basename "/var/log/messages.log")</span> returns <span class="Code">messages.log</span>. To <a href="reference-template-functions.htm">extract the path, use the <b class="Code">dirname</b> template function</a>.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.10</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.3</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-ceil"><a name="template-function-ceil"></a>ceil</h6>
            <MadCap:keyword term="ceil">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(ceil argument)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Rounds a floating-point number upwards to the nearest integer. For example, <span class="Code">$(ceil 1.5)</span> is 2, <span class="Code">$(ceil -1.5)</span> is -1. See also the <span class="Code">floor</span> and <span class="Code">round</span> template functions.</p>
        </div>
        <div MadCap:conditions="General.OSE">
            <h6 name="template-function-context-lookup"><a name="template-function-context-lookup"></a>context-lookup</h6>
            <MadCap:keyword term="context-lookup">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(context-lookup [option] condition value-to-select)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> The <span class="Code">context-lookup</span> template function can search a message context when correlating messages (for example, when you use a <a href="patterndb-correlation.htm">pattern database</a> or the <a href="grouping-by-parser.htm">grouping-by parser</a>). The <span class="Code">context-lookup</span> template function requires a condition (a filter or a string), and returns a specific macro or template of the matching messages (for example, the ${MESSAGE}) as a list. It works similarly to the <a href="reference-template-functions.htm"><span class="Code">$(grep)</span></a> template function, but it escapes its output properly, so that the returned value is a list that can be processed with other template functions that work on lists, for example, <span class="Code">$(list-slice)</span>.</p>
            <div class="Example">
                <h6>Example: Using the context-lookup template function</h6>
                <p>The following example selects the message of the context that has a <span class="Code">username</span> name-value pair with the <span class="Code">root</span> value, and returns the value of the <span class="Code">tags</span> name-value pair.</p><pre>$(context-lookup ("${username}" == "root") ${tags})</pre>
            </div>
            <p>To limit the number of matches that the template function returns, use the <b class="Code">--max-count</b> option, for example, <b class="Code">$(context-lookup --max-count 5 ("${username}" == "root") ${tags})</b>. If you do not want to limit the number of matches, use <b class="Code">--max-count 0</b>.</p>
            <p>You can to specify multiple name-value pairs as parameters, separated with commas. If multiple messages match the condition of <span class="Code">context-lookup</span>, these will be returned also separated by commas. This can be used for example, to collect the email recipients from postfix messages.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.10</MadCap:conditionaltext> and later.</p>
        </div>
        <div MadCap:conditions="General.OSE">
            <h6 name="template-function-context-values"><a name="template-function-context-values"></a>context-values</h6>
            <MadCap:keyword term="context-values">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(context-values $name-value1 $name-value2 ...)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> The <span class="Code">context-values</span> template function returns a list of every occurrence of the specified name-value pairs from the entire context. For example, if the context contains multiple messages, the <span class="Code">$(context-values ${HOST})</span> template function will return a comma-separated list of the <span class="Code">${HOST}</span> values that appear in the context.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.10</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-dirname"><a name="template-function-dirname"></a>dirname</h6>
            <MadCap:keyword term="dirname">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(dirname argument)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns the path (without the filename) from an argument (for example, a macro: <span class="Code">$(basename ${FILE_NAME}</span>) that contains a filename with a path. For example, <span class="Code">$(dirname "/var/log/messages.log")</span> returns <span class="Code">/var/log</span> path. To <a href="reference-template-functions.htm">extract the filename, use the <b class="Code">basename</b> template function</a>.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.10</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.3</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-echo"><a name="template-function-echo"></a>echo</h6>
            <MadCap:keyword term="echo">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(echo argument)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns the value of its argument. Using <span class="Code">$(echo ${HOST})</span> is equivalent to <span class="Code">${HOST}</span>.</p>
        </div>
        <div>
            <h6 name="template-function-env"><a name="template-function-env"></a>env</h6>
            <MadCap:keyword term="env">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(env &lt;environment-variable&gt;)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns the value of the specified environment variable. Available in <MadCap:variable name="General.abbrev"></MadCap:variable><MadCap:conditionaltext MadCap:conditions="General.OSE">3.5</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-explode"><a name="template-function-explode"></a>explode</h6>
            <MadCap:keyword term="explode">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(explode &lt;separator&gt; &lt;string1&gt; &lt;string2&gt; ...)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Turns a string separated by a specific character into a list.  You can also use the   <MadCap:xref href="#template-function-implode" class="HeadingOnPage"><span style="color: #04aada;" class="mcFormatColor">implode</span></MadCap:xref> template function, which turns a list into a string combining the pieces together with a separator. Available in <MadCap:variable name="General.abbrev" /><MadCap:conditionaltext MadCap:conditions="General.OSE">3.21</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7</MadCap:conditionaltext> and later.</p>
            <div class="Example">
                <h6>Example: Using the explode template function</h6>
                <p>The following configuration example turns strings into a list. If there are several strings, <MadCap:variable name="General.abbrev" /> looks for a separator within each individual string. For example, <b class="UI">string 2</b> is separated as <b class="UI">string, 2</b> in the example below:</p>
                <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');" class="TableStyle-RuledTableWithHeading_DoNotEdit" cellspacing="0">
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <tbody>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Configuration</th>
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Result</th>
                        </tr>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">$(explode ';' string1;string 2;string3;string4)</td>
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">"string1,string,2,string3,string4"</td>
                        </tr>
                    </tbody>
                </table>
                <p>Enclose the strings in double-quotes or apostrophes and <b class="UI">string 2</b> is separated as shown below:</p>
                <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');" class="TableStyle-RuledTableWithHeading_DoNotEdit" cellspacing="0">
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <tbody>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Configuration</th>
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Result</th>
                        </tr>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">$(explode ' ' 'string1 string 2 string3 string4 string5')</td>
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">"string1,string 2,string3,string4,string5"</td>
                        </tr>
                    </tbody>
                </table>
                <p>The following examples replace the separator <b>';'</b> character with a <b>','</b> character:</p>
                <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');" class="TableStyle-RuledTableWithHeading_DoNotEdit" cellspacing="0">
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <tbody>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Configuration</th>
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Result</th>
                        </tr>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1"><span class="Code">$(implode ',' $(explode ';' 'string1;string2;string3'))</span>
                            </td>
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">"string1,string2,string3"</td>
                        </tr>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">
                                <p class="TableHyphen"><span class="Code">$(explode ';' 'string1;string2;string3;string4;string5')</span>
                                </p>
                            </td>
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">
                                <p class="TableHyphen">"string1,string2,string3,string4,string5"</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div><a name="filter-template-function"></a>
            <h6>filter</h6>
            <MadCap:keyword term="filter" />
            <p><i style="font-style: normal;">Syntax:</i><pre>$(filter &lt;filter-expression&gt; &lt;list&gt;)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Runs the filter expression on each element of a given list, and returns only those list elements that meet the requirements of the filter expression. The current value is referred by <span class="Code">$_</span>, similarly to the <a href="#template-map"><span style="color: #04aada;" class="mcFormatColor"><span class="Code">map</span> template function</span></a>.</p>
            <div class="Note">
                <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> You can use macros, logical expressions, and template functions inside the expression.</p>
            </div>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version 3.30 and later.</p>
            <div class="Example">
                <h6>Example: using the filter template function in your configuration</h6>
                <p>When used in configuration as seen in the example, the <span class="Code">filter</span> template function filters even numbers from an input list of <span class="Code">0</span>, <span class="Code">1</span>, <span class="Code">2</span> and <span class="Code">3</span>:</p><pre>log {
  source { example-msg-generator(num(1) values(INPUT =&gt; "0,1,2,3")); };
  destination {
     file("/dev/stdout"
           template("<b>$(filter ('$(% $_ 2)' eq '0') $INPUT)\n)"</b>)
     );
  };
};
</pre>
                <p>The returned values are <span class="Code">0</span> and <span class="Code">2</span>.</p>
            </div>
            <p><i style="font-style: normal;">Parameters:</i>
            </p>
            <ul>
                <li>
                    <p><span class="Code">&lt;filter-expression&gt;</span>
                    </p>
                    <p>Mandatory parameter.</p>
                    <p>The <span class="Code">&lt;filter-expression&gt;</span> parameter can be:</p>
                    <ul>
                        <li>
                            <p>a comparison</p>
                        </li>
                        <li>
                            <p>a filter</p>
                        </li>
                        <li>
                            <p>a logical expression built from filters (using <span class="Code">and</span>, <span class="Code">or</span>, and <span class="Code">not</span>)</p>
                        </li>
                    </ul>
                    <div class="Note">
                        <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> When using the <span class="Code">&lt;filter-expression&gt;</span> parameter, you can refer other template functions, or use macros.</p>
                    </div>
                    <div class="Note">
                        <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> To refer to the variable bound to the current element of the list, use <span class="Code">$_ macro</span>.</p>
                    </div>
                    <div class="Example">
                        <h6>Examples for &lt;filter-expression&gt;</h6>
                        <p>The following examples illustrate several ways that you can use a single filter, or a logical expression built from several filters.</p><pre>('1' == '1')
('$_' le '1')
('$(% $_ 2)' eq '0')
('$_' le '1') and ('$(% $_ 2)' eq '0')
</pre>
                    </div>
                </li>
                <li>
                    <p><span class="Code">list</span>
                    </p>
                    <p>Mandatory parameter. A <MadCap:variable name="General.abbrev" /> list.</p>
                </li>
            </ul>
        </div>
        <div>
            <h6 name="template-function-format-cef-extension"><a name="template-function-format-cef-extension"></a>format-cef-extension</h6>
            <MadCap:keyword term="format-cef-extension()">
            </MadCap:keyword>
            <MadCap:keyword term="CEF">
            </MadCap:keyword>
            <MadCap:keyword term="ArcSight Common Event Format">
            </MadCap:keyword>
            <p><MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.PE">5 F6</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.OSE">3.8</MadCap:conditionaltext> includes a new template function (<span class="Code">format-cef-extension</span>) to format name-value pairs as ArcSight Common Event Format extensions. Note that the template function only formats the selected name-value pairs, it does not provide any mapping. There is no special support for creating the prefix part of a Common Event Format (CEF) message. Note that the order of the elements is random. For details on the CEF extension escaping rules format, see the <a href="https://kc.mcafee.com/resources/sites/MCAFEE/content/live/CORP_KNOWLEDGEBASE/78000/KB78712/en_US/CEF_White_Paper_20100722.pdf">ArcSight Common Event Format</a>.</p>
            <p>You can use the <a href="concepts-value-pairs.htm">value-pairs</a> that <MadCap:variable name="General.abbrev"></MadCap:variable> stores about the log message as CEF fields. Using value-pairs, you can:</p>
            <ul>
                <li>
                    <p>select which value-pairs to use as CEF fields,</p>
                </li>
                <li>
                    <p>add custom value-pairs as CEF fields,</p>
                </li>
                <li>
                    <p>rename value-pairs, and so on.</p>
                </li>
            </ul>
            <p>For details, see <MadCap:xref href="concepts-value-pairs.htm"><span style="color: #04aada;" class="mcFormatColor">Structuring macros, metadata, and other value-pairs</span></MadCap:xref>. Note that the syntax of <span class="Code">format-*</span> template functions is different from the syntax of <span class="Code">value-pairs()</span>: these template functions use a syntax similar to command lines.</p>
            <p>Using the <span class="Code">format-cef-extension</span> template function has the following prerequisites:</p>
            <ul>
                <li>
                    <p>Set the <span class="Code">on-error</span> global option to <b class="Code">drop-property</b>, otherwise if the name of a name-value pair includes an invalid character, <MadCap:variable name="General.abbrev"></MadCap:variable> drops the entire message. (Key name in CEF extensions can contain only the A-Z, a-z and 0-9 characters.)</p><pre>options {
   on-error("drop-property");
};</pre>
                </li>
                <li>
                    <p>The log messages must be encoded in UTF-8. Use the <b class="Code">encoding()</b> option or the <b class="Code">validate-utf8</b> flag in the message source.</p>
                </li>
            </ul>
            <div class="Example">
                <h6>Example: Using the format-cef-extension template function</h6>
                <p>The following example selects every available information about the log message, except for the date-related macros (<span class="Code">R_*</span> and <span class="Code">S_*</span>), selects the <span class="Code">.SDATA.meta.sequenceId</span> macro, and defines a new value-pair called <span class="Code">MSGHDR</span> that contains the program name and PID of the application that sent the log message (since you will use the template-function in a template, you must escape the double-quotes).</p><pre>$(format-cef-extension --scope syslog,all_macros,selected_macros \
  --exclude R_* --exclude S_* --key .SDATA.meta.sequenceId \
  --pair MSGHDR=\"$PROGRAM[$PID]: \")</pre>
                <p>The following example selects every value-pair that has a name beginning with <span class="Code">.cef.</span>, but removes the <span class="Code">.cef.</span> prefix from the key names.</p><pre>template("$(format-cef-extension --subkeys .cef.)\n")</pre>
                <p>The following example shows how to use this template function to store log messages in CEF format:</p><pre>destination d_cef_extension {
    file("/var/log/messages.cef" template("${ISODATE} ${HOST} $(format-cef-extension --scope selected_macros --scope nv_pairs)\n"));
};</pre>
            </div>
        </div>
        <div>
            <h6 name="template-function-format-cim"><a name="template-function-format-cim"></a>format-cim</h6>
            <MadCap:keyword term="format-cim">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(format-cim)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Formats the message into <a href="http://docs.splunk.com/Documentation/CIM/latest/User/Overview">Splunk Common Information Model (CIM) format</a>. Applications that can receive messages in CIM format include Kibana, logstash, and Splunk. Applications that can be configured to log into CIM format include nflog and the Suricata IDS engine.</p><pre>destination d_cim {
    network(
        "192.168.1.1"
        template("$(format-cim)\n")
    );
};</pre>
            <p>You can find the exact source of this template function in the <a href="https://github.com/syslog-ng/syslog-ng/blob/master/scl/cim/template.conf"><MadCap:variable name="General.abbrev"></MadCap:variable> GitHub repository</a>.</p>
            <div class="Note">
                <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> 
				To use the <span class="Code">format-cim()</span> template function, <MadCap:variable name="General.abbrev"></MadCap:variable> must be compiled with JSON support. For details, see <MadCap:xref href="syslog-ng-compile-options.htm"><span style="color: #04aada;" class="mcFormatColor">Compiling options of [%=General.OSE%]</span></MadCap:xref>. To see if your <MadCap:variable name="General.abbrev"></MadCap:variable> binary was compiled with JSON support, execute the <b class="Code">syslog-ng --version</b> command.</p>
            </div>
        </div>
        <div>
            <h6 name="template-function-format-ewmm"><a name="template-function-format-ewmm"></a>format-ewmm</h6>
            <MadCap:keyword term="format-ewmm">
            </MadCap:keyword>
            <MadCap:keyword term="EWMM">
            </MadCap:keyword>
            <MadCap:keyword term="Enterprise-wide message model">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(format-ewmm)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> The <span class="Code">format-ewmm</span> template function converts the message into the <a href="syslog-ng-message-format.htm">Enterprise-wide message model (EWMM) format</a>. Available in version <MadCap:conditionaltext MadCap:conditions="General.PE">7.0.9</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.OSE">3.16</MadCap:conditionaltext> and later.</p>
            <MadCap:snippetBlock src="../shared/chunk/example-ewmm-message-format.flsnp">
            </MadCap:snippetBlock>
        </div>
        <div>
            <h6 name="template-function-format-flat-json"><a name="template-function-format-flat-json"></a>format-flat-json</h6>
            <MadCap:keyword term="format-json">
            </MadCap:keyword>
            <MadCap:keyword term="format-flat-json">
            </MadCap:keyword>
            <MadCap:keyword term="JSON">
            </MadCap:keyword>
            <MadCap:keyword term="flatten JSON">
            </MadCap:keyword>
            <MadCap:keyword term="nested JSON">
            </MadCap:keyword>
            <MadCap:keyword term="JavaScript Object Notation">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(format-flat-json parameters)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> The <span class="Code">format-flat-json</span> template function is identical to the <span class="Code">format-json</span> template function, but nested JSON objects are flattened in the output. If you have to forward your log messages in JSON format, but the receiving application cannot handle nested JSON objects, use the <b class="Code">format-flat-json</b> template function.</p>
            <div class="Example">
                <h6>Example: Flattened JSON output</h6>
                <p>The following example shows the difference between nested and flattened JSON objects.</p>
                <ul>
                    <li>
                        <p>The output of <span class="Code">$(format-json a.b.c=1)</span> is a nested JSON object (whitespace added for better readability):</p><pre>{
    "a": {
        "b": {
        "c": "1"
        }
    }
}</pre>
                    </li>
                    <li>
                        <p>The output of <span class="Code">$(format-flat-json a.b.c=1)</span> is a flattened JSON object (whitespace added for better readability):</p><pre>{
    "a.b.c": "1"
}</pre>
                    </li>
                </ul>
            </div>
            <p>For details on formatting log messages into JSON format, see <a href="#template-function-format-json"></a>.</p>
        </div>
        <div>
            <h6 name="template-function-format-gelf"><a name="template-function-format-gelf"></a>format-gelf</h6>
            <MadCap:keyword term="format-gelf">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(format-gelf)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Available in <MadCap:variable name="General.abbrev"></MadCap:variable><MadCap:conditionaltext MadCap:conditions="General.OSE">3.13</MadCap:conditionaltext> and later.</p>
            <p>You can use the Graylog Extended Log Format (GELF) template together with the <span class="Code">graylog2()</span> destination to send syslog messages to <a href="http://docs.graylog.org">Graylog</a>. GELF is the native data format of Graylog.</p>
            <div class="Example">
                <h6>Example: Using the format-gelf template function</h6>
                <p>The following configuration example shows how you can use the <span class="Code">format-gelf</span> template:</p><pre>destination graylog2 {
    network(
        "127.0.0.1"
        port(12201)
        transport(tcp)
        template("$(format-gelf)")
    );
};</pre>
            </div>
        </div>
        <div>
            <h6 name="template-function-format-json"><a name="template-function-format-json"></a>format-json</h6>
            <MadCap:keyword term="format-json">
            </MadCap:keyword>
            <MadCap:keyword term="JSON">
            </MadCap:keyword>
            <MadCap:keyword term="JavaScript Object Notation">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(format-json parameters)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> The <span class="Code">format-json</span> template function receives value-pairs as parameters and converts them into JavaScript Object Notation (JSON) format. Including the template function in a message template allows you to store selected information about a log message (that is, its content, macros, or other metadata) in JSON format. Note that the input log message does not have to be in JSON format to use <span class="Code">format-json</span>, you can reformat any incoming message as JSON.</p>
            <p>You can use the <a href="concepts-value-pairs.htm">value-pairs</a> that <MadCap:variable name="General.abbrev"></MadCap:variable> stores about the log message as JSON fields. Using value-pairs, you can:</p>
            <ul>
                <li>
                    <p>select which value-pairs to use as JSON fields,</p>
                </li>
                <li>
                    <p>add custom value-pairs as JSON fields,</p>
                </li>
                <li>
                    <p>rename value-pairs, and so on.</p>
                </li>
            </ul>
            <p>For details, see <MadCap:xref href="concepts-value-pairs.htm"><span style="color: #04aada;" class="mcFormatColor">Structuring macros, metadata, and other value-pairs</span></MadCap:xref>. Note that the syntax of <span class="Code">format-json</span> is different from the syntax of <span class="Code">value-pairs()</span>: <span class="Code">format-json</span> uses a syntax similar to command lines.</p>
            <MadCap:snippetBlock src="../shared/wnt/note-typehinting.htm">
            </MadCap:snippetBlock>
            <div class="Example">
                <h6>Example: Using the format-json template function</h6>
                <p>The following example selects every available information about the log message, except for the date-related macros (<span class="Code">R_*</span> and <span class="Code">S_*</span>), selects the <span class="Code">.SDATA.meta.sequenceId</span> macro, and defines a new value-pair called <span class="Code">MSGHDR</span> that contains the program name and PID of the application that sent the log message (since you will use the template-function in a template, you must escape the double-quotes).</p><pre>$(format-json --scope syslog,all_macros,selected_macros \
  --exclude R_* --exclude S_* --key .SDATA.meta.sequenceId \
  --pair MSGHDR=\"$PROGRAM[$PID]: \")</pre>
                <p>The following example shows how to use this template function to store log messages in JSON format:</p><pre>destination d_json {
    file(
        "/var/log/messages.json"
        template("$(format-json --scope selected_macros --scope nv_pairs)\n")
    );
};</pre>
            </div>
            <div class="Note">
                <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> 
				In the case of syslog-ng macros starting with a dot (for example, "<span class="Code">.SDATA.meta.sequenceID</span>"), <span class="Code">format-json</span> replaces the dot with an underscore character (for example, <span class="Code">{"_SDATA":{"meta":{"sequenceId":"55555"}}}</span>).</p>
                <p>To retain the starting dot, use the <b class="Code">--leave-initial-dot</b> flag, for example:</p><pre>$(format-json --leave-initial-dot .SDATA.meta.sequenceID)
            </pre>
            </div>
            <p>If you have to forward your log messages in JSON format, but the receiving application cannot handle nested JSON objects, use the <b class="Code">format-flat-json</b> template function. For details, see <MadCap:xref href="#template-function-format-flat-json" />.</p>
        </div>
        <div>
            <h6 name="template-function-format-welf"><a name="template-function-format-welf"></a>format-welf</h6>
            <MadCap:keyword term="format-welf()">
            </MadCap:keyword>
            <MadCap:keyword term="WELF">
            </MadCap:keyword>
            <MadCap:keyword term="WebTrends Enhanced Log file Format">
            </MadCap:keyword>
            <p>This template function converts value-pairs into the WebTrends Enhanced Log file Format (WELF). The WELF format is a comma-separated list of <span class="Code">name=value</span> elements. Note that the order of the elements is random. If the value contains whitespace, it is enclosed in double-quotes, for example, <span class="Code">name="value"</span>. For details on the WELF format, see <a href="https://www3.trustwave.com/support/kb/article.aspx?id=10899">https://www3.trustwave.com/support/kb/article.aspx?id=10899</a>.</p>
            <p>To select which value-pairs to convert, use the command-line syntax of the <span class="Code">value-pairs()</span> option. For details on selecting value-pairs, see <MadCap:xref href="../shared/chunk/option-value-pairs.htm"><span style="color: #04aada;" class="mcFormatColor">value-pairs()</span></MadCap:xref>.</p>
            <div class="Example">
                <h6>Example: Using the format-welf() template function</h6>
                <p>The following example selects every available information about the log message, except for the date-related macros (<span class="Code">R_*</span> and <span class="Code">S_*</span>), selects the <span class="Code">.SDATA.meta.sequenceId</span> macro, and defines a new value-pair called <span class="Code">MSGHDR</span> that contains the program name and PID of the application that sent the log message (since you will use the template-function in a template, you must escape the double-quotes).</p><pre>$(format-welf --scope syslog,all_macros,selected_macros \
  --exclude R_* --exclude S_* --key .SDATA.meta.sequenceId \
  --pair MSGHDR=\"$PROGRAM[$PID]: \")</pre>
                <p>The following example shows how to use this template function to store log messages in WELF format:</p><pre>destination d_welf {
    file(
        "/var/log/messages.welf"
        template("$(format-welf --scope selected_macros --scope nv_pairs)\n")
    );
};</pre>
            </div>
        </div>
        <div MadCap:conditions="General.OSE">
            <h6 name="template-function-geoip"><a name="template-function-geoip"></a>geoip (DEPRECATED)</h6>
            <MadCap:keyword term="geoip">
            </MadCap:keyword>
            <p>This template function is deprecated. Use <MadCap:xref href="#template-function-geoip2"><span style="color: #04aada;" class="mcFormatColor">geoip2</span></MadCap:xref> instead.</p>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(geoip &lt;IPv4-address&gt;)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This template function returns the 2-letter country code of any IPv4 address or host. IPv6 addresses are not supported. Currently only the 2-letter codes are supported, and only from the default database. For example, <span class="Code">$(geoip $HOST)</span></p>
            <div class="Note">
                <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> 
				This template function is available only if <MadCap:variable name="General.abbrev"></MadCap:variable> has been compiled with the <span class="Code">--enable-geoip</span> compiling option.</p>
            </div>
            <p>To retrieve additional GeoIP information, see <MadCap:xref href="geoip-parser.htm"><span style="color: #04aada;" class="mcFormatColor">Looking up GeoIP data from IP addresses (DEPRECATED)</span></MadCap:xref>.</p>
        </div>
        <div MadCap:conditions="General.OSE">
            <h6 name="template-function-geoip2"><a name="template-function-geoip2"></a>geoip2</h6>
            <MadCap:keyword term="geoip2">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(geoip2 --database &lt;path-to-geoip2-database-file&gt;
    [ --field "registered_country.names.ru" ] ${HOST})</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This template function extracts specific fields from the mmdb database using the <span class="Code">--field</span> parameter. If you omit this parameter, it returns the 2-letter country code of any IPv4/IPv6 address or host.</p>
            <div MadCap:conditions="General.OSE">
                <div class="Note">
                    <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> 
					This template function is available only if <MadCap:variable name="General.abbrev"></MadCap:variable> has been compiled with geoip2 support. To enable it, use the <b class="Code">--enable-geoip</b> compiling option.</p>
                </div>
            </div>
            <p>To retrieve additional GeoIP information, see <MadCap:xref href="geoip2-parser.htm"><span style="color: #04aada;" class="mcFormatColor">Looking up GeoIP2 data from IP addresses</span></MadCap:xref>.</p>
            <MadCap:snippetBlock src="../shared/chunk/option-parser-geoip.flsnp">
            </MadCap:snippetBlock>
        </div>
        <div>
            <h6 name="template-function-getent"><a name="template-function-getent"></a>getent</h6>
            <MadCap:keyword term="getent">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(getent)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Available in <MadCap:variable name="General.abbrev"></MadCap:variable><MadCap:conditionaltext MadCap:conditions="General.OSE">3.13</MadCap:conditionaltext> and later.</p>
            <p>You can use the <b class="Code">getent</b> template function to look up entries from the Name Service Switch libraries, such as, passwd, services, or protocols.</p>
            <p>The following databases are supported:</p>
            <ul>
                <li>
                    <p><i>passwd</i>
                    </p>
                    <p>Use this database to query data related to a user. Specify the user by either username or user ID. You can query the following data: username, user ID, group ID, GECOS field, home directory, or user shell.</p><pre>$(getent passwd testuser name)
$(getent passwd testuser uid)
$(getent passwd testuser gid)
$(getent passwd testuser gecos)
$(getent passwd testuser dir)
$(getent passwd testuser shell)</pre>
                    <p>or</p><pre>$(getent passwd 1000 name)
$(getent passwd 1000 uid)
$(getent passwd 1000 gid)
$(getent passwd 1000 gecos)
$(getent passwd 1000 dir)
$(getent passwd 1000 shell)</pre>
                    <p>The queried data is optional. When you do not query any data, the default behavior applies, which is as follows: user ID is returned for username, or username is returned for user ID.</p>
                    <ul>
                        <li>
                            <p>Username <span class="Code">$(getent passwd testuser)</span> returns user ID <span class="Code">1000</span>.</p>
                        </li>
                        <li>
                            <p>User ID <span class="Code">$(getent passwd 1000)</span> returns username <span class="Code">testuser</span>.</p>
                        </li>
                    </ul>
                </li>
                <li>
                    <p><i>group</i>
                    </p>
                    <p>Use this database to query group-related data. The group can be specified using either group ID or group name. You can query the following data: group name, group ID, and members.</p><pre>$(getent group adm name)
$(getent group adm gid)
$(getent group adm members)</pre>
                    <p>The queried data is optional. The default behavior is as follows: group ID is returned for group name, or group name is returned for user ID.</p>
                    <ul>
                        <li>
                            <p>Group name <span class="Code">$(getent group adm)</span> returns group ID <span class="Code">4</span>.</p>
                        </li>
                        <li>
                            <p>Group ID <span class="Code">$(getent group 4)</span> returns group name <span class="Code">adm</span>.</p>
                        </li>
                    </ul>
                </li>
                <li>
                    <p><i>protocols</i>
                    </p>
                    <p>Use this database to translate protocol name to protocol ID, or protocol ID to protocol string.</p><pre>$(getent protocols tcp)
$(getent protocols 6)</pre>
                </li>
                <li>
                    <p><i>services</i>
                    </p>
                    <p>Use this database to translate service name to service ID, or service ID to service name.</p><pre>$(getent services http)
$(getent services 80)</pre>
                </li>
            </ul>
        </div>
        <div>
            <h6 name="template-function-graphite"><a name="template-function-graphite"></a>graphite-output</h6>
            <MadCap:keyword term="graphite-output">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(graphite-output parameters)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Available in <MadCap:variable name="General.abbrev"></MadCap:variable><MadCap:conditionaltext MadCap:conditions="General.OSE">3.6</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0</MadCap:conditionaltext> and later<MadCap:conditionaltext MadCap:conditions="General.OSE"> (Originally appeared in the <MadCap:variable name="General.abbrev"></MadCap:variable> incubator for syslog-ng 3.5)</MadCap:conditionaltext>. This template function converts value-pairs from the incoming message to the Graphite plain text protocol format. It is ideal to use with the messages generated by the <a href="https://github.com/syslog-ng/syslog-ng-incubator/tree/master/modules/monitor-source/">monitor-source plugin</a> (currently available in the syslog-ng incubator project).</p>
            <p>For details on selecting value-pairs in <MadCap:variable name="General.abbrev"></MadCap:variable> and for possibilities to specify which information to convert to Graphite plain text protocol format, see <MadCap:xref href="concepts-value-pairs.htm"><span style="color: #04aada;" class="mcFormatColor">Structuring macros, metadata, and other value-pairs</span></MadCap:xref>. Note that the syntax of <span class="Code">graphite-output</span> is different from the syntax of <span class="Code">value-pairs()</span>: <span class="Code">graphite-output</span> uses a the command-line syntax used in the <a href="reference-template-functions.htm">format-json template function</a>.</p>
            <div class="Example">
                <h6>Example: Using the graphite-output template function</h6>
                <p>The following configuration example shows, how to send value-pairs with names starting with "<span class="Code">vmstat.</span>" to Graphite running on <span class="Code">localhost</span>, port <span class="Code">2003</span>:</p><pre>destination d_graphite {
    network( host("localhost") port(2003) template("$(graphite-output --key vmstat.*)"));
};</pre>
            </div>
        </div>
        <div>
            <h6 name="template-function-grep"><a name="template-function-grep"></a>grep</h6>
            <MadCap:keyword term="grep">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(grep condition value-to-select)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> The <span class="Code">grep</span> template function can search a message context when correlating messages (for example, when you use a <a href="patterndb-correlation.htm">pattern database</a> or the <a href="grouping-by-parser.htm">grouping-by parser</a>). The <span class="Code">context-lookup</span> template function requires a condition (a filter or a string), and returns a specific macro or template of the matching message (for example, the ${MESSAGE} field of the message).</p>
            <div class="Example">
                <MadCap:snippetBlock src="../shared/chunk/example-grep-template-function.flsnp">
                </MadCap:snippetBlock>
            </div>
            <p>You can to specify multiple name-value pairs as parameters, separated with commas. If multiple messages match the condition of <span class="Code">grep</span>, these will be returned also separated by commas. This can be used for example, to collect the email recipients from postfix messages.</p>
        </div>
        <div>
            <h6 name="template-function-hash"><a name="template-function-hash"></a>hash</h6>
            <MadCap:keyword term="tfhash">
            </MadCap:keyword>
            <MadCap:keyword term="$(hash)">
            </MadCap:keyword>
            <MadCap:keyword term="$(md5), $(md4)">
            </MadCap:keyword>
            <MadCap:keyword term="$(sha1), $(sha256), $(sha512)">
            </MadCap:keyword>
            <MadCap:keyword term="tfhash">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(&lt;method&gt; [opts] $arg1 $arg2 $arg3...)</pre>
            </p>
            <p><i style="font-style: normal;">Options:</i><pre>--length N, -l N</pre>Truncate the hash to the first N characters.</p>
            <p><i style="font-style: normal;">Description:</i> Calculates a hash of the string or macro received as argument using the specified hashing method. If you specify multiple arguments, effectively you receive the hash of the first argument salted with the subsequent arguments.</p>
            <p><span class="Code">&lt;method&gt;</span> can be one of md5, md4, sha1, sha256, sha512 and "hash", which is equivalent to md5. Macros are expected as arguments, and they are concatenated without the use of additional characters.</p>
            <p>The md4 <span class="Code">&lt;method&gt;</span> is deprecated.</p>
            <p>This template function can be used for anonymizing sensitive parts of the log message (for example, username) that were parsed out using PatternDB before storing or forwarding the message. This way, the ability of correlating messages along this value is retained.</p>
            <p>Also, using this template, quasi-unique IDs can be generated for data, using the <b class="Code">--length</b> option. This way, IDs will be shorter than a regular hash, but there is a very small possibility of them not being as unique as a non-truncated hash.</p>
            <div class="Note">
                <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> 
				These template functions are available only if <MadCap:conditionaltext MadCap:conditions="General.OSE"><MadCap:variable name="General.abbrev"></MadCap:variable> has been compiled with the <span class="Code">--enable-ssl</span> compile option and </MadCap:conditionaltext>the <span class="Code">tfhash</span> module has been loaded.</p>
                <MadCap:snippetBlock src="../shared/chunk/para-load-module.htm">
                </MadCap:snippetBlock>
            </div>
            <div class="Example">
                <h6 name="template-function-hash-example"><a name="template-function-hash-example"></a>Example: Using the $(hash) template function</h6>
                <p>The following example calculates the SHA1 hash of the hostname of the message:</p><pre>$(sha1 $HOST)</pre>
                <p>The following example calculates the SHA256 hash of the hostname, using the <b class="Code">salted</b> string to salt the result:</p><pre>$(sha1 $HOST salted)</pre>
                <p>To use shorter hashes, set the <b class="Code">--length</b>:</p><pre>$(sha1 --length 6 $HOST)</pre>
                <p>To replace the hostname with its hash, use a rewrite rule:</p><pre>rewrite r_rewrite_hostname{set("$(sha1 $HOST)", value("HOST"));};</pre>
            </div>
            <div class="Example">
                <MadCap:snippetBlock src="../shared/chunk/example-rewrite-hash.flsnp">
                </MadCap:snippetBlock>
            </div>
        </div>
        <div>
            <h6 name="template-function-if"><a name="template-function-if"></a>if</h6>
            <MadCap:keyword term="if">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(if (&lt;condition&gt;) &lt;true template&gt; &lt;false template&gt;)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns the value of the <span class="Code">&lt;true template&gt;</span> parameter if the <span class="Code">&lt;condition&gt;</span> is true. If the <span class="Code">&lt;condition&gt;</span> is false, the value of <span class="Code">&lt;false template&gt;</span> is returned.</p>
            <div class="Example">
                <h6>Example: Using pattern databases and the if template function</h6>
                <p>The following example returns <span class="Code">violation</span> if the <span class="Code">username</span> name-value pair of a message is <span class="Code">root</span>, and <span class="Code">system</span> otherwise.</p><pre>$(if ("${username}" == "root") "violation" "system")</pre>
                <p>This can be used to set the class of a message in pattern database rules based on the condition.</p><pre>&lt;value name="username"&gt;$(if ("${username}" == "root") "violation" "system")&lt;/value&gt;</pre>
                <MadCap:keyword term="template functions:['embedding']">
                </MadCap:keyword>
                <p>Since template functions can be embedded into each other, it is possible to use another template function as the template of the first one. For example, the following expression returns <span class="Code">root</span> if the username is <span class="Code">root</span>, <span class="Code">admin</span> if the username is <span class="Code">joe</span>, and <span class="Code">normal user</span> otherwise.</p><pre>&lt;value name="username"&gt;
    $(if ("${username}" == "root")
        "root"
        $(if ("${username}" == "joe") "admin" "normal user"))&lt;/value&gt;</pre>
            </div>
        </div>
        <div>
            <h6 name="template-function-implode"><a name="template-function-implode"></a>implode</h6>
            <MadCap:keyword term="implode">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(implode &lt;separator&gt; &lt;string1&gt;, &lt;string2&gt;, ...)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Turns a list into a string combining the pieces together with a separator. You can also use the <MadCap:xref href="#template-function-explode" class="HeadingOnPage"><span style="color: #04aada;" class="mcFormatColor">explode</span></MadCap:xref> template function, which turns a string separated by a specific character into a list. Available in <MadCap:variable name="General.abbrev" /><MadCap:conditionaltext MadCap:conditions="General.OSE">3.21</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7</MadCap:conditionaltext> and later.</p>
            <div class="Example">
                <h6>Example: Using the implode template function</h6>
                <p>The following configuration example shows how you can use the <span class="Code">implode</span> template to turn a list into a string:</p>
                <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');" class="TableStyle-RuledTableWithHeading_DoNotEdit" cellspacing="0">
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <tbody>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Configuration</th>
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Result</th>
                        </tr>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">$(implode ' ' 'string1,string2,string3,string4,string5')</td>
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">"string1 string2 string3 string4 string5"</td>
                        </tr>
                    </tbody>
                </table>
                <p>You can also use a <span>$(list-*)</span> template
function to further manipulate the list. The following example returns the first three elements of the list:</p>
                <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');" class="TableStyle-RuledTableWithHeading_DoNotEdit" cellspacing="0">
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" />
                    <tbody>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Configuration</th>
                            <th class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Result</th>
                        </tr>
                        <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">$(implode ' ' $(list-slice :3 string1,string2,string3,string4,string5))</td>
                            <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">"string1 string2 string3"</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div>
            <h6 name="template-function-indent-multi-line"><a name="template-function-indent-multi-line"></a>indent-multi-line</h6>
            <MadCap:keyword term="indent-multi-line">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(indent-multi-line parameter)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This template function makes it possible to write multi-line log messages into a file. The first line is written like a regular message, subsequent lines are indented with a tab, in compliance with RFC822.</p>
            <div class="Example">
                <h6>Example: Using the indent-multi-line template function</h6>
                <p>The following example writes multi-line messages into a text file.</p><pre>destination d_file {
    file (
        "/var/log/messages"
        template("${ISODATE} ${HOST} $(indent-multi-line ${MESSAGE})\n")
    );
};</pre>
            </div>
        </div>
        <div>
            <h6 name="template-function-ipv4-to-int"><a name="template-function-ipv4-to-int"></a>ipv4-to-int</h6>
            <MadCap:keyword term="ipv4-to-int">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(ipv4-to-int parameter)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Converts the specified IPv4 address to its numeric representation. The numerical value of an IPv4 address is calculated by treating the IP address as a 4-byte hexadecimal value. For example, the 192.168.1.1 address equals to: 192=C0, 168=A8, 1=01, 1=01, or C0A80101, which is 3232235777 in decimal representation.</p>
            <div class="Note">
                <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> This template function is available only if the <span class="Code">convertfuncs</span> module has been loaded.</p>
                <MadCap:snippetBlock src="../shared/chunk/para-load-module.htm">
                </MadCap:snippetBlock>
            </div>
        </div>
        <div MadCap:conditions="General.OSE">
            <h6 name="template-function-list"><a name="template-function-list"></a>List manipulation</h6>
            <p>The <span class="Code">list-*</span> template functions allow you to manipulate comma-separated lists. Such lists represent a simple array type in <MadCap:variable name="General.abbrev"></MadCap:variable>. Note the following about formatting lists:</p>
            <ul>
                <li>
                    <p>Values are separated by commas, for example, <span class="Code">"item1","item2","item3"</span>. The single-element list is an element without a comma.</p>
                </li>
                <li>
                    <p>You can use shell-like quotation to embed commas, for example, <span class="Code">"item1","ite\,m2","item3"</span>.</p>
                </li>
                <li>
                    <p>Empty values are skipped (except if they are quoted)</p>
                </li>
            </ul>
            <p>These template functions return a well-formed list, properly encoding and quoting all elements. If a template function returns a single element, all quotation is decoded and the value contains the literal value.</p>
            <p>Starting with <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.10</MadCap:conditionaltext>, the following list-related template functions are available. Certain functions allow you to reference an element using its number: note that the list index starts with zero, so the index of the first element is 0, the second element is 1, and so on.</p>
            <div><a name="template-function-list-append"></a>
                <h6 name="template-function-list-append">list-append
                </h6>
                <MadCap:keyword term="list-append">
                </MadCap:keyword>
                <p><i style="font-style: normal;">Syntax:</i><pre>$(list-append ${list} ${name-value-pair1} ${name-value-pair2} ... )</pre>
                </p>
                <p><i style="font-style: normal;">Description:</i> Returns a list and appends the values of the specified name-value pairs to the end of the list. You can also append elements to an empty list, for example, <span class="Code">$(list-append '' 'element-to-add')</span></p>
            </div>
            <div><a name="template-function-list-concat"></a>
                <h6 name="template-function-list-concat">list-concat
                </h6>
                <MadCap:keyword term="list-concat">
                </MadCap:keyword>
                <p><i style="font-style: normal;">Syntax:</i><pre>$(list-concat ${name-value-pair1} ${name-value-pair2} ... )</pre>The commas between the parameters are optional.</p>
                <p><i style="font-style: normal;">Description:</i> This template function creates (concatenates) a list of the values it receives as parameter. The values can be single values (for example, <span class="Code">${HOST}</span>) or lists.</p>
                <p>For example, the value of the <span class="Code">$(list-concat ${HOST}, ${PROGRAM}, ${PID})</span> is a comma-separated list.</p>
                <p>You can concatenate existing lists into a single list using:</p><pre>$(list-concat ${list1} ${list2})</pre>
            </div>
            <div><a name="template-function-list-count"></a>
                <h6 name="template-function-list-count">list-count
                </h6>
                <MadCap:keyword term="list-count">
                </MadCap:keyword>
                <p><i style="font-style: normal;">Syntax:</i><pre>$(list-count ${list} )</pre>
                </p>
                <p><i style="font-style: normal;">Description:</i> Returns the number of elements in the list.</p>
            </div>
            <div><a name="template-function-list-head"></a>
                <h6 name="template-function-list-head">list-head
                </h6>
                <MadCap:keyword term="list-head">
                </MadCap:keyword>
                <p><i style="font-style: normal;">Syntax:</i><pre>$(list-head ${list} )</pre>
                </p>
                <p><i style="font-style: normal;">Description:</i> Returns the first element of the list, unquoted.</p>
            </div>
            <div><a name="template-function-list-nth"></a>
                <h6 name="template-function-list-nth">list-nth
                </h6>
                <MadCap:keyword term="list-nth">
                </MadCap:keyword>
                <p><i style="font-style: normal;">Syntax:</i><pre>$(list-nth &lt;index-number&gt; ${list} )</pre>
                </p>
                <p><i style="font-style: normal;">Description:</i> Returns the nth element of the list, unquoted. Note that the list index starts with zero, so <span class="Code">(list-nth 1 ${list} )</span> returns the second element, and so on.</p>
            </div>
            <div><a name="template-function-list-search"></a>
                <h6 name="template-function-list-search">list-search
                </h6>
                <MadCap:keyword term="list-search">
                </MadCap:keyword>
                <p><i style="font-style: normal;">Syntax:</i><pre>$(list-search [OPTIONS] &lt;pattern&gt; ${list})</pre>
                </p>
                <p><i style="font-style: normal;">Description:</i> The <span class="Code">list-search</span> template function searches the elements of <span class="Code">${list}</span> starting at the specified <span class="Code">start_index</span>, then returns the index of the first match of <span class="Code">&lt;pattern&gt;</span> within <span class="Code">${list}</span>.</p>
                <div class="Note">
                    <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> Indexing is 0-based. If <span class="Code">&lt;pattern&gt;</span> is not found, the function returns an empty string.</p>
                </div>
                <p>Options:</p>
                <ul>
                    <li><span class="Code">--mode MODE</span>: Matching mode, with the following possible values: <span class="Code">literal</span> (default), <span class="Code">prefix</span>, <span class="Code">substring</span>, <span class="Code">glob</span>, <span class="Code">pcre</span></li>
                    <li><span class="Code">--start-index N</span>: Skips N elements in the <span class="Code">${list}</span></li>
                </ul>
            </div>
            <div><a name="template-function-list-slice"></a>
                <h6 name="template-function-list-slice">list-slice
                </h6>
                <MadCap:keyword term="list-slice">
                </MadCap:keyword>
                <p><i style="font-style: normal;">Syntax:</i><pre>$(list-slice &lt;from&gt;:&lt;to&gt; ${list} )</pre>
                </p>
                <p><i style="font-style: normal;">Description:</i> Returns the specified subset of the list. Note that the list index starts with zero, for example, <span class="Code">$(list-slice 1:2 ${list} )</span> returns the second and third element of the list, and so on.</p>
                <p>You can omit the from or to index if you want to start the subset from the beginning or end of the list, for example: <span class="Code">3:</span> returns the list starting with the 4th element, while <span class="Code">:3</span> returns the first four elements.</p>
                <p>Negative numbers select an element from the end of the list, for example, <span class="Code">-3:</span> returns the last three element of the list.</p>
            </div>
            <div><a name="template-function-list-tail"></a>
                <h6 name="template-function-list-tail">list-tail
                </h6>
                <MadCap:keyword term="list-tail">
                </MadCap:keyword>
                <p><i style="font-style: normal;">Syntax:</i><pre>$(list-tail ${list} )</pre>
                </p>
                <p><i style="font-style: normal;">Description:</i> Returns the list without the first element. For example, if the <span class="Code">${mylist}</span> list contains the <span class="Code">one, two, three</span> elements, then <span class="Code">$(list-tail ${mylist} )</span> returns <span class="Code">two, three</span>.</p>
            </div>
        </div>
        <div><a name="template-function-length"></a>
            <h6 name="template-function-length">length</h6>
            <MadCap:keyword term="length">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(length "&lt;macro&gt;")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns the length of the macro in characters, for example, the length of the message. For example, the following filter selects messages that are shorter than 16 characters:</p><pre>f_short {
    match ('-', value ("$(if ($(length "${MESSAGE}") &lt;= 16) "-" "+")"));
};</pre>
        </div>
        <div><a name="template-function-lowercase"></a>
            <h6 name="template-function-lowercase">lowercase</h6>
            <MadCap:keyword term="lowercase">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(lowercase "&lt;macro&gt;")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns the lowercase version of the specified string or macro. For example, the following example uses the lowercase version of the hostname in a directory name:</p><pre>destination d_file {
    file ("/var/log/${MONTH}/${DAY}/$(lowercase "${HOST}")/messages");
};</pre>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable><MadCap:conditionaltext MadCap:conditions="General.OSE">3.5</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0</MadCap:conditionaltext> and later.</p>
        </div>
        <div><a name="map-template-function"></a>
            <h6><a name="template-map"></a>map</h6>
            <MadCap:keyword term="map" />
            <p><i style="font-style: normal;">Syntax:</i><pre>$(map template list)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns with a list that contains the results of applying a template function for each elements of a list.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version 3.28 and later.</p>
            <p><i style="font-style: normal;">Parameters:</i>
            </p>
            <ul>
                <li>
                    <p><span class="Code">template</span>: Mandatory. This template function is applied for each elements of the list. Use <span class="Code">$_ macro</span> to refer to the current list element.</p>
                </li>
                <li>
                    <p><span class="Code">list</span>: Mandatory. A list, or template.</p>
                </li>
            </ul>
            <p><i style="font-style: normal;">Example:</i>
            </p>
            <p>When used in configuration as seen in the example, the <span class="Code">map</span> template function adds one to each element of a list:</p><pre>log {
  source { example-msg-<span style="color: #ff0000;">generator</span>(<span style="color: #ff0000;">num</span>(<span style="color: #a52a2a;">1</span>) <span style="color: #ff0000;">values</span>(LST =&gt; <span style="color: #32cd32;">"0,1,2"</span>)); };
  destination {
    <span style="color: #ff0000;">file</span>(<span style="color: #32cd32;">"/dev/stdout"</span><span style="color: #ff0000;">template</span>(<span style="color: #32cd32;">'$(map "$(+ 1 $_)" $LST)'</span>)
    );
  };
};</pre>
            <p>The returned values are <span class="Code">1</span>, <span class="Code">2</span>, and <span class="Code">3</span>.</p>
        </div>
        <div>
            <h6 name="template-function-numerical"><a name="template-function-numerical"></a>Numerical operations</h6>
            <MadCap:keyword term="numerical operations">
            </MadCap:keyword>
            <MadCap:keyword term="addition">
            </MadCap:keyword>
            <MadCap:keyword term="substraction">
            </MadCap:keyword>
            <MadCap:keyword term="multiplication">
            </MadCap:keyword>
            <MadCap:keyword term="division">
            </MadCap:keyword>
            <MadCap:keyword term="modulus">
            </MadCap:keyword>
            <MadCap:keyword term="average">
            </MadCap:keyword>
            <MadCap:keyword term="mean">
            </MadCap:keyword>
            <MadCap:keyword term="sum">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(&lt;operation&gt; "&lt;value1&gt;" "&lt;value2&gt;")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> These template functions allow you to manipulate numbers, that is, to perform addition (+), substraction (-), multiplication (*), division (/), and modulus (%). All of them require two numeric arguments. The result is <span class="Code">NaN</span> (Not-a-Number) if the parameters are not numbers, cannot be parsed, or if a division by zero would occur. For example, to add the value of two macros, use the following template function:</p><pre>$(+ "${&lt;MACRO1&gt;}" "${&lt;MACRO2&gt;}");</pre>
            <p>Starting with <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.22</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.15</MadCap:conditionaltext> and later, the numerical operators support floating-point values. They behave like the operators in the C programming language:</p>
            <ul>
                <li>
                    <p>If both operands are integers, they return an integer.</p>
                </li>
                <li>
                    <p>If any of the operands is a floating-point number, they return a floating-point result.</p>
                </li>
            </ul>
            <p>For example:</p><pre>$(/ 3 2) # Both operands are integers, so the result is 1
# One of the operands is a floating point number, so the result is also floating-point
$(/ 3.0 2) # = 1.500000
$(/ 3 2.0) # = 1.500000
$(/ 3.0 2.0) # = 1.500000</pre>
            <p>To round floating-point numbers, you can use the <span class="Code">ceil</span>, <span class="Code">floor</span>, and <span class="Code">round</span> template functions.</p>
            <MadCap:keyword term="correlating log messages">
            </MadCap:keyword>
            <MadCap:keyword term="message correlation">
            </MadCap:keyword>
            <p>When you are correlating messages and a name-value pair contains numerical values in the messages, you can calculate the lowest (min), highest (max), total (sum), and mean (average) values. These calculations process every message of the correlation context. For details on message correlation, see <MadCap:xref href="chapter-correlating-log-messages.htm"><span style="color: #04aada;" class="mcFormatColor">Correlating log messages</span></MadCap:xref>. For example, if the messages of the context have a <span class="Code">.myfields.load</span> name-value pair, you can find the highest load value using the following template function.</p><pre>$(max ${.myfields.load})</pre>
        </div>
        <div>
            <h6 name="template-function-or"><a name="template-function-or"></a>or</h6>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(or &lt;macro1&gt; &lt;macro2&gt;)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This template function returns the first non-empty argument.</p>
        </div>
        <div>
            <h6 name="template-function-padding"><a name="template-function-padding"></a>padding</h6>
            <p><i style="font-style: normal;">Syntax:</i><pre> $(padding &lt;macro&gt; &lt;width&gt; &lt;prepended-character-or-string&gt;)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This template function returns the value of its first parameter (a string or macro), prepended with a string. This string is <span class="Code">&lt;width&gt;</span> long, and repeats the character or string set in the third parameter. If you use a single character, it is added <span class="Code">&lt;width&gt;</span> times. If you use a string, it is repeated until its length reaches <span class="Code">&lt;width&gt;</span>. The default padding character is ' ' (space). For example:</p>
            <div class="Example">
                <h6>Example: Using the padding template function</h6>
                <p>If the value of the <span class="Code">${MESSAGE}</span> macro is <span class="Code">mymessage</span>, then the output of the <span class="Code">padding()</span> template function is the following:</p><pre>$(padding ${MESSAGE} 10 X)</pre>
                <p>Output: <span class="Code">XXXXXXXXXXmymessage</span></p><pre>$(padding ${MESSAGE} 10 foo)</pre>
                <p>Output: <span class="Code">foofoofoofmymessage</span></p>
            </div>
        </div>
        <div>
            <h6 name="template-function-python"><a name="template-function-python"></a>python</h6>
            <p><i style="font-style: normal;">Syntax:</i><pre> $(python &lt;name-of-the-python-method-to-use&gt; &lt;arguments-of-the-method&gt;)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This template function enables you to write a custom template function in Python. You can define a Python block in your <MadCap:variable name="General.abbrev"></MadCap:variable> configuration file, define one or more Python functions in it, and use the methods as template functions. If you use a Python block, <MadCap:variable name="General.abbrev"></MadCap:variable> embeds a Python interpreter to process the messages.</p>
            <MadCap:snippetBlock src="../shared/chunk/python-blocks.flsnp">
            </MadCap:snippetBlock>
            <p>The following points apply to Python parsers.</p>
            <ul>
                <li>
                    <p>The first argument in the definition of the Python function is the actual log message. This is implicitly passed to the function, you do not have to use it in the template function.</p>
                </li>
                <li>
                    <p>The value of the template function is return value of the Python function.</p>
                </li>
                <li>
                    <p>To reference a name-value pair or a macro in the Python function, use the dot-notation. For example, if the first argument in the definition of the function is called <span class="Code">log-message</span>, the value of the HOST macro is <span class="Code">log-message.HOST</span>, and so on.</p>
                </li>
                <li>
                    <p>You can define new name-value pairs in the Python function. For example, if the first argument in the definition of the function is called <span class="Code">log-message</span>, you can create a new name-value pair like this: <span class="Code">log_message["new-macro-name"]="value"</span>. This is useful when you parse a part of the message from Python, or lookup a value based on data extracted from the log message.</p>
                </li>
            </ul>
            <div>
                <h6>Declaration:</h6><pre>python {
def &lt;name_of_the_python_function&gt;(&lt;log_message&gt;, &lt;optional_other_arguments&gt;):
    # &lt;your-python-code&gt;
    return &lt;value_of_the_template_function&gt;
};

template &lt;template-name&gt; {
    template($(python &lt;name_of_the_python_function&gt;));
};</pre>
            </div>
            <div class="Example">
                <h6 name="example-python-template-functions"><a name="example-python-template-functions"></a>Example: Writing template functions in Python</h6>
                <p>The following example creates a Python template function called <span class="Code">return_message</span> that returns the MESSAGE part of the log message.</p><pre>@version: <MadCap:variable name="Version.techversion"></MadCap:variable>

python {
def return_message(log_message):
    return log_message.MESSAGE
};

destination d_local {
    file("/tmp/logs.txt" template("[$(python return_message)]\n"));
};</pre>
                <p>The following example creates a Python template function called <span class="Code">resolve_host</span> that receives an IP address as an argument, and attempts to resolve it into a hostname.</p><pre>@version: <MadCap:variable name="Version.techversion"></MadCap:variable>

python {
import socket

def resolve_host(log_message, hostname):
    try:
        return socket.gethostbyaddr(hostname)[0]
    except (socket.herror, socket.error):
        return 'unknown'
};

destination d_local {
    file(
        "/tmp/logs.txt"
        template("${ISODATE} $(python resolve_host ${SOURCE_IP}) ${MESSAGE}\n")
    );
};</pre>
            </div>
        </div>
        <div>
            <h6 name="template-function-replace-delimiter"><a name="template-function-replace-delimiter"></a>replace-delimiter</h6>
            <MadCap:keyword term="replace-delimiter">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(replace-delimiter "&lt;old-delimiters&gt;" "&lt;new-delimiter&gt;" "&lt;macro&gt;")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Replaces the delimiter character with a new one. For example, the following example replaces the tabulators (<span class="Code">\t</span>) in the message with semicolons (<span class="Code">;</span>):</p><pre>$(replace-delimiter "\t" ";" "${MESSAGE}")</pre>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable><MadCap:conditionaltext MadCap:conditions="General.OSE">3.5</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-round"><a name="template-function-round"></a>round</h6>
            <MadCap:keyword term="round">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(round argument)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Rounds a floating-point number to the nearest integer. For example, <span class="Code">$(round 1.5)</span> is 2. See also the <span class="Code">ceil</span> and <span class="Code">floor</span> template functions.</p>
            <p>This template function has an optional second argument that sets the precision of rounding. The default is 0 (output a natural number), but values up to 20 are accepted. For example, <span class="Code">$(round 2.123456 4)</span> is 2.1235.</p>
        </div>
        <div>
            <h6 name="template-function-sanitize"><a name="template-function-sanitize"></a>sanitize</h6>
            <MadCap:keyword term="sanitize">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(sanitize &lt;options&gt; "&lt;macro1&gt;" "&lt;macro2&gt; ...")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This file replaces the special characters in macro values, for example, it can replace the slash (/) characters in a filename with the underscore (_) character. If you specify multiple arguments, they will be concatenated using the <span class="Code">/</span> character, so they can be used as separate directory levels when used in filenames.</p>
            <p>The function has the following options:</p>
            <ul oldrole="variablelist">
                <li oldrole="varlistentry"><span class="Code">--ctrl-chars or -c</span>
                    <li>
                        <p>Filter control characters (characters that have an ASCII code of 32 or lower). This option is used by default.</p>
                    </li>
                </li>
                <li oldrole="varlistentry"><span class="Code">--invalid-chars &lt;characterlist&gt; or -i &lt;characterlist&gt;</span>
                    <li>
                        <p>The list of characters to be replaced with underscores (_). The default list contains the <span class="Code">/</span> character. The following example replaces the \ and @ characters, so for example, fo\o@bar becomes foobar:</p><pre>$(sanitize -i \@ $PROGRAM)</pre>
                    </li>
                </li>
                <li oldrole="varlistentry"><span class="Code">--no-ctrl-chars or -C</span>
                    <li>
                        <p>Do not filter the control characters (characters that have an ASCII code of 32 or lower).</p>
                    </li>
                </li>
                <li oldrole="varlistentry"><span class="Code">--replacement &lt;replacement-character&gt; or -r &lt;replacement-character&gt;</span>
                    <li>
                        <p>The character used to replace invalid characters. By default, this is the underscore (_). The following example replaces invalid characters with colons instead of underscores, so for example, <span class="Code">foo/bar</span> becomes <span class="Code">foo;bar</span>:</p><pre>$(sanitize -r ; $PROGRAM)</pre>
                    </li>
                </li>
            </ul>
            <div class="Example">
                <h6>Example: Using the sanitize template function</h6>
                <p>The following example uses the sanitize function on two macros, and the results are used as directory names in a file destination.</p><pre>file("/var/log/$(sanitize $HOST $PROGRAM)/messages");</pre>
                <p>This is equivalent to <span class="Code">file("/var/log/$HOST/$PROGRAM/messages");</span>, but any slashes in the values of the $HOST and $PROGRAM macros are replaced with underscores.</p>
            </div>
        </div>
        <div MadCap:conditions="General.OSE">
            <h6 name="template-function-stardate"><a name="template-function-stardate"></a>stardate</h6>
            <MadCap:keyword term="stardate">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(stardate [option] "&lt;date-in-unixtime&gt;")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Converts a date in UNIXTIME (for example, ${UNIXTIME}) into <a href="https://en.wikipedia.org/wiki/Stardate">stardate</a>, displaying the year and the progress of the year in a number of digits (<span class="Code">YYYY.NNN</span>). You can set the number of digits using the <b class="Code">--digits</b> option, for example:</p><pre>$(stardate --digits 2 "${R_UNIXTIME}")</pre>
        </div>
        <div>
            <h6 name="template-function-strip"><a name="template-function-strip"></a>strip</h6>
            <MadCap:keyword term="strip">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(strip "&lt;macro&gt;")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Deletes whitespaces from the beginning and the end of a macro. You can specify multiple macros separated with whitespace in a single template function, for example:</p><pre>$(strip "${MESSAGE}" "${PROGRAM}")</pre>
        </div>
        <div>
            <h6 name="template-function-substr"><a name="template-function-substr"></a>substr</h6>
            <MadCap:keyword term="substr">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(substr "&lt;argument&gt;" "&lt;offset&gt;" "&lt;length&gt;")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This function extracts a substring of a string.</p>
            <ul oldrole="variablelist">
                <li oldrole="varlistentry"><span class="Code">argument</span>
                    <li>
                        <p>The string to extract the substring from, for example, <span class="Code">"${MESSAGE}"</span></p>
                    </li>
                </li>
                <li oldrole="varlistentry"><span class="Code">offset</span>
                    <li>
                        <p>Specifies where the substring begins (in characters). <b class="Code">0</b> means to start from the beginning of the string, <b class="Code">5</b> means to skip the first 5 characters of the string, and so on. Use negative numbers to specify where to start from the end of the string, for example, <b class="Code">-1</b> means the last character, <b class="Code">-5</b> means to start five characters before the end of the string.</p>
                    </li>
                </li>
                <li oldrole="varlistentry"><span class="Code">length</span>
                    <li>
                        <p><i>Optional parameter</i>: The number of characters to extract. If not specified, the substring will be extracted from the offset to the end of the string. Use negative numbers to stop the substring before the end of the string, for example, <b class="Code">-5</b> means the substring ends five characters before the end of the string.</p>
                    </li>
                </li>
            </ul>
            <div class="Example">
                <h6>Example: Using the substr template function</h6>
                <p>Skip the first 15 characters of the message, and select the rest:</p><pre>$(substr "${MESSAGE}" "15");</pre>
                <p>Select characters 16-30 of the message (15 characters with offset 15):</p><pre>$(substr "${MESSAGE}" "15" "15");</pre>
                <p>Select the last 15 characters of the message:</p><pre>$(substr "${MESSAGE}" "-15");</pre>
                <p>A template that converts the message to RFC3164 (BSD-syslog) format and truncates the messages to 1023 characters:</p><pre>template t_truncate_messages {
    template("$(substr \"&lt;$PRI&gt;$DATE $HOST $MSGHDR$MESSAGE\" \"0\" \"1023\")\n");
    template-escape(no);
};</pre>
            </div>
        </div>
        <div>
            <h6 name="template-function-template"><a name="template-function-template"></a>template</h6>
            <MadCap:keyword term="template">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(template &lt;template-name&gt;)
$(template $&lt;dynamic-template-name&gt;)
$(template $&lt;dynamic-template-name&gt; '&lt;optional-fallback-template&gt;')</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> This template function looks up the &lt;template-name&gt; in the configuration and uses that to format its result. The referenced template can be static or dynamic. For static templates, <MadCap:variable name="General.abbrev" /> resolves the template when it starts, or when the configuration is reloaded. For dynamic templates, the results are resolved runtime (for dynamic templates, the template name contains at least one '$' character). For example, the name of the template to be invoked can be extracted from the message, or from a name-value pair set using the <a href="data-enrichment-add-contextual-data.htm"><span class="Code">add-contextual-data()</span></a> feature.</p>
            <p>For dynamic templates, you can set an optional second template. This second template will be the results of the template function if resolving the dynamic template fails for some reason. For example:</p><pre>$(template ${my-dynamic-template} '$DATE $HOST $MSGHDR$MSG\n')</pre>
            <p>Available in <MadCap:variable name="General.abbrev" /><MadCap:conditionaltext MadCap:conditions="General.OSE">3.22</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.15</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-uppercase"><a name="template-function-uppercase"></a>uppercase</h6>
            <MadCap:keyword term="uppercase">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(uppercase "&lt;macro&gt;")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Returns the uppercase version of the specified string or macro. For example, the following example uses the uppercase version of the hostname in a directory name:</p><pre>destination d_file {
    file ("/var/log/${MONTH}/${DAY}/$(uppercase "${HOST}")/messages");
};</pre>
            <p>Available in <MadCap:variable name="General.abbrev" /><MadCap:conditionaltext MadCap:conditions="General.OSE">3.5</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-url-decode">url-decode<a name="template-function-url-decode"></a></h6>
            <MadCap:keyword term="url-decode">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(url-decode &lt;string-pr-macro-1&gt; &lt;string-pr-macro-2&gt; ... )</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> You can use the <span class="Code">url-decode</span> template function to decode url-encoded strings and macros. For example, <span class="Code">$(url-decode %3C%3E)</span> yields <span class="Code">&lt;&gt;</span>. The <span class="Code">url-decode</span> can receive multiple parameters (maximum 64). In this case, each parameter is decoded separately, and simply concatenated.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.18</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.11</MadCap:conditionaltext> and later.</p>
        </div>
        <div>
            <h6 name="template-function-url-encode">url-encode<a name="template-function-url-encode"></a></h6>
            <MadCap:keyword term="urlencode">
            </MadCap:keyword>
            <MadCap:keyword term="url-encode">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(url-encode ${MESSAGE} )\n")</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> You can use the <span class="Code">url-encode</span> template function together with the <span class="Code">telegram()</span> destination to send syslog messages to <a href="https://core.telegram.org/" title="https://core.telegram.org" alt="https://core.telegram.org">Telegram.</a> The <span class="Code">url-encode</span> template function escapes strings. All input characters that are not a-z, A-Z, 0-9, '-', '.', '_' or '~' are converted to their "URL escaped" version.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.18</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.11</MadCap:conditionaltext> and later.<MadCap:conditionaltext MadCap:conditions="General.OSE">  (In version 3.16-3.17, this template function was called <span class="Code">urlencode</span>.)</MadCap:conditionaltext></p>
        </div>
        <div>
            <h6 name="template-function-uuid"><a name="template-function-uuid"></a>uuid</h6>
            <MadCap:keyword term="uuid">
            </MadCap:keyword>
            <p><i style="font-style: normal;">Syntax:</i><pre>$(uuid)</pre>
            </p>
            <p><i style="font-style: normal;">Description:</i> Generates a Universally Unique IDentifier (UUID) that complies with <a href="https://www.ietf.org/rfc/rfc4122.txt">RFC4122</a>. That way, an UUID can be added to the message soon after it is received, so messages stored in multiple destinations can be identified. For example, when storing messages in a database and also in files, the UUID can be used to find a particular message both in the database and the files.</p>
            <p>To generate a UUID, you can use a rewrite rule to create a new value-pair for the message.</p>
            <div class="Example">
                <h6>Example: Using Universally Unique Identifiers</h6>
                <p>The following example adds a value-pair called <span class="Code">MESSAGE_UUID</span> to the message using a rewrite rule and a template.</p><pre>rewrite r_add_uuid {
    set("$(uuid)" value("MESSAGE_UUID"));
};

destination d_file {
    file (
        "/var/log/messages"
        template("$MESSAGE_UUID $ISODATE $HOST $MSG\n")
        template-escape(no)
    );
};

log {
    source(s_network);
    rewrite(r_add_uuid);
    destination(d_file);
};</pre>
            </div>
            <div class="Note">
                <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> This template function is available only if the <span class="Code">tfuuid</span> module has been loaded.</p>
                <MadCap:snippetBlock src="../shared/chunk/para-load-module.htm">
                </MadCap:snippetBlock>
            </div>
        </div>
    </body>
</html>
