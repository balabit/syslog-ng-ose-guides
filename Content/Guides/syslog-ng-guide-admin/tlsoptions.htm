<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/RuledTableWithoutHeading_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/RuledTableWithHeading_VerticallyRuled_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <meta name="description" content="" />
    </head>
    <body name="tlsoptions">
        <h1 name="tlsoptions">TLS options</h1>
        <MadCap:keyword term="TLS:['reference']">
        </MadCap:keyword>
        <p>The syslog-ng application can encrypt incoming and outgoing syslog message flows using TLS if you use the <b class="Code">network()</b> or <b class="Code">syslog()</b> drivers.</p>
        <div class="Note">
            <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> The format of the TLS connections used by syslog-ng is similar to using syslog-ng and stunnel, but the source IP information is not lost.</p>
        </div>
        <p>To encrypt connections, use the <b class="Code">transport("tls")</b> and <b class="Code">tls()</b> options in the source and destination statements.</p>
        <p>The tls() option can include the following settings:</p>
        <div>
            <h6 name="tls-options-allow-compress"><a name="tls-options-allow-compress"></a>allow-compress()</h6>
            <MadCap:keyword term="allow-compress()">
            </MadCap:keyword>
            <MadCap:keyword term="allow_compress()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">yes | no</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">no</td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> Enable on-the-wire compression in TLS communication. Note that this option must be enabled both on the server and the client to have any effect. Enabling compression can significantly reduce the bandwidth required to transport the messages, but can slightly decrease the performance of <MadCap:variable name="General.abbrev"></MadCap:variable>, reducing the number of transferred messages during a given period.</p>
            <p>Available in version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.19</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.12</MadCap:conditionaltext> and later.</p>
        </div>
        <MadCap:snippetBlock src="../shared/chunk/option-destination-tls-ca-dir.flsnp">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../shared/chunk/option-destination-tls-ca-file.flsnp">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../shared/chunk/option-destination-tls-cert-file.flsnp">
        </MadCap:snippetBlock>
        <MadCap:snippetBlock src="../shared/chunk/option-destination-tls-cipher-suite.flsnp">
        </MadCap:snippetBlock>
        <div>
            <h6 name="tls-options-crl-dir"><a name="tls-options-crl-dir"></a>crl-dir()</h6>
            <MadCap:keyword term="crl-dir()">
            </MadCap:keyword>
            <MadCap:keyword term="crl_dir()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Directory name</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none</td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> Name of a directory that contains the Certificate Revocation Lists for trusted CAs. Similarly to <span class="Code">ca-dir()</span> files, use the 32-bit hash of the name of the issuing CAs as filenames. The extension of the files must be <span class="Code">.r0</span>.</p>
        </div>
        <MadCap:snippetBlock src="../shared/chunk/option-tls-option-dhparam-file.htm">
        </MadCap:snippetBlock>
        <div>
            <h6 name="tls-options-ecdh-curve-list"><a name="tls-options-ecdh-curve-list"></a>ecdh-curve-list()</h6>
            <MadCap:keyword term="ecdh-curve-list()">
            </MadCap:keyword>
            <MadCap:keyword term="ecdh-curve-list()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"> string [colon-separated list]</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none </td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> A colon-separated list that specifies the curves that are permitted in the connection when using Elliptic Curve Cryptography (ECC).</p>
            <p>This option is only available when syslog-ng is compiled with OpenSSL version 1.0.2 or later. In the case of older versions, prime256v1 (NIST P-256) is used.</p>
            <p>The following example curves work for all versions of OpenSSL that are equal to or later than version 1.0.2:</p><pre>ecdh-curve-list("prime256v1:secp384r1")</pre>
        </div>
        <div>
            <h6 name="tls-options-sigalgs"><a name="tls-options-sigalgs"></a>tls-options-sigalgs</h6>
            <MadCap:keyword term="sigalgs()">
            </MadCap:keyword>
            <MadCap:keyword term="sigalgs()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"> string [colon-separated list]</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none </td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> A colon-separated list that specifies the supported signature algorithms for TLSv1.2 and higher, for example, <b class="Code" oldrole="userinput">RSA-PSS+SHA256:ed25519</b>.</p>
            <p>For servers, it is used to determine which signature algorithms to support.</p>
            <p>For clients, this value is used directly for the supported signature algorithms extension.</p>
        </div>
        <div>
            <h6 name="tls-options-client-sigalgs"><a name="tls-options-client-sigalgs"></a>tls-options-sigalgs</h6>
            <MadCap:keyword term="client-sigalgs()">
            </MadCap:keyword>
            <MadCap:keyword term="client-sigalgs()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"> string [colon-separated list]</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none </td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> A colon-separated list that specifies the supported signature algorithms associated with client authentication for TLSv1.2 and higher, for example, <b class="Code" oldrole="userinput">RSA-PSS+SHA256:ed25519</b>.</p>
            <p>For servers, the value is used in the <pre>signature_algorithms</pre> field of a <pre>CertificateRequest</pre> message.</p>
            <p>For clients, it is used to determine which signature algorithm to use with the client certificate.</p>
        </div>
        <MadCap:snippetBlock src="../shared/chunk/option-destination-tls-key-file.flsnp"></MadCap:snippetBlock>
        <div>
            <h6>keylog-file()</h6>
            <MadCap:keyword term="keylog-file()">
            </MadCap:keyword>
            <MadCap:keyword term="keylog_file()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Filename</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">N/A</td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> This option enables saving TLS secrets (decryption keys) for a given source or destination, which can be used to decrypt data with, for example, Wireshark. The given path and name of a file will be used to save these secrets.</p>
            <p>This option is only available with the following drivers:</p>
            <ul>
                <li>
                    <p>network</p>
                </li>
                <li>
                    <p>syslog</p>
                </li>
                <li>
                    <p>tcp</p>
                </li>
                <li>
                    <p>tcp6</p>
                </li>
            </ul>
            <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css');" class="TableStyle-NoteTable_Yellow_DoNotEdit" cellspacing="0">
                <col style="width: 0.3in;" class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column1" />
                <col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column2" />
                <tbody>
                    <tr class="TableStyle-NoteTable_Yellow_DoNotEdit-Body-Body1">
                        <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyB-Column1-Body1">
                            <p>
                                <img src="../../Resources/Images/Common/caution.png" />
                            </p>
                        </td>
                        <td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyA-Column2-Body1">
                            <p class="TableHyphen"><span class="Yellow">CAUTION:</span> Using <span class="Code">keylog-file()</span> makes TLS connections less secure by writing secret key materials into the given file. This option should only be enabled for debugging purposes and should be disabled after that. It is also recommended to delete the file after the debugging session is over.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div>
            <h6 name="tls-options-peer-verify"><a name="tls-options-peer-verify"></a>peer-verify()</h6>
            <MadCap:keyword term="peer-verify()">
            </MadCap:keyword>
            <MadCap:keyword term="peer_verify()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1"><span class="Code">optional-trusted</span> | <span class="Code">optional-untrusted</span> | <span class="Code">required-trusted</span> | <span class="Code">required-untrusted | <span class="Code">yes</span> | <span class="Code">no</span></span></td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1"><span class="Code">required-trusted</span>
                        </td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> Verification method of the peer, the four possible values is a combination of two properties of validation:</p>
            <ul>
                <li>
                    <p>Whether the peer is required to provide a certificate (required or optional prefix).</p>
                </li>
                <li>
                    <p>Whether the certificate provided needs to be valid or not.</p>
                </li>
            </ul>
            <p>The following table summarizes the possible options and their results depending on the certificate of the peer.</p>
            <table cellspacing="0" class="TableStyle-RuledTableWithoutHeading_DoNotEdit" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithoutHeading_DoNotEdit.css');">
                <thead>
                    <tr class="TableStyle-RuledTableWithHeading_VerticallyRuled_DoNotEdit-Head-Header1">
                        <th class="TableStyle-RuledTableWithoutHeading_DoNotEdit-HeadH-Column1-" colspan="2" rowspan="2">
                            <p>
                            </p>
                        </th>
                        <th class="TableStyle-RuledTableWithoutHeading_DoNotEdit-HeadG-Column1-" colspan="3">The remote peer has:</th>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_VerticallyRuled_DoNotEdit-Head-Header1">
                        <th class="TableStyle-RuledTableWithoutHeading_DoNotEdit-HeadH-Column1-"> no certificate </th>
                        <th class="TableStyle-RuledTableWithoutHeading_DoNotEdit-HeadH-Column1-"> invalid certificate </th>
                        <th class="TableStyle-RuledTableWithoutHeading_DoNotEdit-HeadG-Column1-"> valid certificate </th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-RuledTableWithoutHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1" rowspan="4"><i style="font-style: normal;">Local peer-verify() setting</i>
                        </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"><i style="font-style: normal;">optional-untrusted</i>
                        </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"> TLS-encryption </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"> TLS-encryption </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyD-Column1-Body1"> TLS-encryption </td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithoutHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"><i style="font-style: normal;">optional-trusted</i>
                        </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"> TLS-encryption </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"> rejected connection </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyD-Column1-Body1"> TLS-encryption </td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithoutHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"><i style="font-style: normal;">required-untrusted</i>
                        </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"> rejected connection </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyE-Column1-Body1"> TLS-encryption </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyD-Column1-Body1"> TLS-encryption </td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithoutHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyB-Column1-Body1"><i style="font-style: normal;">required-trusted</i>
                        </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyB-Column1-Body1"> rejected connection </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyB-Column1-Body1"> rejected connection </td>
                        <td class="TableStyle-RuledTableWithoutHeading_DoNotEdit-BodyA-Column1-Body1"> TLS-encryption </td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithoutHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
                <col class="TableStyle-RuledTableWithoutHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
                <col class="TableStyle-RuledTableWithoutHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
                <col class="TableStyle-RuledTableWithoutHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <MadCap:snippetBlock src="../shared/chunk/option-destination-tls-peer-verify-notes.flsnp">
            </MadCap:snippetBlock>
            <p>Starting with <MadCap:variable name="General.abbrev"></MadCap:variable> version <MadCap:conditionaltext MadCap:conditions="General.OSE">3.10</MadCap:conditionaltext>, you can also use a simplified configuration method for the <span class="Code">peer-verify</span> option, simply setting it to <b class="Code">yes</b> or <b class="Code">no</b>. The following table summarizes the possible options and their results depending on the certificate of the peer.</p>
            <MadCap:snippetBlock src="../shared/chunk/option-tls-peer-verify-yesno.flsnp">
            </MadCap:snippetBlock>
        </div>
        <div>
            <h6 name="tls-options-pkcs12-file"><a name="tls-options-pkcs12-file"></a>pkcs12-file()</h6>
            <MadCap:keyword term="pkcs12-file()">
            </MadCap:keyword>
            <MadCap:keyword term="pkcs12-file()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">Filename</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none</td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> The name of a <span class="Code">PKCS #12</span> file that contains an unencrypted private key, an X.509 certificate, and an optional set of trusted CA certificates.</p>
            <p>If this option is used in the configuration, the value of <span class="Code">key-file()</span> and <span class="Code">cert-file()</span> will be omitted.</p>
            <p>You can use the <span class="Code">ca-dir()</span> option together with <span class="Code">pkcs12-file()</span>. However, this is optional because the <span class="Code">PKCS #12</span> file may contain CA certificates as well.</p>
            <p>Passphrase is currently not supported.</p>
            <div class="Example">
                <h6>Example: Using pkcs12-file()</h6>
                <p>In the following example, the first command creates a single <span class="Code">PKCS #12</span> file from the private key, X.509 certificate, and CA certificate files. Then, the second half of the example uses the same <span class="Code">PKCS #12</span> file in the syslog-ng configuration.</p>
                <h6>Example:</h6><pre>$ openssl pkcs12 -export -inkey server.key -in server.crt -certfile ca.crt -out server.p12</pre>
                <h6>Example configuration:</h6><pre>source s_tls {
    syslog(
        transport(tls)
        tls(
            pkcs12-file("/path/to/server.p12")
            ca-dir("/path/to/cadir") # optional
            peer-verify(yes)
        )
    );
};</pre>
            </div>
        </div>
        <div>
            <h6 name="tls-options-sni"><a name="tls-options-sni"></a>sni()</h6>
            <MadCap:keyword term="sni()">
            </MadCap:keyword>
            <MadCap:keyword term="Server Name Identification">
            </MadCap:keyword>
            <MadCap:keyword term="Server Name Indication">
            </MadCap:keyword>
            <MadCap:keyword term="SNI">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">yes | no</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">no</td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> When set to <span class="Code">yes</span> in a destination that uses TLS encryption, this option enables <a href="https://tools.ietf.org/html/rfc6066#page-6">Server Name Indication</a> (also called Server Name Identification, SNI). The <MadCap:variable name="General.abbrev"></MadCap:variable> sends the hostname or the IP address set in the destination to the server during the TLS handshake.</p>
            <p>Available in <MadCap:variable name="General.abbrev"></MadCap:variable><MadCap:conditionaltext MadCap:conditions="General.OSE">3.24</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0.17</MadCap:conditionaltext> and newer.</p>
            <div class="Example">
                <h6>Example: Using Server Name Indication</h6>
                <p>The following destination sends the hostname of its destination during the TLS handshake.</p><pre>destination demo_tls_destination_with_sni {
    network(
         "logserver.example.com" port(6514)
        transport("tls")
        tls(
            ca_dir("/etc/syslog-ng/ca.d")
            key-file("/etc/syslog-ng/cert.d/clientkey.pem")
            cert-file("/etc/syslog-ng/cert.d/clientcert.pem")
            sni(yes)
        )
    );
};</pre>
            </div>
        </div>
        <div>
            <h6 name="tls-options-ssl-options"><a name="tls-options-ssl-options"></a>ssl-options()</h6>
            <MadCap:keyword term="ssl-options()">
            </MadCap:keyword>
            <MadCap:keyword term="ssl_options()">
            </MadCap:keyword>
            <MadCap:keyword term="disable SSL">
            </MadCap:keyword>
            <MadCap:keyword term="disabling SSL">
            </MadCap:keyword>
            <MadCap:keyword term="disable TLS">
            </MadCap:keyword>
            <MadCap:keyword term="disabling TLS">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">comma-separated list of the following options: no-sslv2, no-sslv3, no-tlsv1, no-tlsv11, no-tlsv12, no-tlsv13, none</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">no-sslv2</td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> Sets the specified options of the SSL/TLS protocols. Currently, you can use it to disable specific protocol versions. Note that disabling a newer protocol version (for example, TLSv1.1) does not automatically disable older versions of the same protocol (for example, TLSv1.0). For example, use the following option to permit using only TLSv1.1 or newer:</p>
            <MadCap:keyword term="disable SSL">
            </MadCap:keyword><pre>ssl-options(no-sslv2, no-sslv3, no-tlsv1)</pre>
            <p>Using <span class="Code">ssl-options(none)</span> means that <MadCap:variable name="General.abbrev"></MadCap:variable> does not specify any restrictions on the protocol used. However, in this case, the underlying OpenSSL library can restrict the available protocols, for example, certain OpenSSL versions automatically disable SSLv2.</p>
            <p>This option is available in <MadCap:variable name="General.abbrev"></MadCap:variable><MadCap:conditionaltext MadCap:conditions="General.OSE">3.7</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="General.PE">7.0</MadCap:conditionaltext> and newer.</p>
            <div class="Example">
                <h6>Example: Using ssl-options</h6>
                <p>The following destination explicitly disables SSL and TLSv1.0</p><pre>destination demo_tls_destination {
    network(
         "172.16.177.147" port(6514)
        transport("tls")
        tls(
            ca_dir("/etc/syslog-ng/ca.d")
            key-file("/etc/syslog-ng/cert.d/clientkey.pem")
            cert-file("/etc/syslog-ng/cert.d/clientcert.pem")
            ssl-options(no-sslv2, no-sslv3, no-tlsv1)
        )
    );
};</pre>
            </div>
        </div>
        <div>
            <h6 name="tls-options-trusted-dn"><a name="tls-options-trusted-dn"></a>trusted-dn()</h6>
            <MadCap:keyword term="trusted-dn()">
            </MadCap:keyword>
            <MadCap:keyword term="trusted_dn()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">list of accepted distinguished names</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none</td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> To accept connections only from hosts using certain certificates signed by the trusted CAs, list the distinguished names of the accepted certificates in this parameter. For example, using <span class="Code">trusted-dn("*, O=Example Inc, ST=Some-State, C=*")</span> will accept only certificates issued for the <span class="Code">Example Inc</span> organization in <span class="Code">Some-State</span> state.</p>
        </div>
        <div>
            <h6 name="tls-options-trusted-keys"><a name="tls-options-trusted-keys"></a>trusted-keys()</h6>
            <MadCap:keyword term="trusted-keys()">
            </MadCap:keyword>
            <MadCap:keyword term="trusted_keys()">
            </MadCap:keyword>
            <table cellspacing="0" class="TableStyle-RuledTableWithHeading_DoNotEdit" colsep="0" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">
                <tbody>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyE-Column1-Body1">Accepted values:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyD-Column1-Body1">list of accepted SHA-1 fingerprints</td>
                    </tr>
                    <tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyB-Column1-Body1">Default:</td>
                        <td class="TableStyle-RuledTableWithHeading_DoNotEdit-BodyA-Column1-Body1">none</td>
                    </tr>
                </tbody>
                <col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;">
                </col>
            </table>
            <p><i style="font-style: normal;">Description:</i> To accept connections only from hosts using certain certificates having specific SHA-1 fingerprints, list the fingerprints of the accepted certificates in this parameter. for example, <span class="Code">trusted-keys("SHA1:00:EF:ED:A4:CE:00:D1:14:A4:AB:43:00:EF:00:91:85:FF:89:28:8F", "SHA1:0C:42:00:3E:B2:60:36:64:00:E2:83:F0:80:46:AD:00:A8:9D:00:15")</span>.</p>
            <p>To find the fingerprint of a certificate, you can use the following command: <b class="Code">openssl x509 -in &lt;certificate-filename&gt; -sha1 -noout -fingerprint</b></p>
            <div class="Note">
                <p class="Hyphenation"><span class="AllNoteStyles">NOTE:</span> When using the <span class="Code">trusted-keys()</span> and <span class="Code">trusted-dn()</span> parameters, note the following:</p>
                <ul>
                    <li>
                        <p>First, the <span class="Code">trusted-keys()</span> parameter is checked. If the fingerprint of the peer is listed, the certificate validation is performed.</p>
                    </li>
                    <li>
                        <p>If the fingerprint of the peer is not listed in the <span class="Code">trusted-keys()</span> parameter, the <span class="Code">trusted-dn()</span> parameter is checked. If the DN of the peer is not listed in the <span class="Code">trusted-dn()</span> parameter, the authentication of the peer fails and the connection is closed.</p>
                    </li>
                </ul>
            </div>
        </div>
    </body>
</html>
