<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <meta name="description" content="" />
    </head>
    <body condition="pe6" name="file-source-and-syslog-destination">
        <h1 condition="pe6" name="file-source-and-syslog-destination">File sources and the RFC5424 message format</h1>
        <MadCap:keyword term="file@18372.4">
        </MadCap:keyword>
        <MadCap:keyword term="SDATA:['file@18372.4']">
        </MadCap:keyword>
        <MadCap:keyword term="file information:['file@18372.4']">
        </MadCap:keyword>
        <MadCap:keyword term="including filename in messages">
        </MadCap:keyword>
        <p>When reading messages from a file and forwarding them in IETF-syslog (RFC5424) format, <MadCap:variable name="General.abbrev"></MadCap:variable> automatically adds all file-related information to the <span class="Code">file@18372.4</span> SDATA block. When the source is file and the transport protocol is syslog or syslog-protocol flags were used in the destination side, the message will contain the following source file-related information:</p>
        <ul>
            <li>
                <p><i>size</i>: size of the file</p>
            </li>
            <li>
                <p><i>position</i>: file position the message was read from</p>
            </li>
            <li>
                <p><i>name</i>: name of the file</p>
            </li>
        </ul>
		<div class="Example">
        <h6>Example: File-related information in message</h6>
        <pre>309 &lt;38&gt;1 2010-10-19T15:50:45.018203+02:00 server1 localprg 1234 - [timeQuality isSynced="0" tzKnown="0"][file@18372.4 size="184567" pos="1024" name="/var/tmp/msg.txt"] seq: 0000000001, runid: 1287496244, stamp: 2010-10-19T15:50:45 messagetext</pre>
		</div>
    </body>
</html>