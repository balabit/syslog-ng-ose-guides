<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <meta name="description" content="" />
    </head>
    <body name="patterndb-actions-external" oldrole="section">
        <h1 name="patterndb-actions-external">External actions</h1>
        <MadCap:keyword term="actions:['external actions']">
        </MadCap:keyword>
        <p oldrole="para">To perform an external action when a message is triggered, for example, to send the message in an e-mail, you have to route the generated messages to an external application using the <span class="Code" oldrole="parameter">program()</span> destination.</p>
        <h6 name="example-trigger-email" oldrole="example">Example: Sending triggered messages to external applications</h6>
        <p oldrole="para">The following sample configuration selects the triggered messages and sends them to an external script.</p>
        <ol oldrole="orderedlist">
            <li oldrole="listitem">
                <p oldrole="para">Set a field in the triggered message that is easy to identify and filter. For example:</p><pre class="Code" oldrole="synopsis">&lt;values&gt;
    &lt;value name="MESSAGE"&gt;A log message from ${HOST} matched rule number $.classifier.rule_id&lt;/value&gt;
    &lt;value name="TRIGGER"&gt;yes&lt;/value&gt;
&lt;/values&gt;</pre>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">Create a destination that will process the triggered messages.</p><pre class="Code" oldrole="synopsis">destination d_triggers { program("/bin/myscript"; ); };</pre>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">Create a filter that selects the triggered messages from the internal source.</p><pre class="Code" oldrole="synopsis">filter f_triggers {match("yes" value ("TRIGGER") type(string));};</pre>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">Create a logpath that selects the triggered messages from the internal source and sends them to the script:</p><pre class="Code" oldrole="synopsis">log { source(s_local); filter(f_triggers); destination(d_triggers); };</pre>
            </li>
            <li oldrole="listitem">
                <p oldrole="para">Create a script that will actually process the generated messages, for example:</p><pre class="Code" oldrole="synopsis">#!/usr/bin/perl
while (&lt;&gt;) {
        # body of the script to send emails, snmp traps, and so on
}</pre>
            </li>
        </ol>
    </body>
</html>