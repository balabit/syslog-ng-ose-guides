<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- FIXME options should be restructured to simplesects -->
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><body name="rewrite-groupset" oldrole="section">
<h1 name="rewrite-groupset">Setting multiple message fields to specific values</h1>
<MadCap:keyword term="setting message fields:['setting multiple fields']"></MadCap:keyword>
<MadCap:keyword term="groupset()"></MadCap:keyword>
<p oldrole="para">The <span class="Code" oldrole="parameter">groupset()</span> rewrite rule allows you to modify the value of multiple message fields at once, for example, to change the value of sensitive fields extracted using patterndb, or received in a JSON format. (If you want to modify the names of message fields, see <MadCap:xref href="parser-map-value-pairs.htm#parser-map-value-pairs"></MadCap:xref>.)</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">The first parameter is the new value of the modified fields. This can be a simple string, a macro, or a template (which can include template functions as well).</p>
</li>
<li oldrole="listitem">
<p oldrole="para">The second parameter (<span class="Code" oldrole="parameter">values()</span>) specifies the fields to modify. You can explicitly list the macros or fields (a space-separated list with the values enclosed in double-quotes), or use wildcards and glob expressions to select multiple fields.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">Note that <span class="Code" oldrole="parameter">groupset()</span> does not create new fields, it only modifies existing fields.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">You can refer to the old value of the field using the <span class="Code" oldrole="parameter">$_</span> macro. This is resolved to the value of the current field, and is available only in <span class="Code" oldrole="parameter">groupset()</span> rules.</p>
</li>
</ul>
<h6 oldrole="formalpara">Declaration:</h6>

<pre class="Code" oldrole="synopsis">rewrite &lt;name_of_the_rule&gt; {
    groupset("&lt;new-value-of-the-fields&gt;", values("&lt;field-name-or-glob&gt;" ["&lt;another-field-name-or-glob&gt;"]));
};</pre>

<h6 name="rewrite-groupset-examples" oldrole="example">Example: Using groupset rewrite rules</h6>
<p oldrole="para">The following examples show how to change the values of multiple fields at the same time.</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">Change the value of the <span class="Code" oldrole="parameter">HOST</span> field to <span class="Code" oldrole="parameter">myhost</span>.</p>
<pre class="Code" oldrole="synopsis">groupset ("myhost" values("HOST"))</pre>
</li>
<li oldrole="listitem">
<p oldrole="para">Change the value of the <span class="Code" oldrole="parameter">HOST</span> and <span class="Code" oldrole="parameter">FULLHOST</span> fields to <span class="Code" oldrole="parameter">myhost</span>.</p>
<pre class="Code" oldrole="synopsis">groupset ("myhost" values("HOST" "FULLHOST"))</pre>
</li>
<li oldrole="listitem">
<p oldrole="para">Change the value of the <span class="Code" oldrole="parameter">HOST</span> <span class="Code" oldrole="parameter">FULLHOST</span> and fields to lowercase.</p>
<pre class="Code" oldrole="synopsis">groupset ("$(lowercase "$_")" values("HOST" "FULLHOST"))</pre>
</li>
<li oldrole="listitem">
<p oldrole="para">Change the value of each field and macro that begins with <span class="Code" oldrole="parameter">.USER</span> to <span class="Code" oldrole="parameter">nobody</span>.</p>
<pre class="Code" oldrole="synopsis">groupset ("nobody" values(".USER.*"))</pre>
</li>
<li oldrole="listitem">
<p oldrole="para">Change the value of each field and macro that begins with <span class="Code" oldrole="parameter">.USER</span> to its SHA-1 hash (truncated to 6 characters).</p>
<pre class="Code" oldrole="synopsis">groupset ("$(sha1 --length 6 $_)" values(".USER.*"))</pre>
</li>
</ul>

</body></html>
